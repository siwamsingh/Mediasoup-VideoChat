(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var S=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},lf={exports:{}},Qo={},df={exports:{}},U={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var as=Symbol.for("react.element"),hg=Symbol.for("react.portal"),mg=Symbol.for("react.fragment"),gg=Symbol.for("react.strict_mode"),vg=Symbol.for("react.profiler"),_g=Symbol.for("react.provider"),yg=Symbol.for("react.context"),wg=Symbol.for("react.forward_ref"),Sg=Symbol.for("react.suspense"),Rg=Symbol.for("react.memo"),bg=Symbol.for("react.lazy"),Xd=Symbol.iterator;function Cg(t){return t===null||typeof t!="object"?null:(t=Xd&&t[Xd]||t["@@iterator"],typeof t=="function"?t:null)}var uf={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},pf=Object.assign,ff={};function ti(t,e,r){this.props=t,this.context=e,this.refs=ff,this.updater=r||uf}ti.prototype.isReactComponent={};ti.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ti.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function hf(){}hf.prototype=ti.prototype;function Dl(t,e,r){this.props=t,this.context=e,this.refs=ff,this.updater=r||uf}var El=Dl.prototype=new hf;El.constructor=Dl;pf(El,ti.prototype);El.isPureReactComponent=!0;var Jd=Array.isArray,mf=Object.prototype.hasOwnProperty,Pl={current:null},gf={key:!0,ref:!0,__self:!0,__source:!0};function vf(t,e,r){var n,i={},s=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)mf.call(e,n)&&!gf.hasOwnProperty(n)&&(i[n]=e[n]);var a=arguments.length-2;if(a===1)i.children=r;else if(1<a){for(var c=Array(a),l=0;l<a;l++)c[l]=arguments[l+2];i.children=c}if(t&&t.defaultProps)for(n in a=t.defaultProps,a)i[n]===void 0&&(i[n]=a[n]);return{$$typeof:as,type:t,key:s,ref:o,props:i,_owner:Pl.current}}function Tg(t,e){return{$$typeof:as,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function kl(t){return typeof t=="object"&&t!==null&&t.$$typeof===as}function Dg(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Zd=/\/+/g;function Ia(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Dg(""+t.key):e.toString(36)}function oo(t,e,r,n,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case as:case hg:o=!0}}if(o)return o=t,i=i(o),t=n===""?"."+Ia(o,0):n,Jd(i)?(r="",t!=null&&(r=t.replace(Zd,"$&/")+"/"),oo(i,e,r,"",function(l){return l})):i!=null&&(kl(i)&&(i=Tg(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Zd,"$&/")+"/")+t)),e.push(i)),1;if(o=0,n=n===""?".":n+":",Jd(t))for(var a=0;a<t.length;a++){s=t[a];var c=n+Ia(s,a);o+=oo(s,e,r,c,i)}else if(c=Cg(t),typeof c=="function")for(t=c.call(t),a=0;!(s=t.next()).done;)s=s.value,c=n+Ia(s,a++),o+=oo(s,e,r,c,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ds(t,e,r){if(t==null)return t;var n=[],i=0;return oo(t,n,"","",function(s){return e.call(r,s,i++)}),n}function Eg(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var He={current:null},ao={transition:null},Pg={ReactCurrentDispatcher:He,ReactCurrentBatchConfig:ao,ReactCurrentOwner:Pl};function _f(){throw Error("act(...) is not supported in production builds of React.")}U.Children={map:Ds,forEach:function(t,e,r){Ds(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Ds(t,function(){e++}),e},toArray:function(t){return Ds(t,function(e){return e})||[]},only:function(t){if(!kl(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};U.Component=ti;U.Fragment=mg;U.Profiler=vg;U.PureComponent=Dl;U.StrictMode=gg;U.Suspense=Sg;U.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pg;U.act=_f;U.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=pf({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Pl.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)mf.call(e,c)&&!gf.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){a=Array(c);for(var l=0;l<c;l++)a[l]=arguments[l+2];n.children=a}return{$$typeof:as,type:t.type,key:i,ref:s,props:n,_owner:o}};U.createContext=function(t){return t={$$typeof:yg,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:_g,_context:t},t.Consumer=t};U.createElement=vf;U.createFactory=function(t){var e=vf.bind(null,t);return e.type=t,e};U.createRef=function(){return{current:null}};U.forwardRef=function(t){return{$$typeof:wg,render:t}};U.isValidElement=kl;U.lazy=function(t){return{$$typeof:bg,_payload:{_status:-1,_result:t},_init:Eg}};U.memo=function(t,e){return{$$typeof:Rg,type:t,compare:e===void 0?null:e}};U.startTransition=function(t){var e=ao.transition;ao.transition={};try{t()}finally{ao.transition=e}};U.unstable_act=_f;U.useCallback=function(t,e){return He.current.useCallback(t,e)};U.useContext=function(t){return He.current.useContext(t)};U.useDebugValue=function(){};U.useDeferredValue=function(t){return He.current.useDeferredValue(t)};U.useEffect=function(t,e){return He.current.useEffect(t,e)};U.useId=function(){return He.current.useId()};U.useImperativeHandle=function(t,e,r){return He.current.useImperativeHandle(t,e,r)};U.useInsertionEffect=function(t,e){return He.current.useInsertionEffect(t,e)};U.useLayoutEffect=function(t,e){return He.current.useLayoutEffect(t,e)};U.useMemo=function(t,e){return He.current.useMemo(t,e)};U.useReducer=function(t,e,r){return He.current.useReducer(t,e,r)};U.useRef=function(t){return He.current.useRef(t)};U.useState=function(t){return He.current.useState(t)};U.useSyncExternalStore=function(t,e,r){return He.current.useSyncExternalStore(t,e,r)};U.useTransition=function(){return He.current.useTransition()};U.version="18.3.1";df.exports=U;var Wn=df.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kg=Wn,xg=Symbol.for("react.element"),Lg=Symbol.for("react.fragment"),Mg=Object.prototype.hasOwnProperty,Og=kg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ig={key:!0,ref:!0,__self:!0,__source:!0};function yf(t,e,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)Mg.call(e,n)&&!Ig.hasOwnProperty(n)&&(i[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)i[n]===void 0&&(i[n]=e[n]);return{$$typeof:xg,type:t,key:s,ref:o,props:i,_owner:Og.current}}Qo.Fragment=Lg;Qo.jsx=yf;Qo.jsxs=yf;lf.exports=Qo;var Ze=lf.exports,wf={exports:{}},it={},Sf={exports:{}},Rf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(T,N){var F=T.length;T.push(N);e:for(;0<F;){var ce=F-1>>>1,le=T[ce];if(0<i(le,N))T[ce]=N,T[F]=le,F=ce;else break e}}function r(T){return T.length===0?null:T[0]}function n(T){if(T.length===0)return null;var N=T[0],F=T.pop();if(F!==N){T[0]=F;e:for(var ce=0,le=T.length,Wt=le>>>1;ce<Wt;){var Ct=2*(ce+1)-1,lr=T[Ct],ht=Ct+1,dr=T[ht];if(0>i(lr,F))ht<le&&0>i(dr,lr)?(T[ce]=dr,T[ht]=F,ce=ht):(T[ce]=lr,T[Ct]=F,ce=Ct);else if(ht<le&&0>i(dr,F))T[ce]=dr,T[ht]=F,ce=ht;else break e}}return N}function i(T,N){var F=T.sortIndex-N.sortIndex;return F!==0?F:T.id-N.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],l=[],d=1,p=null,u=3,f=!1,h=!1,m=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(T){for(var N=r(l);N!==null;){if(N.callback===null)n(l);else if(N.startTime<=T)n(l),N.sortIndex=N.expirationTime,e(c,N);else break;N=r(l)}}function w(T){if(m=!1,_(T),!h)if(r(c)!==null)h=!0,ar(b);else{var N=r(l);N!==null&&cr(w,N.startTime-T)}}function b(T,N){h=!1,m&&(m=!1,g(P),P=-1),f=!0;var F=u;try{for(_(N),p=r(c);p!==null&&(!(p.expirationTime>N)||T&&!_e());){var ce=p.callback;if(typeof ce=="function"){p.callback=null,u=p.priorityLevel;var le=ce(p.expirationTime<=N);N=t.unstable_now(),typeof le=="function"?p.callback=le:p===r(c)&&n(c),_(N)}else n(c);p=r(c)}if(p!==null)var Wt=!0;else{var Ct=r(l);Ct!==null&&cr(w,Ct.startTime-N),Wt=!1}return Wt}finally{p=null,u=F,f=!1}}var C=!1,E=null,P=-1,Y=5,A=-1;function _e(){return!(t.unstable_now()-A<Y)}function Ie(){if(E!==null){var T=t.unstable_now();A=T;var N=!0;try{N=E(!0,T)}finally{N?Je():(C=!1,E=null)}}else C=!1}var Je;if(typeof v=="function")Je=function(){v(Ie)};else if(typeof MessageChannel<"u"){var Fr=new MessageChannel,xa=Fr.port2;Fr.port1.onmessage=Ie,Je=function(){xa.postMessage(null)}}else Je=function(){y(Ie,0)};function ar(T){E=T,C||(C=!0,Je())}function cr(T,N){P=y(function(){T(t.unstable_now())},N)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(T){T.callback=null},t.unstable_continueExecution=function(){h||f||(h=!0,ar(b))},t.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Y=0<T?Math.floor(1e3/T):5},t.unstable_getCurrentPriorityLevel=function(){return u},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(T){switch(u){case 1:case 2:case 3:var N=3;break;default:N=u}var F=u;u=N;try{return T()}finally{u=F}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(T,N){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var F=u;u=T;try{return N()}finally{u=F}},t.unstable_scheduleCallback=function(T,N,F){var ce=t.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?ce+F:ce):F=ce,T){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=F+le,T={id:d++,callback:N,priorityLevel:T,startTime:F,expirationTime:le,sortIndex:-1},F>ce?(T.sortIndex=F,e(l,T),r(c)===null&&T===r(l)&&(m?(g(P),P=-1):m=!0,cr(w,F-ce))):(T.sortIndex=le,e(c,T),h||f||(h=!0,ar(b))),T},t.unstable_shouldYield=_e,t.unstable_wrapCallback=function(T){var N=u;return function(){var F=u;u=N;try{return T.apply(this,arguments)}finally{u=F}}}})(Rf);Sf.exports=Rf;var Ng=Sf.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jg=Wn,nt=Ng;function R(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var bf=new Set,Vi={};function Zr(t,e){Qn(t,e),Qn(t+"Capture",e)}function Qn(t,e){for(Vi[t]=e,t=0;t<e.length;t++)bf.add(e[t])}var rr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bc=Object.prototype.hasOwnProperty,Ag=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,eu={},tu={};function $g(t){return bc.call(tu,t)?!0:bc.call(eu,t)?!1:Ag.test(t)?tu[t]=!0:(eu[t]=!0,!1)}function Fg(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Bg(t,e,r,n){if(e===null||typeof e>"u"||Fg(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ke(t,e,r,n,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Oe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Oe[t]=new Ke(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Oe[e]=new Ke(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Oe[t]=new Ke(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Oe[t]=new Ke(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Oe[t]=new Ke(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Oe[t]=new Ke(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Oe[t]=new Ke(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Oe[t]=new Ke(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Oe[t]=new Ke(t,5,!1,t.toLowerCase(),null,!1,!1)});var xl=/[\-:]([a-z])/g;function Ll(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(xl,Ll);Oe[e]=new Ke(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(xl,Ll);Oe[e]=new Ke(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(xl,Ll);Oe[e]=new Ke(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Oe[t]=new Ke(t,1,!1,t.toLowerCase(),null,!1,!1)});Oe.xlinkHref=new Ke("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Oe[t]=new Ke(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ml(t,e,r,n){var i=Oe.hasOwnProperty(e)?Oe[e]:null;(i!==null?i.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Bg(e,r,i,n)&&(r=null),n||i===null?$g(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):i.mustUseProperty?t[i.propertyName]=r===null?i.type===3?!1:"":r:(e=i.attributeName,n=i.attributeNamespace,r===null?t.removeAttribute(e):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var or=jg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Es=Symbol.for("react.element"),Dn=Symbol.for("react.portal"),En=Symbol.for("react.fragment"),Ol=Symbol.for("react.strict_mode"),Cc=Symbol.for("react.profiler"),Cf=Symbol.for("react.provider"),Tf=Symbol.for("react.context"),Il=Symbol.for("react.forward_ref"),Tc=Symbol.for("react.suspense"),Dc=Symbol.for("react.suspense_list"),Nl=Symbol.for("react.memo"),vr=Symbol.for("react.lazy"),Df=Symbol.for("react.offscreen"),ru=Symbol.iterator;function fi(t){return t===null||typeof t!="object"?null:(t=ru&&t[ru]||t["@@iterator"],typeof t=="function"?t:null)}var fe=Object.assign,Na;function Di(t){if(Na===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Na=e&&e[1]||""}return`
`+Na+t}var ja=!1;function Aa(t,e){if(!t||ja)return"";ja=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var n=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){n=l}t.call(e.prototype)}else{try{throw Error()}catch(l){n=l}t()}}catch(l){if(l&&n&&typeof l.stack=="string"){for(var i=l.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var c=`
`+i[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{ja=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Di(t):""}function zg(t){switch(t.tag){case 5:return Di(t.type);case 16:return Di("Lazy");case 13:return Di("Suspense");case 19:return Di("SuspenseList");case 0:case 2:case 15:return t=Aa(t.type,!1),t;case 11:return t=Aa(t.type.render,!1),t;case 1:return t=Aa(t.type,!0),t;default:return""}}function Ec(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case En:return"Fragment";case Dn:return"Portal";case Cc:return"Profiler";case Ol:return"StrictMode";case Tc:return"Suspense";case Dc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Tf:return(t.displayName||"Context")+".Consumer";case Cf:return(t._context.displayName||"Context")+".Provider";case Il:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Nl:return e=t.displayName||null,e!==null?e:Ec(t.type)||"Memo";case vr:e=t._payload,t=t._init;try{return Ec(t(e))}catch{}}return null}function Ug(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ec(e);case 8:return e===Ol?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Or(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Ef(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Vg(t){var e=Ef(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ps(t){t._valueTracker||(t._valueTracker=Vg(t))}function Pf(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Ef(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function bo(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Pc(t,e){var r=e.checked;return fe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function nu(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Or(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function kf(t,e){e=e.checked,e!=null&&Ml(t,"checked",e,!1)}function kc(t,e){kf(t,e);var r=Or(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?xc(t,e.type,r):e.hasOwnProperty("defaultValue")&&xc(t,e.type,Or(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function iu(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function xc(t,e,r){(e!=="number"||bo(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Ei=Array.isArray;function $n(t,e,r,n){if(t=t.options,e){e={};for(var i=0;i<r.length;i++)e["$"+r[i]]=!0;for(r=0;r<t.length;r++)i=e.hasOwnProperty("$"+t[r].value),t[r].selected!==i&&(t[r].selected=i),i&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Or(r),e=null,i=0;i<t.length;i++){if(t[i].value===r){t[i].selected=!0,n&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Lc(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(R(91));return fe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function su(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(R(92));if(Ei(r)){if(1<r.length)throw Error(R(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Or(r)}}function xf(t,e){var r=Or(e.value),n=Or(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function ou(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Lf(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Mc(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Lf(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ks,Mf=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,i){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ks=ks||document.createElement("div"),ks.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ks.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Hi(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Li={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Hg=["Webkit","ms","Moz","O"];Object.keys(Li).forEach(function(t){Hg.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Li[e]=Li[t]})});function Of(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Li.hasOwnProperty(t)&&Li[t]?(""+e).trim():e+"px"}function If(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Of(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,i):t[r]=i}}var Kg=fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Oc(t,e){if(e){if(Kg[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(R(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(R(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(R(61))}if(e.style!=null&&typeof e.style!="object")throw Error(R(62))}}function Ic(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nc=null;function jl(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var jc=null,Fn=null,Bn=null;function au(t){if(t=ds(t)){if(typeof jc!="function")throw Error(R(280));var e=t.stateNode;e&&(e=Jo(e),jc(t.stateNode,t.type,e))}}function Nf(t){Fn?Bn?Bn.push(t):Bn=[t]:Fn=t}function jf(){if(Fn){var t=Fn,e=Bn;if(Bn=Fn=null,au(t),e)for(t=0;t<e.length;t++)au(e[t])}}function Af(t,e){return t(e)}function $f(){}var $a=!1;function Ff(t,e,r){if($a)return t(e,r);$a=!0;try{return Af(t,e,r)}finally{$a=!1,(Fn!==null||Bn!==null)&&($f(),jf())}}function Ki(t,e){var r=t.stateNode;if(r===null)return null;var n=Jo(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(R(231,e,typeof r));return r}var Ac=!1;if(rr)try{var hi={};Object.defineProperty(hi,"passive",{get:function(){Ac=!0}}),window.addEventListener("test",hi,hi),window.removeEventListener("test",hi,hi)}catch{Ac=!1}function Wg(t,e,r,n,i,s,o,a,c){var l=Array.prototype.slice.call(arguments,3);try{e.apply(r,l)}catch(d){this.onError(d)}}var Mi=!1,Co=null,To=!1,$c=null,Qg={onError:function(t){Mi=!0,Co=t}};function qg(t,e,r,n,i,s,o,a,c){Mi=!1,Co=null,Wg.apply(Qg,arguments)}function Gg(t,e,r,n,i,s,o,a,c){if(qg.apply(this,arguments),Mi){if(Mi){var l=Co;Mi=!1,Co=null}else throw Error(R(198));To||(To=!0,$c=l)}}function en(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Bf(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function cu(t){if(en(t)!==t)throw Error(R(188))}function Yg(t){var e=t.alternate;if(!e){if(e=en(t),e===null)throw Error(R(188));return e!==t?null:t}for(var r=t,n=e;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return cu(i),t;if(s===n)return cu(i),e;s=s.sibling}throw Error(R(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,a=i.child;a;){if(a===r){o=!0,r=i,n=s;break}if(a===n){o=!0,n=i,r=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===r){o=!0,r=s,n=i;break}if(a===n){o=!0,n=s,r=i;break}a=a.sibling}if(!o)throw Error(R(189))}}if(r.alternate!==n)throw Error(R(190))}if(r.tag!==3)throw Error(R(188));return r.stateNode.current===r?t:e}function zf(t){return t=Yg(t),t!==null?Uf(t):null}function Uf(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Uf(t);if(e!==null)return e;t=t.sibling}return null}var Vf=nt.unstable_scheduleCallback,lu=nt.unstable_cancelCallback,Xg=nt.unstable_shouldYield,Jg=nt.unstable_requestPaint,ye=nt.unstable_now,Zg=nt.unstable_getCurrentPriorityLevel,Al=nt.unstable_ImmediatePriority,Hf=nt.unstable_UserBlockingPriority,Do=nt.unstable_NormalPriority,ev=nt.unstable_LowPriority,Kf=nt.unstable_IdlePriority,qo=null,Ft=null;function tv(t){if(Ft&&typeof Ft.onCommitFiberRoot=="function")try{Ft.onCommitFiberRoot(qo,t,void 0,(t.current.flags&128)===128)}catch{}}var St=Math.clz32?Math.clz32:iv,rv=Math.log,nv=Math.LN2;function iv(t){return t>>>=0,t===0?32:31-(rv(t)/nv|0)|0}var xs=64,Ls=4194304;function Pi(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Eo(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,i=t.suspendedLanes,s=t.pingedLanes,o=r&268435455;if(o!==0){var a=o&~i;a!==0?n=Pi(a):(s&=o,s!==0&&(n=Pi(s)))}else o=r&~i,o!==0?n=Pi(o):s!==0&&(n=Pi(s));if(n===0)return 0;if(e!==0&&e!==n&&!(e&i)&&(i=n&-n,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-St(e),i=1<<r,n|=t[r],e&=~i;return n}function sv(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ov(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-St(s),a=1<<o,c=i[o];c===-1?(!(a&r)||a&n)&&(i[o]=sv(a,e)):c<=e&&(t.expiredLanes|=a),s&=~a}}function Fc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Wf(){var t=xs;return xs<<=1,!(xs&4194240)&&(xs=64),t}function Fa(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function cs(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-St(e),t[e]=r}function av(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var i=31-St(r),s=1<<i;e[i]=0,n[i]=-1,t[i]=-1,r&=~s}}function $l(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-St(r),i=1<<n;i&e|t[n]&e&&(t[n]|=e),r&=~i}}var ee=0;function Qf(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var qf,Fl,Gf,Yf,Xf,Bc=!1,Ms=[],br=null,Cr=null,Tr=null,Wi=new Map,Qi=new Map,yr=[],cv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function du(t,e){switch(t){case"focusin":case"focusout":br=null;break;case"dragenter":case"dragleave":Cr=null;break;case"mouseover":case"mouseout":Tr=null;break;case"pointerover":case"pointerout":Wi.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qi.delete(e.pointerId)}}function mi(t,e,r,n,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},e!==null&&(e=ds(e),e!==null&&Fl(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function lv(t,e,r,n,i){switch(e){case"focusin":return br=mi(br,t,e,r,n,i),!0;case"dragenter":return Cr=mi(Cr,t,e,r,n,i),!0;case"mouseover":return Tr=mi(Tr,t,e,r,n,i),!0;case"pointerover":var s=i.pointerId;return Wi.set(s,mi(Wi.get(s)||null,t,e,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Qi.set(s,mi(Qi.get(s)||null,t,e,r,n,i)),!0}return!1}function Jf(t){var e=Vr(t.target);if(e!==null){var r=en(e);if(r!==null){if(e=r.tag,e===13){if(e=Bf(r),e!==null){t.blockedOn=e,Xf(t.priority,function(){Gf(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function co(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=zc(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Nc=n,r.target.dispatchEvent(n),Nc=null}else return e=ds(r),e!==null&&Fl(e),t.blockedOn=r,!1;e.shift()}return!0}function uu(t,e,r){co(t)&&r.delete(e)}function dv(){Bc=!1,br!==null&&co(br)&&(br=null),Cr!==null&&co(Cr)&&(Cr=null),Tr!==null&&co(Tr)&&(Tr=null),Wi.forEach(uu),Qi.forEach(uu)}function gi(t,e){t.blockedOn===e&&(t.blockedOn=null,Bc||(Bc=!0,nt.unstable_scheduleCallback(nt.unstable_NormalPriority,dv)))}function qi(t){function e(i){return gi(i,t)}if(0<Ms.length){gi(Ms[0],t);for(var r=1;r<Ms.length;r++){var n=Ms[r];n.blockedOn===t&&(n.blockedOn=null)}}for(br!==null&&gi(br,t),Cr!==null&&gi(Cr,t),Tr!==null&&gi(Tr,t),Wi.forEach(e),Qi.forEach(e),r=0;r<yr.length;r++)n=yr[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<yr.length&&(r=yr[0],r.blockedOn===null);)Jf(r),r.blockedOn===null&&yr.shift()}var zn=or.ReactCurrentBatchConfig,Po=!0;function uv(t,e,r,n){var i=ee,s=zn.transition;zn.transition=null;try{ee=1,Bl(t,e,r,n)}finally{ee=i,zn.transition=s}}function pv(t,e,r,n){var i=ee,s=zn.transition;zn.transition=null;try{ee=4,Bl(t,e,r,n)}finally{ee=i,zn.transition=s}}function Bl(t,e,r,n){if(Po){var i=zc(t,e,r,n);if(i===null)Ga(t,e,n,ko,r),du(t,n);else if(lv(i,t,e,r,n))n.stopPropagation();else if(du(t,n),e&4&&-1<cv.indexOf(t)){for(;i!==null;){var s=ds(i);if(s!==null&&qf(s),s=zc(t,e,r,n),s===null&&Ga(t,e,n,ko,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else Ga(t,e,n,null,r)}}var ko=null;function zc(t,e,r,n){if(ko=null,t=jl(n),t=Vr(t),t!==null)if(e=en(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Bf(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ko=t,null}function Zf(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zg()){case Al:return 1;case Hf:return 4;case Do:case ev:return 16;case Kf:return 536870912;default:return 16}default:return 16}}var Sr=null,zl=null,lo=null;function eh(){if(lo)return lo;var t,e=zl,r=e.length,n,i="value"in Sr?Sr.value:Sr.textContent,s=i.length;for(t=0;t<r&&e[t]===i[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===i[s-n];n++);return lo=i.slice(t,1<n?1-n:void 0)}function uo(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Os(){return!0}function pu(){return!1}function st(t){function e(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(r=t[a],this[a]=r?r(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Os:pu,this.isPropagationStopped=pu,this}return fe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Os)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Os)},persist:function(){},isPersistent:Os}),e}var ri={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ul=st(ri),ls=fe({},ri,{view:0,detail:0}),fv=st(ls),Ba,za,vi,Go=fe({},ls,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Vl,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==vi&&(vi&&t.type==="mousemove"?(Ba=t.screenX-vi.screenX,za=t.screenY-vi.screenY):za=Ba=0,vi=t),Ba)},movementY:function(t){return"movementY"in t?t.movementY:za}}),fu=st(Go),hv=fe({},Go,{dataTransfer:0}),mv=st(hv),gv=fe({},ls,{relatedTarget:0}),Ua=st(gv),vv=fe({},ri,{animationName:0,elapsedTime:0,pseudoElement:0}),_v=st(vv),yv=fe({},ri,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),wv=st(yv),Sv=fe({},ri,{data:0}),hu=st(Sv),Rv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tv(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Cv[t])?!!e[t]:!1}function Vl(){return Tv}var Dv=fe({},ls,{key:function(t){if(t.key){var e=Rv[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=uo(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?bv[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Vl,charCode:function(t){return t.type==="keypress"?uo(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?uo(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Ev=st(Dv),Pv=fe({},Go,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mu=st(Pv),kv=fe({},ls,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Vl}),xv=st(kv),Lv=fe({},ri,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mv=st(Lv),Ov=fe({},Go,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Iv=st(Ov),Nv=[9,13,27,32],Hl=rr&&"CompositionEvent"in window,Oi=null;rr&&"documentMode"in document&&(Oi=document.documentMode);var jv=rr&&"TextEvent"in window&&!Oi,th=rr&&(!Hl||Oi&&8<Oi&&11>=Oi),gu=" ",vu=!1;function rh(t,e){switch(t){case"keyup":return Nv.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nh(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Pn=!1;function Av(t,e){switch(t){case"compositionend":return nh(e);case"keypress":return e.which!==32?null:(vu=!0,gu);case"textInput":return t=e.data,t===gu&&vu?null:t;default:return null}}function $v(t,e){if(Pn)return t==="compositionend"||!Hl&&rh(t,e)?(t=eh(),lo=zl=Sr=null,Pn=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return th&&e.locale!=="ko"?null:e.data;default:return null}}var Fv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _u(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Fv[t.type]:e==="textarea"}function ih(t,e,r,n){Nf(n),e=xo(e,"onChange"),0<e.length&&(r=new Ul("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Ii=null,Gi=null;function Bv(t){mh(t,0)}function Yo(t){var e=Ln(t);if(Pf(e))return t}function zv(t,e){if(t==="change")return e}var sh=!1;if(rr){var Va;if(rr){var Ha="oninput"in document;if(!Ha){var yu=document.createElement("div");yu.setAttribute("oninput","return;"),Ha=typeof yu.oninput=="function"}Va=Ha}else Va=!1;sh=Va&&(!document.documentMode||9<document.documentMode)}function wu(){Ii&&(Ii.detachEvent("onpropertychange",oh),Gi=Ii=null)}function oh(t){if(t.propertyName==="value"&&Yo(Gi)){var e=[];ih(e,Gi,t,jl(t)),Ff(Bv,e)}}function Uv(t,e,r){t==="focusin"?(wu(),Ii=e,Gi=r,Ii.attachEvent("onpropertychange",oh)):t==="focusout"&&wu()}function Vv(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Yo(Gi)}function Hv(t,e){if(t==="click")return Yo(e)}function Kv(t,e){if(t==="input"||t==="change")return Yo(e)}function Wv(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var bt=typeof Object.is=="function"?Object.is:Wv;function Yi(t,e){if(bt(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!bc.call(e,i)||!bt(t[i],e[i]))return!1}return!0}function Su(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ru(t,e){var r=Su(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Su(r)}}function ah(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?ah(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function ch(){for(var t=window,e=bo();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=bo(t.document)}return e}function Kl(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Qv(t){var e=ch(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&ah(r.ownerDocument.documentElement,r)){if(n!==null&&Kl(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!t.extend&&s>n&&(i=n,n=s,s=i),i=Ru(r,s);var o=Ru(r,n);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var qv=rr&&"documentMode"in document&&11>=document.documentMode,kn=null,Uc=null,Ni=null,Vc=!1;function bu(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Vc||kn==null||kn!==bo(n)||(n=kn,"selectionStart"in n&&Kl(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ni&&Yi(Ni,n)||(Ni=n,n=xo(Uc,"onSelect"),0<n.length&&(e=new Ul("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=kn)))}function Is(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var xn={animationend:Is("Animation","AnimationEnd"),animationiteration:Is("Animation","AnimationIteration"),animationstart:Is("Animation","AnimationStart"),transitionend:Is("Transition","TransitionEnd")},Ka={},lh={};rr&&(lh=document.createElement("div").style,"AnimationEvent"in window||(delete xn.animationend.animation,delete xn.animationiteration.animation,delete xn.animationstart.animation),"TransitionEvent"in window||delete xn.transitionend.transition);function Xo(t){if(Ka[t])return Ka[t];if(!xn[t])return t;var e=xn[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in lh)return Ka[t]=e[r];return t}var dh=Xo("animationend"),uh=Xo("animationiteration"),ph=Xo("animationstart"),fh=Xo("transitionend"),hh=new Map,Cu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jr(t,e){hh.set(t,e),Zr(e,[t])}for(var Wa=0;Wa<Cu.length;Wa++){var Qa=Cu[Wa],Gv=Qa.toLowerCase(),Yv=Qa[0].toUpperCase()+Qa.slice(1);jr(Gv,"on"+Yv)}jr(dh,"onAnimationEnd");jr(uh,"onAnimationIteration");jr(ph,"onAnimationStart");jr("dblclick","onDoubleClick");jr("focusin","onFocus");jr("focusout","onBlur");jr(fh,"onTransitionEnd");Qn("onMouseEnter",["mouseout","mouseover"]);Qn("onMouseLeave",["mouseout","mouseover"]);Qn("onPointerEnter",["pointerout","pointerover"]);Qn("onPointerLeave",["pointerout","pointerover"]);Zr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Zr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Zr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Zr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Zr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Zr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ki="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Xv=new Set("cancel close invalid load scroll toggle".split(" ").concat(ki));function Tu(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,Gg(n,e,void 0,t),t.currentTarget=null}function mh(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],i=n.event;n=n.listeners;e:{var s=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],c=a.instance,l=a.currentTarget;if(a=a.listener,c!==s&&i.isPropagationStopped())break e;Tu(i,a,l),s=c}else for(o=0;o<n.length;o++){if(a=n[o],c=a.instance,l=a.currentTarget,a=a.listener,c!==s&&i.isPropagationStopped())break e;Tu(i,a,l),s=c}}}if(To)throw t=$c,To=!1,$c=null,t}function oe(t,e){var r=e[qc];r===void 0&&(r=e[qc]=new Set);var n=t+"__bubble";r.has(n)||(gh(e,t,2,!1),r.add(n))}function qa(t,e,r){var n=0;e&&(n|=4),gh(r,t,n,e)}var Ns="_reactListening"+Math.random().toString(36).slice(2);function Xi(t){if(!t[Ns]){t[Ns]=!0,bf.forEach(function(r){r!=="selectionchange"&&(Xv.has(r)||qa(r,!1,t),qa(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ns]||(e[Ns]=!0,qa("selectionchange",!1,e))}}function gh(t,e,r,n){switch(Zf(e)){case 1:var i=uv;break;case 4:i=pv;break;default:i=Bl}r=i.bind(null,e,r,t),i=void 0,!Ac||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),n?i!==void 0?t.addEventListener(e,r,{capture:!0,passive:i}):t.addEventListener(e,r,!0):i!==void 0?t.addEventListener(e,r,{passive:i}):t.addEventListener(e,r,!1)}function Ga(t,e,r,n,i){var s=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Vr(a),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}a=a.parentNode}}n=n.return}Ff(function(){var l=s,d=jl(r),p=[];e:{var u=hh.get(t);if(u!==void 0){var f=Ul,h=t;switch(t){case"keypress":if(uo(r)===0)break e;case"keydown":case"keyup":f=Ev;break;case"focusin":h="focus",f=Ua;break;case"focusout":h="blur",f=Ua;break;case"beforeblur":case"afterblur":f=Ua;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=fu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=mv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=xv;break;case dh:case uh:case ph:f=_v;break;case fh:f=Mv;break;case"scroll":f=fv;break;case"wheel":f=Iv;break;case"copy":case"cut":case"paste":f=wv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=mu}var m=(e&4)!==0,y=!m&&t==="scroll",g=m?u!==null?u+"Capture":null:u;m=[];for(var v=l,_;v!==null;){_=v;var w=_.stateNode;if(_.tag===5&&w!==null&&(_=w,g!==null&&(w=Ki(v,g),w!=null&&m.push(Ji(v,w,_)))),y)break;v=v.return}0<m.length&&(u=new f(u,h,null,r,d),p.push({event:u,listeners:m}))}}if(!(e&7)){e:{if(u=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",u&&r!==Nc&&(h=r.relatedTarget||r.fromElement)&&(Vr(h)||h[nr]))break e;if((f||u)&&(u=d.window===d?d:(u=d.ownerDocument)?u.defaultView||u.parentWindow:window,f?(h=r.relatedTarget||r.toElement,f=l,h=h?Vr(h):null,h!==null&&(y=en(h),h!==y||h.tag!==5&&h.tag!==6)&&(h=null)):(f=null,h=l),f!==h)){if(m=fu,w="onMouseLeave",g="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(m=mu,w="onPointerLeave",g="onPointerEnter",v="pointer"),y=f==null?u:Ln(f),_=h==null?u:Ln(h),u=new m(w,v+"leave",f,r,d),u.target=y,u.relatedTarget=_,w=null,Vr(d)===l&&(m=new m(g,v+"enter",h,r,d),m.target=_,m.relatedTarget=y,w=m),y=w,f&&h)t:{for(m=f,g=h,v=0,_=m;_;_=sn(_))v++;for(_=0,w=g;w;w=sn(w))_++;for(;0<v-_;)m=sn(m),v--;for(;0<_-v;)g=sn(g),_--;for(;v--;){if(m===g||g!==null&&m===g.alternate)break t;m=sn(m),g=sn(g)}m=null}else m=null;f!==null&&Du(p,u,f,m,!1),h!==null&&y!==null&&Du(p,y,h,m,!0)}}e:{if(u=l?Ln(l):window,f=u.nodeName&&u.nodeName.toLowerCase(),f==="select"||f==="input"&&u.type==="file")var b=zv;else if(_u(u))if(sh)b=Kv;else{b=Vv;var C=Uv}else(f=u.nodeName)&&f.toLowerCase()==="input"&&(u.type==="checkbox"||u.type==="radio")&&(b=Hv);if(b&&(b=b(t,l))){ih(p,b,r,d);break e}C&&C(t,u,l),t==="focusout"&&(C=u._wrapperState)&&C.controlled&&u.type==="number"&&xc(u,"number",u.value)}switch(C=l?Ln(l):window,t){case"focusin":(_u(C)||C.contentEditable==="true")&&(kn=C,Uc=l,Ni=null);break;case"focusout":Ni=Uc=kn=null;break;case"mousedown":Vc=!0;break;case"contextmenu":case"mouseup":case"dragend":Vc=!1,bu(p,r,d);break;case"selectionchange":if(qv)break;case"keydown":case"keyup":bu(p,r,d)}var E;if(Hl)e:{switch(t){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Pn?rh(t,r)&&(P="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(th&&r.locale!=="ko"&&(Pn||P!=="onCompositionStart"?P==="onCompositionEnd"&&Pn&&(E=eh()):(Sr=d,zl="value"in Sr?Sr.value:Sr.textContent,Pn=!0)),C=xo(l,P),0<C.length&&(P=new hu(P,t,null,r,d),p.push({event:P,listeners:C}),E?P.data=E:(E=nh(r),E!==null&&(P.data=E)))),(E=jv?Av(t,r):$v(t,r))&&(l=xo(l,"onBeforeInput"),0<l.length&&(d=new hu("onBeforeInput","beforeinput",null,r,d),p.push({event:d,listeners:l}),d.data=E))}mh(p,e)})}function Ji(t,e,r){return{instance:t,listener:e,currentTarget:r}}function xo(t,e){for(var r=e+"Capture",n=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Ki(t,r),s!=null&&n.unshift(Ji(t,s,i)),s=Ki(t,e),s!=null&&n.push(Ji(t,s,i))),t=t.return}return n}function sn(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Du(t,e,r,n,i){for(var s=e._reactName,o=[];r!==null&&r!==n;){var a=r,c=a.alternate,l=a.stateNode;if(c!==null&&c===n)break;a.tag===5&&l!==null&&(a=l,i?(c=Ki(r,s),c!=null&&o.unshift(Ji(r,c,a))):i||(c=Ki(r,s),c!=null&&o.push(Ji(r,c,a)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var Jv=/\r\n?/g,Zv=/\u0000|\uFFFD/g;function Eu(t){return(typeof t=="string"?t:""+t).replace(Jv,`
`).replace(Zv,"")}function js(t,e,r){if(e=Eu(e),Eu(t)!==e&&r)throw Error(R(425))}function Lo(){}var Hc=null,Kc=null;function Wc(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Qc=typeof setTimeout=="function"?setTimeout:void 0,e_=typeof clearTimeout=="function"?clearTimeout:void 0,Pu=typeof Promise=="function"?Promise:void 0,t_=typeof queueMicrotask=="function"?queueMicrotask:typeof Pu<"u"?function(t){return Pu.resolve(null).then(t).catch(r_)}:Qc;function r_(t){setTimeout(function(){throw t})}function Ya(t,e){var r=e,n=0;do{var i=r.nextSibling;if(t.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){t.removeChild(i),qi(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);qi(e)}function Dr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ku(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var ni=Math.random().toString(36).slice(2),$t="__reactFiber$"+ni,Zi="__reactProps$"+ni,nr="__reactContainer$"+ni,qc="__reactEvents$"+ni,n_="__reactListeners$"+ni,i_="__reactHandles$"+ni;function Vr(t){var e=t[$t];if(e)return e;for(var r=t.parentNode;r;){if(e=r[nr]||r[$t]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=ku(t);t!==null;){if(r=t[$t])return r;t=ku(t)}return e}t=r,r=t.parentNode}return null}function ds(t){return t=t[$t]||t[nr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ln(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(R(33))}function Jo(t){return t[Zi]||null}var Gc=[],Mn=-1;function Ar(t){return{current:t}}function ae(t){0>Mn||(t.current=Gc[Mn],Gc[Mn]=null,Mn--)}function se(t,e){Mn++,Gc[Mn]=t.current,t.current=e}var Ir={},Fe=Ar(Ir),qe=Ar(!1),qr=Ir;function qn(t,e){var r=t.type.contextTypes;if(!r)return Ir;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=e[s];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Ge(t){return t=t.childContextTypes,t!=null}function Mo(){ae(qe),ae(Fe)}function xu(t,e,r){if(Fe.current!==Ir)throw Error(R(168));se(Fe,e),se(qe,r)}function vh(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in e))throw Error(R(108,Ug(t)||"Unknown",i));return fe({},r,n)}function Oo(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ir,qr=Fe.current,se(Fe,t),se(qe,qe.current),!0}function Lu(t,e,r){var n=t.stateNode;if(!n)throw Error(R(169));r?(t=vh(t,e,qr),n.__reactInternalMemoizedMergedChildContext=t,ae(qe),ae(Fe),se(Fe,t)):ae(qe),se(qe,r)}var Jt=null,Zo=!1,Xa=!1;function _h(t){Jt===null?Jt=[t]:Jt.push(t)}function s_(t){Zo=!0,_h(t)}function $r(){if(!Xa&&Jt!==null){Xa=!0;var t=0,e=ee;try{var r=Jt;for(ee=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Jt=null,Zo=!1}catch(i){throw Jt!==null&&(Jt=Jt.slice(t+1)),Vf(Al,$r),i}finally{ee=e,Xa=!1}}return null}var On=[],In=0,Io=null,No=0,at=[],ct=0,Gr=null,Zt=1,er="";function zr(t,e){On[In++]=No,On[In++]=Io,Io=t,No=e}function yh(t,e,r){at[ct++]=Zt,at[ct++]=er,at[ct++]=Gr,Gr=t;var n=Zt;t=er;var i=32-St(n)-1;n&=~(1<<i),r+=1;var s=32-St(e)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Zt=1<<32-St(e)+i|r<<i|n,er=s+t}else Zt=1<<s|r<<i|n,er=t}function Wl(t){t.return!==null&&(zr(t,1),yh(t,1,0))}function Ql(t){for(;t===Io;)Io=On[--In],On[In]=null,No=On[--In],On[In]=null;for(;t===Gr;)Gr=at[--ct],at[ct]=null,er=at[--ct],at[ct]=null,Zt=at[--ct],at[ct]=null}var rt=null,tt=null,de=!1,wt=null;function wh(t,e){var r=dt(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Mu(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,rt=t,tt=Dr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,rt=t,tt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Gr!==null?{id:Zt,overflow:er}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=dt(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,rt=t,tt=null,!0):!1;default:return!1}}function Yc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Xc(t){if(de){var e=tt;if(e){var r=e;if(!Mu(t,e)){if(Yc(t))throw Error(R(418));e=Dr(r.nextSibling);var n=rt;e&&Mu(t,e)?wh(n,r):(t.flags=t.flags&-4097|2,de=!1,rt=t)}}else{if(Yc(t))throw Error(R(418));t.flags=t.flags&-4097|2,de=!1,rt=t}}}function Ou(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;rt=t}function As(t){if(t!==rt)return!1;if(!de)return Ou(t),de=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Wc(t.type,t.memoizedProps)),e&&(e=tt)){if(Yc(t))throw Sh(),Error(R(418));for(;e;)wh(t,e),e=Dr(e.nextSibling)}if(Ou(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(R(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){tt=Dr(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}tt=null}}else tt=rt?Dr(t.stateNode.nextSibling):null;return!0}function Sh(){for(var t=tt;t;)t=Dr(t.nextSibling)}function Gn(){tt=rt=null,de=!1}function ql(t){wt===null?wt=[t]:wt.push(t)}var o_=or.ReactCurrentBatchConfig;function _i(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(R(309));var n=r.stateNode}if(!n)throw Error(R(147,t));var i=n,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(R(284));if(!r._owner)throw Error(R(290,t))}return t}function $s(t,e){throw t=Object.prototype.toString.call(e),Error(R(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Iu(t){var e=t._init;return e(t._payload)}function Rh(t){function e(g,v){if(t){var _=g.deletions;_===null?(g.deletions=[v],g.flags|=16):_.push(v)}}function r(g,v){if(!t)return null;for(;v!==null;)e(g,v),v=v.sibling;return null}function n(g,v){for(g=new Map;v!==null;)v.key!==null?g.set(v.key,v):g.set(v.index,v),v=v.sibling;return g}function i(g,v){return g=xr(g,v),g.index=0,g.sibling=null,g}function s(g,v,_){return g.index=_,t?(_=g.alternate,_!==null?(_=_.index,_<v?(g.flags|=2,v):_):(g.flags|=2,v)):(g.flags|=1048576,v)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,v,_,w){return v===null||v.tag!==6?(v=ic(_,g.mode,w),v.return=g,v):(v=i(v,_),v.return=g,v)}function c(g,v,_,w){var b=_.type;return b===En?d(g,v,_.props.children,w,_.key):v!==null&&(v.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===vr&&Iu(b)===v.type)?(w=i(v,_.props),w.ref=_i(g,v,_),w.return=g,w):(w=_o(_.type,_.key,_.props,null,g.mode,w),w.ref=_i(g,v,_),w.return=g,w)}function l(g,v,_,w){return v===null||v.tag!==4||v.stateNode.containerInfo!==_.containerInfo||v.stateNode.implementation!==_.implementation?(v=sc(_,g.mode,w),v.return=g,v):(v=i(v,_.children||[]),v.return=g,v)}function d(g,v,_,w,b){return v===null||v.tag!==7?(v=Qr(_,g.mode,w,b),v.return=g,v):(v=i(v,_),v.return=g,v)}function p(g,v,_){if(typeof v=="string"&&v!==""||typeof v=="number")return v=ic(""+v,g.mode,_),v.return=g,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Es:return _=_o(v.type,v.key,v.props,null,g.mode,_),_.ref=_i(g,null,v),_.return=g,_;case Dn:return v=sc(v,g.mode,_),v.return=g,v;case vr:var w=v._init;return p(g,w(v._payload),_)}if(Ei(v)||fi(v))return v=Qr(v,g.mode,_,null),v.return=g,v;$s(g,v)}return null}function u(g,v,_,w){var b=v!==null?v.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return b!==null?null:a(g,v,""+_,w);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Es:return _.key===b?c(g,v,_,w):null;case Dn:return _.key===b?l(g,v,_,w):null;case vr:return b=_._init,u(g,v,b(_._payload),w)}if(Ei(_)||fi(_))return b!==null?null:d(g,v,_,w,null);$s(g,_)}return null}function f(g,v,_,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(_)||null,a(v,g,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Es:return g=g.get(w.key===null?_:w.key)||null,c(v,g,w,b);case Dn:return g=g.get(w.key===null?_:w.key)||null,l(v,g,w,b);case vr:var C=w._init;return f(g,v,_,C(w._payload),b)}if(Ei(w)||fi(w))return g=g.get(_)||null,d(v,g,w,b,null);$s(v,w)}return null}function h(g,v,_,w){for(var b=null,C=null,E=v,P=v=0,Y=null;E!==null&&P<_.length;P++){E.index>P?(Y=E,E=null):Y=E.sibling;var A=u(g,E,_[P],w);if(A===null){E===null&&(E=Y);break}t&&E&&A.alternate===null&&e(g,E),v=s(A,v,P),C===null?b=A:C.sibling=A,C=A,E=Y}if(P===_.length)return r(g,E),de&&zr(g,P),b;if(E===null){for(;P<_.length;P++)E=p(g,_[P],w),E!==null&&(v=s(E,v,P),C===null?b=E:C.sibling=E,C=E);return de&&zr(g,P),b}for(E=n(g,E);P<_.length;P++)Y=f(E,g,P,_[P],w),Y!==null&&(t&&Y.alternate!==null&&E.delete(Y.key===null?P:Y.key),v=s(Y,v,P),C===null?b=Y:C.sibling=Y,C=Y);return t&&E.forEach(function(_e){return e(g,_e)}),de&&zr(g,P),b}function m(g,v,_,w){var b=fi(_);if(typeof b!="function")throw Error(R(150));if(_=b.call(_),_==null)throw Error(R(151));for(var C=b=null,E=v,P=v=0,Y=null,A=_.next();E!==null&&!A.done;P++,A=_.next()){E.index>P?(Y=E,E=null):Y=E.sibling;var _e=u(g,E,A.value,w);if(_e===null){E===null&&(E=Y);break}t&&E&&_e.alternate===null&&e(g,E),v=s(_e,v,P),C===null?b=_e:C.sibling=_e,C=_e,E=Y}if(A.done)return r(g,E),de&&zr(g,P),b;if(E===null){for(;!A.done;P++,A=_.next())A=p(g,A.value,w),A!==null&&(v=s(A,v,P),C===null?b=A:C.sibling=A,C=A);return de&&zr(g,P),b}for(E=n(g,E);!A.done;P++,A=_.next())A=f(E,g,P,A.value,w),A!==null&&(t&&A.alternate!==null&&E.delete(A.key===null?P:A.key),v=s(A,v,P),C===null?b=A:C.sibling=A,C=A);return t&&E.forEach(function(Ie){return e(g,Ie)}),de&&zr(g,P),b}function y(g,v,_,w){if(typeof _=="object"&&_!==null&&_.type===En&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case Es:e:{for(var b=_.key,C=v;C!==null;){if(C.key===b){if(b=_.type,b===En){if(C.tag===7){r(g,C.sibling),v=i(C,_.props.children),v.return=g,g=v;break e}}else if(C.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===vr&&Iu(b)===C.type){r(g,C.sibling),v=i(C,_.props),v.ref=_i(g,C,_),v.return=g,g=v;break e}r(g,C);break}else e(g,C);C=C.sibling}_.type===En?(v=Qr(_.props.children,g.mode,w,_.key),v.return=g,g=v):(w=_o(_.type,_.key,_.props,null,g.mode,w),w.ref=_i(g,v,_),w.return=g,g=w)}return o(g);case Dn:e:{for(C=_.key;v!==null;){if(v.key===C)if(v.tag===4&&v.stateNode.containerInfo===_.containerInfo&&v.stateNode.implementation===_.implementation){r(g,v.sibling),v=i(v,_.children||[]),v.return=g,g=v;break e}else{r(g,v);break}else e(g,v);v=v.sibling}v=sc(_,g.mode,w),v.return=g,g=v}return o(g);case vr:return C=_._init,y(g,v,C(_._payload),w)}if(Ei(_))return h(g,v,_,w);if(fi(_))return m(g,v,_,w);$s(g,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,v!==null&&v.tag===6?(r(g,v.sibling),v=i(v,_),v.return=g,g=v):(r(g,v),v=ic(_,g.mode,w),v.return=g,g=v),o(g)):r(g,v)}return y}var Yn=Rh(!0),bh=Rh(!1),jo=Ar(null),Ao=null,Nn=null,Gl=null;function Yl(){Gl=Nn=Ao=null}function Xl(t){var e=jo.current;ae(jo),t._currentValue=e}function Jc(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Un(t,e){Ao=t,Gl=Nn=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Qe=!0),t.firstContext=null)}function pt(t){var e=t._currentValue;if(Gl!==t)if(t={context:t,memoizedValue:e,next:null},Nn===null){if(Ao===null)throw Error(R(308));Nn=t,Ao.dependencies={lanes:0,firstContext:t}}else Nn=Nn.next=t;return e}var Hr=null;function Jl(t){Hr===null?Hr=[t]:Hr.push(t)}function Ch(t,e,r,n){var i=e.interleaved;return i===null?(r.next=r,Jl(e)):(r.next=i.next,i.next=r),e.interleaved=r,ir(t,n)}function ir(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var _r=!1;function Zl(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Th(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function tr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Er(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,q&2){var i=n.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e,ir(t,r)}return i=n.interleaved,i===null?(e.next=e,Jl(n)):(e.next=i.next,i.next=e),n.interleaved=e,ir(t,r)}function po(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,$l(t,r)}}function Nu(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=e:s=s.next=e}else i=s=e;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function $o(t,e,r,n){var i=t.updateQueue;_r=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var c=a,l=c.next;c.next=null,o===null?s=l:o.next=l,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=l:a.next=l,d.lastBaseUpdate=c))}if(s!==null){var p=i.baseState;o=0,d=l=c=null,a=s;do{var u=a.lane,f=a.eventTime;if((n&u)===u){d!==null&&(d=d.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var h=t,m=a;switch(u=e,f=r,m.tag){case 1:if(h=m.payload,typeof h=="function"){p=h.call(f,p,u);break e}p=h;break e;case 3:h.flags=h.flags&-65537|128;case 0:if(h=m.payload,u=typeof h=="function"?h.call(f,p,u):h,u==null)break e;p=fe({},p,u);break e;case 2:_r=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,u=i.effects,u===null?i.effects=[a]:u.push(a))}else f={eventTime:f,lane:u,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(l=d=f,c=p):d=d.next=f,o|=u;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;u=a,a=u.next,u.next=null,i.lastBaseUpdate=u,i.shared.pending=null}}while(!0);if(d===null&&(c=p),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Xr|=o,t.lanes=o,t.memoizedState=p}}function ju(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(R(191,i));i.call(n)}}}var us={},Bt=Ar(us),es=Ar(us),ts=Ar(us);function Kr(t){if(t===us)throw Error(R(174));return t}function ed(t,e){switch(se(ts,e),se(es,t),se(Bt,us),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Mc(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Mc(e,t)}ae(Bt),se(Bt,e)}function Xn(){ae(Bt),ae(es),ae(ts)}function Dh(t){Kr(ts.current);var e=Kr(Bt.current),r=Mc(e,t.type);e!==r&&(se(es,t),se(Bt,r))}function td(t){es.current===t&&(ae(Bt),ae(es))}var ue=Ar(0);function Fo(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ja=[];function rd(){for(var t=0;t<Ja.length;t++)Ja[t]._workInProgressVersionPrimary=null;Ja.length=0}var fo=or.ReactCurrentDispatcher,Za=or.ReactCurrentBatchConfig,Yr=0,pe=null,Ee=null,ke=null,Bo=!1,ji=!1,rs=0,a_=0;function Ne(){throw Error(R(321))}function nd(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!bt(t[r],e[r]))return!1;return!0}function id(t,e,r,n,i,s){if(Yr=s,pe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,fo.current=t===null||t.memoizedState===null?u_:p_,t=r(n,i),ji){s=0;do{if(ji=!1,rs=0,25<=s)throw Error(R(301));s+=1,ke=Ee=null,e.updateQueue=null,fo.current=f_,t=r(n,i)}while(ji)}if(fo.current=zo,e=Ee!==null&&Ee.next!==null,Yr=0,ke=Ee=pe=null,Bo=!1,e)throw Error(R(300));return t}function sd(){var t=rs!==0;return rs=0,t}function At(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ke===null?pe.memoizedState=ke=t:ke=ke.next=t,ke}function ft(){if(Ee===null){var t=pe.alternate;t=t!==null?t.memoizedState:null}else t=Ee.next;var e=ke===null?pe.memoizedState:ke.next;if(e!==null)ke=e,Ee=t;else{if(t===null)throw Error(R(310));Ee=t,t={memoizedState:Ee.memoizedState,baseState:Ee.baseState,baseQueue:Ee.baseQueue,queue:Ee.queue,next:null},ke===null?pe.memoizedState=ke=t:ke=ke.next=t}return ke}function ns(t,e){return typeof e=="function"?e(t):e}function ec(t){var e=ft(),r=e.queue;if(r===null)throw Error(R(311));r.lastRenderedReducer=t;var n=Ee,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var a=o=null,c=null,l=s;do{var d=l.lane;if((Yr&d)===d)c!==null&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),n=l.hasEagerState?l.eagerState:t(n,l.action);else{var p={lane:d,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};c===null?(a=c=p,o=n):c=c.next=p,pe.lanes|=d,Xr|=d}l=l.next}while(l!==null&&l!==s);c===null?o=n:c.next=a,bt(n,e.memoizedState)||(Qe=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){i=t;do s=i.lane,pe.lanes|=s,Xr|=s,i=i.next;while(i!==t)}else i===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function tc(t){var e=ft(),r=e.queue;if(r===null)throw Error(R(311));r.lastRenderedReducer=t;var n=r.dispatch,i=r.pending,s=e.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);bt(s,e.memoizedState)||(Qe=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),r.lastRenderedState=s}return[s,n]}function Eh(){}function Ph(t,e){var r=pe,n=ft(),i=e(),s=!bt(n.memoizedState,i);if(s&&(n.memoizedState=i,Qe=!0),n=n.queue,od(Lh.bind(null,r,n,t),[t]),n.getSnapshot!==e||s||ke!==null&&ke.memoizedState.tag&1){if(r.flags|=2048,is(9,xh.bind(null,r,n,i,e),void 0,null),xe===null)throw Error(R(349));Yr&30||kh(r,e,i)}return i}function kh(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=pe.updateQueue,e===null?(e={lastEffect:null,stores:null},pe.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function xh(t,e,r,n){e.value=r,e.getSnapshot=n,Mh(e)&&Oh(t)}function Lh(t,e,r){return r(function(){Mh(e)&&Oh(t)})}function Mh(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!bt(t,r)}catch{return!0}}function Oh(t){var e=ir(t,1);e!==null&&Rt(e,t,1,-1)}function Au(t){var e=At();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:t},e.queue=t,t=t.dispatch=d_.bind(null,pe,t),[e.memoizedState,t]}function is(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=pe.updateQueue,e===null?(e={lastEffect:null,stores:null},pe.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function Ih(){return ft().memoizedState}function ho(t,e,r,n){var i=At();pe.flags|=t,i.memoizedState=is(1|e,r,void 0,n===void 0?null:n)}function ea(t,e,r,n){var i=ft();n=n===void 0?null:n;var s=void 0;if(Ee!==null){var o=Ee.memoizedState;if(s=o.destroy,n!==null&&nd(n,o.deps)){i.memoizedState=is(e,r,s,n);return}}pe.flags|=t,i.memoizedState=is(1|e,r,s,n)}function $u(t,e){return ho(8390656,8,t,e)}function od(t,e){return ea(2048,8,t,e)}function Nh(t,e){return ea(4,2,t,e)}function jh(t,e){return ea(4,4,t,e)}function Ah(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function $h(t,e,r){return r=r!=null?r.concat([t]):null,ea(4,4,Ah.bind(null,e,t),r)}function ad(){}function Fh(t,e){var r=ft();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&nd(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function Bh(t,e){var r=ft();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&nd(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function zh(t,e,r){return Yr&21?(bt(r,e)||(r=Wf(),pe.lanes|=r,Xr|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Qe=!0),t.memoizedState=r)}function c_(t,e){var r=ee;ee=r!==0&&4>r?r:4,t(!0);var n=Za.transition;Za.transition={};try{t(!1),e()}finally{ee=r,Za.transition=n}}function Uh(){return ft().memoizedState}function l_(t,e,r){var n=kr(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Vh(t))Hh(e,r);else if(r=Ch(t,e,r,n),r!==null){var i=Ve();Rt(r,t,n,i),Kh(r,e,n)}}function d_(t,e,r){var n=kr(t),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Vh(t))Hh(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,r);if(i.hasEagerState=!0,i.eagerState=a,bt(a,o)){var c=e.interleaved;c===null?(i.next=i,Jl(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}r=Ch(t,e,i,n),r!==null&&(i=Ve(),Rt(r,t,n,i),Kh(r,e,n))}}function Vh(t){var e=t.alternate;return t===pe||e!==null&&e===pe}function Hh(t,e){ji=Bo=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Kh(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,$l(t,r)}}var zo={readContext:pt,useCallback:Ne,useContext:Ne,useEffect:Ne,useImperativeHandle:Ne,useInsertionEffect:Ne,useLayoutEffect:Ne,useMemo:Ne,useReducer:Ne,useRef:Ne,useState:Ne,useDebugValue:Ne,useDeferredValue:Ne,useTransition:Ne,useMutableSource:Ne,useSyncExternalStore:Ne,useId:Ne,unstable_isNewReconciler:!1},u_={readContext:pt,useCallback:function(t,e){return At().memoizedState=[t,e===void 0?null:e],t},useContext:pt,useEffect:$u,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,ho(4194308,4,Ah.bind(null,e,t),r)},useLayoutEffect:function(t,e){return ho(4194308,4,t,e)},useInsertionEffect:function(t,e){return ho(4,2,t,e)},useMemo:function(t,e){var r=At();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=At();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=l_.bind(null,pe,t),[n.memoizedState,t]},useRef:function(t){var e=At();return t={current:t},e.memoizedState=t},useState:Au,useDebugValue:ad,useDeferredValue:function(t){return At().memoizedState=t},useTransition:function(){var t=Au(!1),e=t[0];return t=c_.bind(null,t[1]),At().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=pe,i=At();if(de){if(r===void 0)throw Error(R(407));r=r()}else{if(r=e(),xe===null)throw Error(R(349));Yr&30||kh(n,e,r)}i.memoizedState=r;var s={value:r,getSnapshot:e};return i.queue=s,$u(Lh.bind(null,n,s,t),[t]),n.flags|=2048,is(9,xh.bind(null,n,s,r,e),void 0,null),r},useId:function(){var t=At(),e=xe.identifierPrefix;if(de){var r=er,n=Zt;r=(n&~(1<<32-St(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=rs++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=a_++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},p_={readContext:pt,useCallback:Fh,useContext:pt,useEffect:od,useImperativeHandle:$h,useInsertionEffect:Nh,useLayoutEffect:jh,useMemo:Bh,useReducer:ec,useRef:Ih,useState:function(){return ec(ns)},useDebugValue:ad,useDeferredValue:function(t){var e=ft();return zh(e,Ee.memoizedState,t)},useTransition:function(){var t=ec(ns)[0],e=ft().memoizedState;return[t,e]},useMutableSource:Eh,useSyncExternalStore:Ph,useId:Uh,unstable_isNewReconciler:!1},f_={readContext:pt,useCallback:Fh,useContext:pt,useEffect:od,useImperativeHandle:$h,useInsertionEffect:Nh,useLayoutEffect:jh,useMemo:Bh,useReducer:tc,useRef:Ih,useState:function(){return tc(ns)},useDebugValue:ad,useDeferredValue:function(t){var e=ft();return Ee===null?e.memoizedState=t:zh(e,Ee.memoizedState,t)},useTransition:function(){var t=tc(ns)[0],e=ft().memoizedState;return[t,e]},useMutableSource:Eh,useSyncExternalStore:Ph,useId:Uh,unstable_isNewReconciler:!1};function vt(t,e){if(t&&t.defaultProps){e=fe({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Zc(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:fe({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var ta={isMounted:function(t){return(t=t._reactInternals)?en(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Ve(),i=kr(t),s=tr(n,i);s.payload=e,r!=null&&(s.callback=r),e=Er(t,s,i),e!==null&&(Rt(e,t,i,n),po(e,t,i))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Ve(),i=kr(t),s=tr(n,i);s.tag=1,s.payload=e,r!=null&&(s.callback=r),e=Er(t,s,i),e!==null&&(Rt(e,t,i,n),po(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Ve(),n=kr(t),i=tr(r,n);i.tag=2,e!=null&&(i.callback=e),e=Er(t,i,n),e!==null&&(Rt(e,t,n,r),po(e,t,n))}};function Fu(t,e,r,n,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,s,o):e.prototype&&e.prototype.isPureReactComponent?!Yi(r,n)||!Yi(i,s):!0}function Wh(t,e,r){var n=!1,i=Ir,s=e.contextType;return typeof s=="object"&&s!==null?s=pt(s):(i=Ge(e)?qr:Fe.current,n=e.contextTypes,s=(n=n!=null)?qn(t,i):Ir),e=new e(r,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ta,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Bu(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&ta.enqueueReplaceState(e,e.state,null)}function el(t,e,r,n){var i=t.stateNode;i.props=r,i.state=t.memoizedState,i.refs={},Zl(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=pt(s):(s=Ge(e)?qr:Fe.current,i.context=qn(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Zc(t,e,s,r),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&ta.enqueueReplaceState(i,i.state,null),$o(t,r,i,n),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Jn(t,e){try{var r="",n=e;do r+=zg(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function rc(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function tl(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var h_=typeof WeakMap=="function"?WeakMap:Map;function Qh(t,e,r){r=tr(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Vo||(Vo=!0,ul=n),tl(t,e)},r}function qh(t,e,r){r=tr(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var i=e.value;r.payload=function(){return n(i)},r.callback=function(){tl(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){tl(t,e),typeof n!="function"&&(Pr===null?Pr=new Set([this]):Pr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function zu(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new h_;var i=new Set;n.set(e,i)}else i=n.get(e),i===void 0&&(i=new Set,n.set(e,i));i.has(r)||(i.add(r),t=P_.bind(null,t,e,r),e.then(t,t))}function Uu(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Vu(t,e,r,n,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=tr(-1,1),e.tag=2,Er(r,e,1))),r.lanes|=1),t)}var m_=or.ReactCurrentOwner,Qe=!1;function Ue(t,e,r,n){e.child=t===null?bh(e,null,r,n):Yn(e,t.child,r,n)}function Hu(t,e,r,n,i){r=r.render;var s=e.ref;return Un(e,i),n=id(t,e,r,n,s,i),r=sd(),t!==null&&!Qe?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,sr(t,e,i)):(de&&r&&Wl(e),e.flags|=1,Ue(t,e,n,i),e.child)}function Ku(t,e,r,n,i){if(t===null){var s=r.type;return typeof s=="function"&&!md(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=s,Gh(t,e,s,n,i)):(t=_o(r.type,null,n,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Yi,r(o,n)&&t.ref===e.ref)return sr(t,e,i)}return e.flags|=1,t=xr(s,n),t.ref=e.ref,t.return=e,e.child=t}function Gh(t,e,r,n,i){if(t!==null){var s=t.memoizedProps;if(Yi(s,n)&&t.ref===e.ref)if(Qe=!1,e.pendingProps=n=s,(t.lanes&i)!==0)t.flags&131072&&(Qe=!0);else return e.lanes=t.lanes,sr(t,e,i)}return rl(t,e,r,n,i)}function Yh(t,e,r){var n=e.pendingProps,i=n.children,s=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},se(An,et),et|=r;else{if(!(r&1073741824))return t=s!==null?s.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,se(An,et),et|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,se(An,et),et|=n}else s!==null?(n=s.baseLanes|r,e.memoizedState=null):n=r,se(An,et),et|=n;return Ue(t,e,i,r),e.child}function Xh(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function rl(t,e,r,n,i){var s=Ge(r)?qr:Fe.current;return s=qn(e,s),Un(e,i),r=id(t,e,r,n,s,i),n=sd(),t!==null&&!Qe?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,sr(t,e,i)):(de&&n&&Wl(e),e.flags|=1,Ue(t,e,r,i),e.child)}function Wu(t,e,r,n,i){if(Ge(r)){var s=!0;Oo(e)}else s=!1;if(Un(e,i),e.stateNode===null)mo(t,e),Wh(e,r,n),el(e,r,n,i),n=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,l=r.contextType;typeof l=="object"&&l!==null?l=pt(l):(l=Ge(r)?qr:Fe.current,l=qn(e,l));var d=r.getDerivedStateFromProps,p=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||c!==l)&&Bu(e,o,n,l),_r=!1;var u=e.memoizedState;o.state=u,$o(e,n,o,i),c=e.memoizedState,a!==n||u!==c||qe.current||_r?(typeof d=="function"&&(Zc(e,r,d,n),c=e.memoizedState),(a=_r||Fu(e,r,a,n,u,c,l))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=l,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,Th(t,e),a=e.memoizedProps,l=e.type===e.elementType?a:vt(e.type,a),o.props=l,p=e.pendingProps,u=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=pt(c):(c=Ge(r)?qr:Fe.current,c=qn(e,c));var f=r.getDerivedStateFromProps;(d=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||u!==c)&&Bu(e,o,n,c),_r=!1,u=e.memoizedState,o.state=u,$o(e,n,o,i);var h=e.memoizedState;a!==p||u!==h||qe.current||_r?(typeof f=="function"&&(Zc(e,r,f,n),h=e.memoizedState),(l=_r||Fu(e,r,l,n,u,h,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,h,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,h,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&u===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&u===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=h),o.props=n,o.state=h,o.context=c,n=l):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&u===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&u===t.memoizedState||(e.flags|=1024),n=!1)}return nl(t,e,r,n,s,i)}function nl(t,e,r,n,i,s){Xh(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return i&&Lu(e,r,!1),sr(t,e,s);n=e.stateNode,m_.current=e;var a=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=Yn(e,t.child,null,s),e.child=Yn(e,null,a,s)):Ue(t,e,a,s),e.memoizedState=n.state,i&&Lu(e,r,!0),e.child}function Jh(t){var e=t.stateNode;e.pendingContext?xu(t,e.pendingContext,e.pendingContext!==e.context):e.context&&xu(t,e.context,!1),ed(t,e.containerInfo)}function Qu(t,e,r,n,i){return Gn(),ql(i),e.flags|=256,Ue(t,e,r,n),e.child}var il={dehydrated:null,treeContext:null,retryLane:0};function sl(t){return{baseLanes:t,cachePool:null,transitions:null}}function Zh(t,e,r){var n=e.pendingProps,i=ue.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),se(ue,i&1),t===null)return Xc(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,s?(n=e.mode,s=e.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=ia(o,n,0,null),t=Qr(t,n,r,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=sl(r),e.memoizedState=il,t):cd(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return g_(t,e,o,n,a,i,r);if(s){s=n.fallback,o=e.mode,i=t.child,a=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==i?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=xr(i,c),n.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=xr(a,s):(s=Qr(s,o,r,null),s.flags|=2),s.return=e,n.return=e,n.sibling=s,e.child=n,n=s,s=e.child,o=t.child.memoizedState,o=o===null?sl(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~r,e.memoizedState=il,n}return s=t.child,t=s.sibling,n=xr(s,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function cd(t,e){return e=ia({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Fs(t,e,r,n){return n!==null&&ql(n),Yn(e,t.child,null,r),t=cd(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function g_(t,e,r,n,i,s,o){if(r)return e.flags&256?(e.flags&=-257,n=rc(Error(R(422))),Fs(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=n.fallback,i=e.mode,n=ia({mode:"visible",children:n.children},i,0,null),s=Qr(s,i,o,null),s.flags|=2,n.return=e,s.return=e,n.sibling=s,e.child=n,e.mode&1&&Yn(e,t.child,null,o),e.child.memoizedState=sl(o),e.memoizedState=il,s);if(!(e.mode&1))return Fs(t,e,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var a=n.dgst;return n=a,s=Error(R(419)),n=rc(s,n,void 0),Fs(t,e,o,n)}if(a=(o&t.childLanes)!==0,Qe||a){if(n=xe,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ir(t,i),Rt(n,t,i,-1))}return hd(),n=rc(Error(R(421))),Fs(t,e,o,n)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=k_.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,tt=Dr(i.nextSibling),rt=e,de=!0,wt=null,t!==null&&(at[ct++]=Zt,at[ct++]=er,at[ct++]=Gr,Zt=t.id,er=t.overflow,Gr=e),e=cd(e,n.children),e.flags|=4096,e)}function qu(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),Jc(t.return,e,r)}function nc(t,e,r,n,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function em(t,e,r){var n=e.pendingProps,i=n.revealOrder,s=n.tail;if(Ue(t,e,n.children,r),n=ue.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&qu(t,r,e);else if(t.tag===19)qu(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(se(ue,n),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(r=e.child,i=null;r!==null;)t=r.alternate,t!==null&&Fo(t)===null&&(i=r),r=r.sibling;r=i,r===null?(i=e.child,e.child=null):(i=r.sibling,r.sibling=null),nc(e,!1,i,r,s);break;case"backwards":for(r=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Fo(t)===null){e.child=i;break}t=i.sibling,i.sibling=r,r=i,i=t}nc(e,!0,r,null,s);break;case"together":nc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function mo(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function sr(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Xr|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(R(153));if(e.child!==null){for(t=e.child,r=xr(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=xr(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function v_(t,e,r){switch(e.tag){case 3:Jh(e),Gn();break;case 5:Dh(e);break;case 1:Ge(e.type)&&Oo(e);break;case 4:ed(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,i=e.memoizedProps.value;se(jo,n._currentValue),n._currentValue=i;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(se(ue,ue.current&1),e.flags|=128,null):r&e.child.childLanes?Zh(t,e,r):(se(ue,ue.current&1),t=sr(t,e,r),t!==null?t.sibling:null);se(ue,ue.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return em(t,e,r);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),se(ue,ue.current),n)break;return null;case 22:case 23:return e.lanes=0,Yh(t,e,r)}return sr(t,e,r)}var tm,ol,rm,nm;tm=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};ol=function(){};rm=function(t,e,r,n){var i=t.memoizedProps;if(i!==n){t=e.stateNode,Kr(Bt.current);var s=null;switch(r){case"input":i=Pc(t,i),n=Pc(t,n),s=[];break;case"select":i=fe({},i,{value:void 0}),n=fe({},n,{value:void 0}),s=[];break;case"textarea":i=Lc(t,i),n=Lc(t,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Lo)}Oc(r,n);var o;r=null;for(l in i)if(!n.hasOwnProperty(l)&&i.hasOwnProperty(l)&&i[l]!=null)if(l==="style"){var a=i[l];for(o in a)a.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Vi.hasOwnProperty(l)?s||(s=[]):(s=s||[]).push(l,null));for(l in n){var c=n[l];if(a=i!=null?i[l]:void 0,n.hasOwnProperty(l)&&c!==a&&(c!=null||a!=null))if(l==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(l,r)),r=c;else l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(l,c)):l==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(l,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(Vi.hasOwnProperty(l)?(c!=null&&l==="onScroll"&&oe("scroll",t),s||a===c||(s=[])):(s=s||[]).push(l,c))}r&&(s=s||[]).push("style",r);var l=s;(e.updateQueue=l)&&(e.flags|=4)}};nm=function(t,e,r,n){r!==n&&(e.flags|=4)};function yi(t,e){if(!de)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function je(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function __(t,e,r){var n=e.pendingProps;switch(Ql(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return je(e),null;case 1:return Ge(e.type)&&Mo(),je(e),null;case 3:return n=e.stateNode,Xn(),ae(qe),ae(Fe),rd(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(As(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,wt!==null&&(hl(wt),wt=null))),ol(t,e),je(e),null;case 5:td(e);var i=Kr(ts.current);if(r=e.type,t!==null&&e.stateNode!=null)rm(t,e,r,n,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(R(166));return je(e),null}if(t=Kr(Bt.current),As(e)){n=e.stateNode,r=e.type;var s=e.memoizedProps;switch(n[$t]=e,n[Zi]=s,t=(e.mode&1)!==0,r){case"dialog":oe("cancel",n),oe("close",n);break;case"iframe":case"object":case"embed":oe("load",n);break;case"video":case"audio":for(i=0;i<ki.length;i++)oe(ki[i],n);break;case"source":oe("error",n);break;case"img":case"image":case"link":oe("error",n),oe("load",n);break;case"details":oe("toggle",n);break;case"input":nu(n,s),oe("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},oe("invalid",n);break;case"textarea":su(n,s),oe("invalid",n)}Oc(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?n.textContent!==a&&(s.suppressHydrationWarning!==!0&&js(n.textContent,a,t),i=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&js(n.textContent,a,t),i=["children",""+a]):Vi.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&oe("scroll",n)}switch(r){case"input":Ps(n),iu(n,s,!0);break;case"textarea":Ps(n),ou(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Lo)}n=i,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Lf(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[$t]=e,t[Zi]=n,tm(t,e,!1,!1),e.stateNode=t;e:{switch(o=Ic(r,n),r){case"dialog":oe("cancel",t),oe("close",t),i=n;break;case"iframe":case"object":case"embed":oe("load",t),i=n;break;case"video":case"audio":for(i=0;i<ki.length;i++)oe(ki[i],t);i=n;break;case"source":oe("error",t),i=n;break;case"img":case"image":case"link":oe("error",t),oe("load",t),i=n;break;case"details":oe("toggle",t),i=n;break;case"input":nu(t,n),i=Pc(t,n),oe("invalid",t);break;case"option":i=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},i=fe({},n,{value:void 0}),oe("invalid",t);break;case"textarea":su(t,n),i=Lc(t,n),oe("invalid",t);break;default:i=n}Oc(r,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?If(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Mf(t,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Hi(t,c):typeof c=="number"&&Hi(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Vi.hasOwnProperty(s)?c!=null&&s==="onScroll"&&oe("scroll",t):c!=null&&Ml(t,s,c,o))}switch(r){case"input":Ps(t),iu(t,n,!1);break;case"textarea":Ps(t),ou(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Or(n.value));break;case"select":t.multiple=!!n.multiple,s=n.value,s!=null?$n(t,!!n.multiple,s,!1):n.defaultValue!=null&&$n(t,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Lo)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return je(e),null;case 6:if(t&&e.stateNode!=null)nm(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(R(166));if(r=Kr(ts.current),Kr(Bt.current),As(e)){if(n=e.stateNode,r=e.memoizedProps,n[$t]=e,(s=n.nodeValue!==r)&&(t=rt,t!==null))switch(t.tag){case 3:js(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&js(n.nodeValue,r,(t.mode&1)!==0)}s&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[$t]=e,e.stateNode=n}return je(e),null;case 13:if(ae(ue),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(de&&tt!==null&&e.mode&1&&!(e.flags&128))Sh(),Gn(),e.flags|=98560,s=!1;else if(s=As(e),n!==null&&n.dehydrated!==null){if(t===null){if(!s)throw Error(R(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(R(317));s[$t]=e}else Gn(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;je(e),s=!1}else wt!==null&&(hl(wt),wt=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||ue.current&1?Pe===0&&(Pe=3):hd())),e.updateQueue!==null&&(e.flags|=4),je(e),null);case 4:return Xn(),ol(t,e),t===null&&Xi(e.stateNode.containerInfo),je(e),null;case 10:return Xl(e.type._context),je(e),null;case 17:return Ge(e.type)&&Mo(),je(e),null;case 19:if(ae(ue),s=e.memoizedState,s===null)return je(e),null;if(n=(e.flags&128)!==0,o=s.rendering,o===null)if(n)yi(s,!1);else{if(Pe!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Fo(t),o!==null){for(e.flags|=128,yi(s,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)s=r,t=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return se(ue,ue.current&1|2),e.child}t=t.sibling}s.tail!==null&&ye()>Zn&&(e.flags|=128,n=!0,yi(s,!1),e.lanes=4194304)}else{if(!n)if(t=Fo(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),yi(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!de)return je(e),null}else 2*ye()-s.renderingStartTime>Zn&&r!==1073741824&&(e.flags|=128,n=!0,yi(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(r=s.last,r!==null?r.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ye(),e.sibling=null,r=ue.current,se(ue,n?r&1|2:r&1),e):(je(e),null);case 22:case 23:return fd(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?et&1073741824&&(je(e),e.subtreeFlags&6&&(e.flags|=8192)):je(e),null;case 24:return null;case 25:return null}throw Error(R(156,e.tag))}function y_(t,e){switch(Ql(e),e.tag){case 1:return Ge(e.type)&&Mo(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Xn(),ae(qe),ae(Fe),rd(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return td(e),null;case 13:if(ae(ue),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(R(340));Gn()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ae(ue),null;case 4:return Xn(),null;case 10:return Xl(e.type._context),null;case 22:case 23:return fd(),null;case 24:return null;default:return null}}var Bs=!1,Ae=!1,w_=typeof WeakSet=="function"?WeakSet:Set,D=null;function jn(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ge(t,e,n)}else r.current=null}function al(t,e,r){try{r()}catch(n){ge(t,e,n)}}var Gu=!1;function S_(t,e){if(Hc=Po,t=ch(),Kl(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,a=-1,c=-1,l=0,d=0,p=t,u=null;t:for(;;){for(var f;p!==r||i!==0&&p.nodeType!==3||(a=o+i),p!==s||n!==0&&p.nodeType!==3||(c=o+n),p.nodeType===3&&(o+=p.nodeValue.length),(f=p.firstChild)!==null;)u=p,p=f;for(;;){if(p===t)break t;if(u===r&&++l===i&&(a=o),u===s&&++d===n&&(c=o),(f=p.nextSibling)!==null)break;p=u,u=p.parentNode}p=f}r=a===-1||c===-1?null:{start:a,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Kc={focusedElem:t,selectionRange:r},Po=!1,D=e;D!==null;)if(e=D,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,D=t;else for(;D!==null;){e=D;try{var h=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var m=h.memoizedProps,y=h.memoizedState,g=e.stateNode,v=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:vt(e.type,m),y);g.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(R(163))}}catch(w){ge(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,D=t;break}D=e.return}return h=Gu,Gu=!1,h}function Ai(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&al(e,r,s)}i=i.next}while(i!==n)}}function ra(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function cl(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function im(t){var e=t.alternate;e!==null&&(t.alternate=null,im(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[$t],delete e[Zi],delete e[qc],delete e[n_],delete e[i_])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function sm(t){return t.tag===5||t.tag===3||t.tag===4}function Yu(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||sm(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ll(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Lo));else if(n!==4&&(t=t.child,t!==null))for(ll(t,e,r),t=t.sibling;t!==null;)ll(t,e,r),t=t.sibling}function dl(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(dl(t,e,r),t=t.sibling;t!==null;)dl(t,e,r),t=t.sibling}var Le=null,_t=!1;function ur(t,e,r){for(r=r.child;r!==null;)om(t,e,r),r=r.sibling}function om(t,e,r){if(Ft&&typeof Ft.onCommitFiberUnmount=="function")try{Ft.onCommitFiberUnmount(qo,r)}catch{}switch(r.tag){case 5:Ae||jn(r,e);case 6:var n=Le,i=_t;Le=null,ur(t,e,r),Le=n,_t=i,Le!==null&&(_t?(t=Le,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Le.removeChild(r.stateNode));break;case 18:Le!==null&&(_t?(t=Le,r=r.stateNode,t.nodeType===8?Ya(t.parentNode,r):t.nodeType===1&&Ya(t,r),qi(t)):Ya(Le,r.stateNode));break;case 4:n=Le,i=_t,Le=r.stateNode.containerInfo,_t=!0,ur(t,e,r),Le=n,_t=i;break;case 0:case 11:case 14:case 15:if(!Ae&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&al(r,e,o),i=i.next}while(i!==n)}ur(t,e,r);break;case 1:if(!Ae&&(jn(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(a){ge(r,e,a)}ur(t,e,r);break;case 21:ur(t,e,r);break;case 22:r.mode&1?(Ae=(n=Ae)||r.memoizedState!==null,ur(t,e,r),Ae=n):ur(t,e,r);break;default:ur(t,e,r)}}function Xu(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new w_),e.forEach(function(n){var i=x_.bind(null,t,n);r.has(n)||(r.add(n),n.then(i,i))})}}function gt(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Le=a.stateNode,_t=!1;break e;case 3:Le=a.stateNode.containerInfo,_t=!0;break e;case 4:Le=a.stateNode.containerInfo,_t=!0;break e}a=a.return}if(Le===null)throw Error(R(160));om(s,o,i),Le=null,_t=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(l){ge(i,e,l)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)am(e,t),e=e.sibling}function am(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(gt(e,t),Et(t),n&4){try{Ai(3,t,t.return),ra(3,t)}catch(m){ge(t,t.return,m)}try{Ai(5,t,t.return)}catch(m){ge(t,t.return,m)}}break;case 1:gt(e,t),Et(t),n&512&&r!==null&&jn(r,r.return);break;case 5:if(gt(e,t),Et(t),n&512&&r!==null&&jn(r,r.return),t.flags&32){var i=t.stateNode;try{Hi(i,"")}catch(m){ge(t,t.return,m)}}if(n&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=r!==null?r.memoizedProps:s,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&kf(i,s),Ic(a,o);var l=Ic(a,s);for(o=0;o<c.length;o+=2){var d=c[o],p=c[o+1];d==="style"?If(i,p):d==="dangerouslySetInnerHTML"?Mf(i,p):d==="children"?Hi(i,p):Ml(i,d,p,l)}switch(a){case"input":kc(i,s);break;case"textarea":xf(i,s);break;case"select":var u=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?$n(i,!!s.multiple,f,!1):u!==!!s.multiple&&(s.defaultValue!=null?$n(i,!!s.multiple,s.defaultValue,!0):$n(i,!!s.multiple,s.multiple?[]:"",!1))}i[Zi]=s}catch(m){ge(t,t.return,m)}}break;case 6:if(gt(e,t),Et(t),n&4){if(t.stateNode===null)throw Error(R(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){ge(t,t.return,m)}}break;case 3:if(gt(e,t),Et(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{qi(e.containerInfo)}catch(m){ge(t,t.return,m)}break;case 4:gt(e,t),Et(t);break;case 13:gt(e,t),Et(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(ud=ye())),n&4&&Xu(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Ae=(l=Ae)||d,gt(e,t),Ae=l):gt(e,t),Et(t),n&8192){if(l=t.memoizedState!==null,(t.stateNode.isHidden=l)&&!d&&t.mode&1)for(D=t,d=t.child;d!==null;){for(p=D=d;D!==null;){switch(u=D,f=u.child,u.tag){case 0:case 11:case 14:case 15:Ai(4,u,u.return);break;case 1:jn(u,u.return);var h=u.stateNode;if(typeof h.componentWillUnmount=="function"){n=u,r=u.return;try{e=n,h.props=e.memoizedProps,h.state=e.memoizedState,h.componentWillUnmount()}catch(m){ge(n,r,m)}}break;case 5:jn(u,u.return);break;case 22:if(u.memoizedState!==null){Zu(p);continue}}f!==null?(f.return=u,D=f):Zu(p)}d=d.sibling}e:for(d=null,p=t;;){if(p.tag===5){if(d===null){d=p;try{i=p.stateNode,l?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=Of("display",o))}catch(m){ge(t,t.return,m)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=l?"":p.memoizedProps}catch(m){ge(t,t.return,m)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:gt(e,t),Et(t),n&4&&Xu(t);break;case 21:break;default:gt(e,t),Et(t)}}function Et(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(sm(r)){var n=r;break e}r=r.return}throw Error(R(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Hi(i,""),n.flags&=-33);var s=Yu(t);dl(t,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,a=Yu(t);ll(t,a,o);break;default:throw Error(R(161))}}catch(c){ge(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function R_(t,e,r){D=t,cm(t)}function cm(t,e,r){for(var n=(t.mode&1)!==0;D!==null;){var i=D,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||Bs;if(!o){var a=i.alternate,c=a!==null&&a.memoizedState!==null||Ae;a=Bs;var l=Ae;if(Bs=o,(Ae=c)&&!l)for(D=i;D!==null;)o=D,c=o.child,o.tag===22&&o.memoizedState!==null?ep(i):c!==null?(c.return=o,D=c):ep(i);for(;s!==null;)D=s,cm(s),s=s.sibling;D=i,Bs=a,Ae=l}Ju(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,D=s):Ju(t)}}function Ju(t){for(;D!==null;){var e=D;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ae||ra(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Ae)if(r===null)n.componentDidMount();else{var i=e.elementType===e.type?r.memoizedProps:vt(e.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&ju(e,s,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}ju(e,o,r)}break;case 5:var a=e.stateNode;if(r===null&&e.flags&4){r=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var d=l.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&qi(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(R(163))}Ae||e.flags&512&&cl(e)}catch(u){ge(e,e.return,u)}}if(e===t){D=null;break}if(r=e.sibling,r!==null){r.return=e.return,D=r;break}D=e.return}}function Zu(t){for(;D!==null;){var e=D;if(e===t){D=null;break}var r=e.sibling;if(r!==null){r.return=e.return,D=r;break}D=e.return}}function ep(t){for(;D!==null;){var e=D;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{ra(4,e)}catch(c){ge(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var i=e.return;try{n.componentDidMount()}catch(c){ge(e,i,c)}}var s=e.return;try{cl(e)}catch(c){ge(e,s,c)}break;case 5:var o=e.return;try{cl(e)}catch(c){ge(e,o,c)}}}catch(c){ge(e,e.return,c)}if(e===t){D=null;break}var a=e.sibling;if(a!==null){a.return=e.return,D=a;break}D=e.return}}var b_=Math.ceil,Uo=or.ReactCurrentDispatcher,ld=or.ReactCurrentOwner,ut=or.ReactCurrentBatchConfig,q=0,xe=null,Re=null,Me=0,et=0,An=Ar(0),Pe=0,ss=null,Xr=0,na=0,dd=0,$i=null,We=null,ud=0,Zn=1/0,Xt=null,Vo=!1,ul=null,Pr=null,zs=!1,Rr=null,Ho=0,Fi=0,pl=null,go=-1,vo=0;function Ve(){return q&6?ye():go!==-1?go:go=ye()}function kr(t){return t.mode&1?q&2&&Me!==0?Me&-Me:o_.transition!==null?(vo===0&&(vo=Wf()),vo):(t=ee,t!==0||(t=window.event,t=t===void 0?16:Zf(t.type)),t):1}function Rt(t,e,r,n){if(50<Fi)throw Fi=0,pl=null,Error(R(185));cs(t,r,n),(!(q&2)||t!==xe)&&(t===xe&&(!(q&2)&&(na|=r),Pe===4&&wr(t,Me)),Ye(t,n),r===1&&q===0&&!(e.mode&1)&&(Zn=ye()+500,Zo&&$r()))}function Ye(t,e){var r=t.callbackNode;ov(t,e);var n=Eo(t,t===xe?Me:0);if(n===0)r!==null&&lu(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&lu(r),e===1)t.tag===0?s_(tp.bind(null,t)):_h(tp.bind(null,t)),t_(function(){!(q&6)&&$r()}),r=null;else{switch(Qf(n)){case 1:r=Al;break;case 4:r=Hf;break;case 16:r=Do;break;case 536870912:r=Kf;break;default:r=Do}r=gm(r,lm.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function lm(t,e){if(go=-1,vo=0,q&6)throw Error(R(327));var r=t.callbackNode;if(Vn()&&t.callbackNode!==r)return null;var n=Eo(t,t===xe?Me:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Ko(t,n);else{e=n;var i=q;q|=2;var s=um();(xe!==t||Me!==e)&&(Xt=null,Zn=ye()+500,Wr(t,e));do try{D_();break}catch(a){dm(t,a)}while(!0);Yl(),Uo.current=s,q=i,Re!==null?e=0:(xe=null,Me=0,e=Pe)}if(e!==0){if(e===2&&(i=Fc(t),i!==0&&(n=i,e=fl(t,i))),e===1)throw r=ss,Wr(t,0),wr(t,n),Ye(t,ye()),r;if(e===6)wr(t,n);else{if(i=t.current.alternate,!(n&30)&&!C_(i)&&(e=Ko(t,n),e===2&&(s=Fc(t),s!==0&&(n=s,e=fl(t,s))),e===1))throw r=ss,Wr(t,0),wr(t,n),Ye(t,ye()),r;switch(t.finishedWork=i,t.finishedLanes=n,e){case 0:case 1:throw Error(R(345));case 2:Ur(t,We,Xt);break;case 3:if(wr(t,n),(n&130023424)===n&&(e=ud+500-ye(),10<e)){if(Eo(t,0)!==0)break;if(i=t.suspendedLanes,(i&n)!==n){Ve(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Qc(Ur.bind(null,t,We,Xt),e);break}Ur(t,We,Xt);break;case 4:if(wr(t,n),(n&4194240)===n)break;for(e=t.eventTimes,i=-1;0<n;){var o=31-St(n);s=1<<o,o=e[o],o>i&&(i=o),n&=~s}if(n=i,n=ye()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*b_(n/1960))-n,10<n){t.timeoutHandle=Qc(Ur.bind(null,t,We,Xt),n);break}Ur(t,We,Xt);break;case 5:Ur(t,We,Xt);break;default:throw Error(R(329))}}}return Ye(t,ye()),t.callbackNode===r?lm.bind(null,t):null}function fl(t,e){var r=$i;return t.current.memoizedState.isDehydrated&&(Wr(t,e).flags|=256),t=Ko(t,e),t!==2&&(e=We,We=r,e!==null&&hl(e)),t}function hl(t){We===null?We=t:We.push.apply(We,t)}function C_(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!bt(s(),i))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function wr(t,e){for(e&=~dd,e&=~na,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-St(e),n=1<<r;t[r]=-1,e&=~n}}function tp(t){if(q&6)throw Error(R(327));Vn();var e=Eo(t,0);if(!(e&1))return Ye(t,ye()),null;var r=Ko(t,e);if(t.tag!==0&&r===2){var n=Fc(t);n!==0&&(e=n,r=fl(t,n))}if(r===1)throw r=ss,Wr(t,0),wr(t,e),Ye(t,ye()),r;if(r===6)throw Error(R(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ur(t,We,Xt),Ye(t,ye()),null}function pd(t,e){var r=q;q|=1;try{return t(e)}finally{q=r,q===0&&(Zn=ye()+500,Zo&&$r())}}function Jr(t){Rr!==null&&Rr.tag===0&&!(q&6)&&Vn();var e=q;q|=1;var r=ut.transition,n=ee;try{if(ut.transition=null,ee=1,t)return t()}finally{ee=n,ut.transition=r,q=e,!(q&6)&&$r()}}function fd(){et=An.current,ae(An)}function Wr(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,e_(r)),Re!==null)for(r=Re.return;r!==null;){var n=r;switch(Ql(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Mo();break;case 3:Xn(),ae(qe),ae(Fe),rd();break;case 5:td(n);break;case 4:Xn();break;case 13:ae(ue);break;case 19:ae(ue);break;case 10:Xl(n.type._context);break;case 22:case 23:fd()}r=r.return}if(xe=t,Re=t=xr(t.current,null),Me=et=e,Pe=0,ss=null,dd=na=Xr=0,We=$i=null,Hr!==null){for(e=0;e<Hr.length;e++)if(r=Hr[e],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}Hr=null}return t}function dm(t,e){do{var r=Re;try{if(Yl(),fo.current=zo,Bo){for(var n=pe.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Bo=!1}if(Yr=0,ke=Ee=pe=null,ji=!1,rs=0,ld.current=null,r===null||r.return===null){Pe=1,ss=e,Re=null;break}e:{var s=t,o=r.return,a=r,c=e;if(e=Me,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var l=c,d=a,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var u=d.alternate;u?(d.updateQueue=u.updateQueue,d.memoizedState=u.memoizedState,d.lanes=u.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=Uu(o);if(f!==null){f.flags&=-257,Vu(f,o,a,s,e),f.mode&1&&zu(s,l,e),e=f,c=l;var h=e.updateQueue;if(h===null){var m=new Set;m.add(c),e.updateQueue=m}else h.add(c);break e}else{if(!(e&1)){zu(s,l,e),hd();break e}c=Error(R(426))}}else if(de&&a.mode&1){var y=Uu(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),Vu(y,o,a,s,e),ql(Jn(c,a));break e}}s=c=Jn(c,a),Pe!==4&&(Pe=2),$i===null?$i=[s]:$i.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=Qh(s,c,e);Nu(s,g);break e;case 1:a=c;var v=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Pr===null||!Pr.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=qh(s,a,e);Nu(s,w);break e}}s=s.return}while(s!==null)}fm(r)}catch(b){e=b,Re===r&&r!==null&&(Re=r=r.return);continue}break}while(!0)}function um(){var t=Uo.current;return Uo.current=zo,t===null?zo:t}function hd(){(Pe===0||Pe===3||Pe===2)&&(Pe=4),xe===null||!(Xr&268435455)&&!(na&268435455)||wr(xe,Me)}function Ko(t,e){var r=q;q|=2;var n=um();(xe!==t||Me!==e)&&(Xt=null,Wr(t,e));do try{T_();break}catch(i){dm(t,i)}while(!0);if(Yl(),q=r,Uo.current=n,Re!==null)throw Error(R(261));return xe=null,Me=0,Pe}function T_(){for(;Re!==null;)pm(Re)}function D_(){for(;Re!==null&&!Xg();)pm(Re)}function pm(t){var e=mm(t.alternate,t,et);t.memoizedProps=t.pendingProps,e===null?fm(t):Re=e,ld.current=null}function fm(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=y_(r,e),r!==null){r.flags&=32767,Re=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Pe=6,Re=null;return}}else if(r=__(r,e,et),r!==null){Re=r;return}if(e=e.sibling,e!==null){Re=e;return}Re=e=t}while(e!==null);Pe===0&&(Pe=5)}function Ur(t,e,r){var n=ee,i=ut.transition;try{ut.transition=null,ee=1,E_(t,e,r,n)}finally{ut.transition=i,ee=n}return null}function E_(t,e,r,n){do Vn();while(Rr!==null);if(q&6)throw Error(R(327));r=t.finishedWork;var i=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(R(177));t.callbackNode=null,t.callbackPriority=0;var s=r.lanes|r.childLanes;if(av(t,s),t===xe&&(Re=xe=null,Me=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||zs||(zs=!0,gm(Do,function(){return Vn(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=ut.transition,ut.transition=null;var o=ee;ee=1;var a=q;q|=4,ld.current=null,S_(t,r),am(r,t),Qv(Kc),Po=!!Hc,Kc=Hc=null,t.current=r,R_(r),Jg(),q=a,ee=o,ut.transition=s}else t.current=r;if(zs&&(zs=!1,Rr=t,Ho=i),s=t.pendingLanes,s===0&&(Pr=null),tv(r.stateNode),Ye(t,ye()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)i=e[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Vo)throw Vo=!1,t=ul,ul=null,t;return Ho&1&&t.tag!==0&&Vn(),s=t.pendingLanes,s&1?t===pl?Fi++:(Fi=0,pl=t):Fi=0,$r(),null}function Vn(){if(Rr!==null){var t=Qf(Ho),e=ut.transition,r=ee;try{if(ut.transition=null,ee=16>t?16:t,Rr===null)var n=!1;else{if(t=Rr,Rr=null,Ho=0,q&6)throw Error(R(331));var i=q;for(q|=4,D=t.current;D!==null;){var s=D,o=s.child;if(D.flags&16){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var l=a[c];for(D=l;D!==null;){var d=D;switch(d.tag){case 0:case 11:case 15:Ai(8,d,s)}var p=d.child;if(p!==null)p.return=d,D=p;else for(;D!==null;){d=D;var u=d.sibling,f=d.return;if(im(d),d===l){D=null;break}if(u!==null){u.return=f,D=u;break}D=f}}}var h=s.alternate;if(h!==null){var m=h.child;if(m!==null){h.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(m!==null)}}D=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,D=o;else e:for(;D!==null;){if(s=D,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ai(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,D=g;break e}D=s.return}}var v=t.current;for(D=v;D!==null;){o=D;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,D=_;else e:for(o=v;D!==null;){if(a=D,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:ra(9,a)}}catch(b){ge(a,a.return,b)}if(a===o){D=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,D=w;break e}D=a.return}}if(q=i,$r(),Ft&&typeof Ft.onPostCommitFiberRoot=="function")try{Ft.onPostCommitFiberRoot(qo,t)}catch{}n=!0}return n}finally{ee=r,ut.transition=e}}return!1}function rp(t,e,r){e=Jn(r,e),e=Qh(t,e,1),t=Er(t,e,1),e=Ve(),t!==null&&(cs(t,1,e),Ye(t,e))}function ge(t,e,r){if(t.tag===3)rp(t,t,r);else for(;e!==null;){if(e.tag===3){rp(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Pr===null||!Pr.has(n))){t=Jn(r,t),t=qh(e,t,1),e=Er(e,t,1),t=Ve(),e!==null&&(cs(e,1,t),Ye(e,t));break}}e=e.return}}function P_(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Ve(),t.pingedLanes|=t.suspendedLanes&r,xe===t&&(Me&r)===r&&(Pe===4||Pe===3&&(Me&130023424)===Me&&500>ye()-ud?Wr(t,0):dd|=r),Ye(t,e)}function hm(t,e){e===0&&(t.mode&1?(e=Ls,Ls<<=1,!(Ls&130023424)&&(Ls=4194304)):e=1);var r=Ve();t=ir(t,e),t!==null&&(cs(t,e,r),Ye(t,r))}function k_(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),hm(t,r)}function x_(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,i=t.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(R(314))}n!==null&&n.delete(e),hm(t,r)}var mm;mm=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||qe.current)Qe=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Qe=!1,v_(t,e,r);Qe=!!(t.flags&131072)}else Qe=!1,de&&e.flags&1048576&&yh(e,No,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;mo(t,e),t=e.pendingProps;var i=qn(e,Fe.current);Un(e,r),i=id(null,e,n,t,i,r);var s=sd();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ge(n)?(s=!0,Oo(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Zl(e),i.updater=ta,e.stateNode=i,i._reactInternals=e,el(e,n,t,r),e=nl(null,e,n,!0,s,r)):(e.tag=0,de&&s&&Wl(e),Ue(null,e,i,r),e=e.child),e;case 16:n=e.elementType;e:{switch(mo(t,e),t=e.pendingProps,i=n._init,n=i(n._payload),e.type=n,i=e.tag=M_(n),t=vt(n,t),i){case 0:e=rl(null,e,n,t,r);break e;case 1:e=Wu(null,e,n,t,r);break e;case 11:e=Hu(null,e,n,t,r);break e;case 14:e=Ku(null,e,n,vt(n.type,t),r);break e}throw Error(R(306,n,""))}return e;case 0:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:vt(n,i),rl(t,e,n,i,r);case 1:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:vt(n,i),Wu(t,e,n,i,r);case 3:e:{if(Jh(e),t===null)throw Error(R(387));n=e.pendingProps,s=e.memoizedState,i=s.element,Th(t,e),$o(e,n,null,r);var o=e.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Jn(Error(R(423)),e),e=Qu(t,e,n,r,i);break e}else if(n!==i){i=Jn(Error(R(424)),e),e=Qu(t,e,n,r,i);break e}else for(tt=Dr(e.stateNode.containerInfo.firstChild),rt=e,de=!0,wt=null,r=bh(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Gn(),n===i){e=sr(t,e,r);break e}Ue(t,e,n,r)}e=e.child}return e;case 5:return Dh(e),t===null&&Xc(e),n=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Wc(n,i)?o=null:s!==null&&Wc(n,s)&&(e.flags|=32),Xh(t,e),Ue(t,e,o,r),e.child;case 6:return t===null&&Xc(e),null;case 13:return Zh(t,e,r);case 4:return ed(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Yn(e,null,n,r):Ue(t,e,n,r),e.child;case 11:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:vt(n,i),Hu(t,e,n,i,r);case 7:return Ue(t,e,e.pendingProps,r),e.child;case 8:return Ue(t,e,e.pendingProps.children,r),e.child;case 12:return Ue(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,se(jo,n._currentValue),n._currentValue=o,s!==null)if(bt(s.value,o)){if(s.children===i.children&&!qe.current){e=sr(t,e,r);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=tr(-1,r&-r),c.tag=2;var l=s.updateQueue;if(l!==null){l=l.shared;var d=l.pending;d===null?c.next=c:(c.next=d.next,d.next=c),l.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),Jc(s.return,r,e),a.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(R(341));o.lanes|=r,a=o.alternate,a!==null&&(a.lanes|=r),Jc(o,r,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Ue(t,e,i.children,r),e=e.child}return e;case 9:return i=e.type,n=e.pendingProps.children,Un(e,r),i=pt(i),n=n(i),e.flags|=1,Ue(t,e,n,r),e.child;case 14:return n=e.type,i=vt(n,e.pendingProps),i=vt(n.type,i),Ku(t,e,n,i,r);case 15:return Gh(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,i=e.pendingProps,i=e.elementType===n?i:vt(n,i),mo(t,e),e.tag=1,Ge(n)?(t=!0,Oo(e)):t=!1,Un(e,r),Wh(e,n,i),el(e,n,i,r),nl(null,e,n,!0,t,r);case 19:return em(t,e,r);case 22:return Yh(t,e,r)}throw Error(R(156,e.tag))};function gm(t,e){return Vf(t,e)}function L_(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dt(t,e,r,n){return new L_(t,e,r,n)}function md(t){return t=t.prototype,!(!t||!t.isReactComponent)}function M_(t){if(typeof t=="function")return md(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Il)return 11;if(t===Nl)return 14}return 2}function xr(t,e){var r=t.alternate;return r===null?(r=dt(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function _o(t,e,r,n,i,s){var o=2;if(n=t,typeof t=="function")md(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case En:return Qr(r.children,i,s,e);case Ol:o=8,i|=8;break;case Cc:return t=dt(12,r,e,i|2),t.elementType=Cc,t.lanes=s,t;case Tc:return t=dt(13,r,e,i),t.elementType=Tc,t.lanes=s,t;case Dc:return t=dt(19,r,e,i),t.elementType=Dc,t.lanes=s,t;case Df:return ia(r,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Cf:o=10;break e;case Tf:o=9;break e;case Il:o=11;break e;case Nl:o=14;break e;case vr:o=16,n=null;break e}throw Error(R(130,t==null?t:typeof t,""))}return e=dt(o,r,e,i),e.elementType=t,e.type=n,e.lanes=s,e}function Qr(t,e,r,n){return t=dt(7,t,n,e),t.lanes=r,t}function ia(t,e,r,n){return t=dt(22,t,n,e),t.elementType=Df,t.lanes=r,t.stateNode={isHidden:!1},t}function ic(t,e,r){return t=dt(6,t,null,e),t.lanes=r,t}function sc(t,e,r){return e=dt(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function O_(t,e,r,n,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fa(0),this.expirationTimes=Fa(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fa(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function gd(t,e,r,n,i,s,o,a,c){return t=new O_(t,e,r,a,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=dt(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zl(s),t}function I_(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Dn,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function vm(t){if(!t)return Ir;t=t._reactInternals;e:{if(en(t)!==t||t.tag!==1)throw Error(R(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ge(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(R(171))}if(t.tag===1){var r=t.type;if(Ge(r))return vh(t,r,e)}return e}function _m(t,e,r,n,i,s,o,a,c){return t=gd(r,n,!0,t,i,s,o,a,c),t.context=vm(null),r=t.current,n=Ve(),i=kr(r),s=tr(n,i),s.callback=e??null,Er(r,s,i),t.current.lanes=i,cs(t,i,n),Ye(t,n),t}function sa(t,e,r,n){var i=e.current,s=Ve(),o=kr(i);return r=vm(r),e.context===null?e.context=r:e.pendingContext=r,e=tr(s,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Er(i,e,o),t!==null&&(Rt(t,i,o,s),po(t,i,o)),o}function Wo(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function np(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function vd(t,e){np(t,e),(t=t.alternate)&&np(t,e)}function N_(){return null}var ym=typeof reportError=="function"?reportError:function(t){console.error(t)};function _d(t){this._internalRoot=t}oa.prototype.render=_d.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(R(409));sa(t,e,null,null)};oa.prototype.unmount=_d.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Jr(function(){sa(null,t,null,null)}),e[nr]=null}};function oa(t){this._internalRoot=t}oa.prototype.unstable_scheduleHydration=function(t){if(t){var e=Yf();t={blockedOn:null,target:t,priority:e};for(var r=0;r<yr.length&&e!==0&&e<yr[r].priority;r++);yr.splice(r,0,t),r===0&&Jf(t)}};function yd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function aa(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ip(){}function j_(t,e,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var l=Wo(o);s.call(l)}}var o=_m(e,n,t,0,null,!1,!1,"",ip);return t._reactRootContainer=o,t[nr]=o.current,Xi(t.nodeType===8?t.parentNode:t),Jr(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof n=="function"){var a=n;n=function(){var l=Wo(c);a.call(l)}}var c=gd(t,0,!1,null,null,!1,!1,"",ip);return t._reactRootContainer=c,t[nr]=c.current,Xi(t.nodeType===8?t.parentNode:t),Jr(function(){sa(e,c,r,n)}),c}function ca(t,e,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var c=Wo(o);a.call(c)}}sa(e,o,t,i)}else o=j_(r,e,t,i,n);return Wo(o)}qf=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Pi(e.pendingLanes);r!==0&&($l(e,r|1),Ye(e,ye()),!(q&6)&&(Zn=ye()+500,$r()))}break;case 13:Jr(function(){var n=ir(t,1);if(n!==null){var i=Ve();Rt(n,t,1,i)}}),vd(t,1)}};Fl=function(t){if(t.tag===13){var e=ir(t,134217728);if(e!==null){var r=Ve();Rt(e,t,134217728,r)}vd(t,134217728)}};Gf=function(t){if(t.tag===13){var e=kr(t),r=ir(t,e);if(r!==null){var n=Ve();Rt(r,t,e,n)}vd(t,e)}};Yf=function(){return ee};Xf=function(t,e){var r=ee;try{return ee=t,e()}finally{ee=r}};jc=function(t,e,r){switch(e){case"input":if(kc(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var i=Jo(n);if(!i)throw Error(R(90));Pf(n),kc(n,i)}}}break;case"textarea":xf(t,r);break;case"select":e=r.value,e!=null&&$n(t,!!r.multiple,e,!1)}};Af=pd;$f=Jr;var A_={usingClientEntryPoint:!1,Events:[ds,Ln,Jo,Nf,jf,pd]},wi={findFiberByHostInstance:Vr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$_={bundleType:wi.bundleType,version:wi.version,rendererPackageName:wi.rendererPackageName,rendererConfig:wi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:or.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=zf(t),t===null?null:t.stateNode},findFiberByHostInstance:wi.findFiberByHostInstance||N_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Us=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Us.isDisabled&&Us.supportsFiber)try{qo=Us.inject($_),Ft=Us}catch{}}it.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=A_;it.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!yd(e))throw Error(R(200));return I_(t,e,null,r)};it.createRoot=function(t,e){if(!yd(t))throw Error(R(299));var r=!1,n="",i=ym;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=gd(t,1,!1,null,null,r,!1,n,i),t[nr]=e.current,Xi(t.nodeType===8?t.parentNode:t),new _d(e)};it.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(R(188)):(t=Object.keys(t).join(","),Error(R(268,t)));return t=zf(e),t=t===null?null:t.stateNode,t};it.flushSync=function(t){return Jr(t)};it.hydrate=function(t,e,r){if(!aa(e))throw Error(R(200));return ca(null,t,e,!0,r)};it.hydrateRoot=function(t,e,r){if(!yd(t))throw Error(R(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=ym;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=_m(e,null,t,1,r??null,i,!1,s,o),t[nr]=e.current,Xi(t),n)for(t=0;t<n.length;t++)r=n[t],i=r._getVersion,i=i(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,i]:e.mutableSourceEagerHydrationData.push(r,i);return new oa(e)};it.render=function(t,e,r){if(!aa(e))throw Error(R(200));return ca(null,t,e,!1,r)};it.unmountComponentAtNode=function(t){if(!aa(t))throw Error(R(40));return t._reactRootContainer?(Jr(function(){ca(null,null,t,!1,function(){t._reactRootContainer=null,t[nr]=null})}),!0):!1};it.unstable_batchedUpdates=pd;it.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!aa(r))throw Error(R(200));if(t==null||t._reactInternals===void 0)throw Error(R(38));return ca(t,e,r,!1,n)};it.version="18.3.1-next-f1338f8080-20240426";function wm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(wm)}catch(t){console.error(t)}}wm(),wf.exports=it;var F_=wf.exports,Sm,sp=F_;Sm=sp.createRoot,sp.hydrateRoot;const Ut=Object.create(null);Ut.open="0";Ut.close="1";Ut.ping="2";Ut.pong="3";Ut.message="4";Ut.upgrade="5";Ut.noop="6";const yo=Object.create(null);Object.keys(Ut).forEach(t=>{yo[Ut[t]]=t});const ml={type:"error",data:"parser error"},Rm=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",bm=typeof ArrayBuffer=="function",Cm=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,wd=({type:t,data:e},r,n)=>Rm&&e instanceof Blob?r?n(e):op(e,n):bm&&(e instanceof ArrayBuffer||Cm(e))?r?n(e):op(new Blob([e]),n):n(Ut[t]+(e||"")),op=(t,e)=>{const r=new FileReader;return r.onload=function(){const n=r.result.split(",")[1];e("b"+(n||""))},r.readAsDataURL(t)};function ap(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let oc;function B_(t,e){if(Rm&&t.data instanceof Blob)return t.data.arrayBuffer().then(ap).then(e);if(bm&&(t.data instanceof ArrayBuffer||Cm(t.data)))return e(ap(t.data));wd(t,!1,r=>{oc||(oc=new TextEncoder),e(oc.encode(r))})}const cp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",xi=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<cp.length;t++)xi[cp.charCodeAt(t)]=t;const z_=t=>{let e=t.length*.75,r=t.length,n,i=0,s,o,a,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const l=new ArrayBuffer(e),d=new Uint8Array(l);for(n=0;n<r;n+=4)s=xi[t.charCodeAt(n)],o=xi[t.charCodeAt(n+1)],a=xi[t.charCodeAt(n+2)],c=xi[t.charCodeAt(n+3)],d[i++]=s<<2|o>>4,d[i++]=(o&15)<<4|a>>2,d[i++]=(a&3)<<6|c&63;return l},U_=typeof ArrayBuffer=="function",Sd=(t,e)=>{if(typeof t!="string")return{type:"message",data:Tm(t,e)};const r=t.charAt(0);return r==="b"?{type:"message",data:V_(t.substring(1),e)}:yo[r]?t.length>1?{type:yo[r],data:t.substring(1)}:{type:yo[r]}:ml},V_=(t,e)=>{if(U_){const r=z_(t);return Tm(r,e)}else return{base64:!0,data:t}},Tm=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},Dm="",H_=(t,e)=>{const r=t.length,n=new Array(r);let i=0;t.forEach((s,o)=>{wd(s,!1,a=>{n[o]=a,++i===r&&e(n.join(Dm))})})},K_=(t,e)=>{const r=t.split(Dm),n=[];for(let i=0;i<r.length;i++){const s=Sd(r[i],e);if(n.push(s),s.type==="error")break}return n};function W_(){return new TransformStream({transform(t,e){B_(t,r=>{const n=r.length;let i;if(n<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,n);else if(n<65536){i=new Uint8Array(3);const s=new DataView(i.buffer);s.setUint8(0,126),s.setUint16(1,n)}else{i=new Uint8Array(9);const s=new DataView(i.buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(n))}t.data&&typeof t.data!="string"&&(i[0]|=128),e.enqueue(i),e.enqueue(r)})}})}let ac;function Vs(t){return t.reduce((e,r)=>e+r.length,0)}function Hs(t,e){if(t[0].length===e)return t.shift();const r=new Uint8Array(e);let n=0;for(let i=0;i<e;i++)r[i]=t[0][n++],n===t[0].length&&(t.shift(),n=0);return t.length&&n<t[0].length&&(t[0]=t[0].slice(n)),r}function Q_(t,e){ac||(ac=new TextDecoder);const r=[];let n=0,i=-1,s=!1;return new TransformStream({transform(o,a){for(r.push(o);;){if(n===0){if(Vs(r)<1)break;const c=Hs(r,1);s=(c[0]&128)===128,i=c[0]&127,i<126?n=3:i===126?n=1:n=2}else if(n===1){if(Vs(r)<2)break;const c=Hs(r,2);i=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),n=3}else if(n===2){if(Vs(r)<8)break;const c=Hs(r,8),l=new DataView(c.buffer,c.byteOffset,c.length),d=l.getUint32(0);if(d>Math.pow(2,21)-1){a.enqueue(ml);break}i=d*Math.pow(2,32)+l.getUint32(4),n=3}else{if(Vs(r)<i)break;const c=Hs(r,i);a.enqueue(Sd(s?c:ac.decode(c),e)),n=0}if(i===0||i>t){a.enqueue(ml);break}}}})}const Em=4;function be(t){if(t)return q_(t)}function q_(t){for(var e in be.prototype)t[e]=be.prototype[e];return t}be.prototype.on=be.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};be.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this};be.prototype.off=be.prototype.removeListener=be.prototype.removeAllListeners=be.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,i=0;i<r.length;i++)if(n=r[i],n===e||n.fn===e){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+t],this};be.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,e)}return this};be.prototype.emitReserved=be.prototype.emit;be.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};be.prototype.hasListeners=function(t){return!!this.listeners(t).length};const lt=typeof self<"u"?self:typeof window<"u"?window:Function("return this")();function Pm(t,...e){return e.reduce((r,n)=>(t.hasOwnProperty(n)&&(r[n]=t[n]),r),{})}const G_=lt.setTimeout,Y_=lt.clearTimeout;function la(t,e){e.useNativeTimers?(t.setTimeoutFn=G_.bind(lt),t.clearTimeoutFn=Y_.bind(lt)):(t.setTimeoutFn=lt.setTimeout.bind(lt),t.clearTimeoutFn=lt.clearTimeout.bind(lt))}const X_=1.33;function J_(t){return typeof t=="string"?Z_(t):Math.ceil((t.byteLength||t.size)*X_)}function Z_(t){let e=0,r=0;for(let n=0,i=t.length;n<i;n++)e=t.charCodeAt(n),e<128?r+=1:e<2048?r+=2:e<55296||e>=57344?r+=3:(n++,r+=4);return r}function ey(t){let e="";for(let r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e}function ty(t){let e={},r=t.split("&");for(let n=0,i=r.length;n<i;n++){let s=r[n].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}class ry extends Error{constructor(e,r,n){super(e),this.description=r,this.context=n,this.type="TransportError"}}let Rd=class extends be{constructor(e){super(),this.writable=!1,la(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,r,n){return super.emitReserved("error",new ry(e,r,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const r=Sd(e,this.socket.binaryType);this.onPacket(r)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,r={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const r=ey(e);return r.length?"?"+r:""}};const km="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),gl=64,ny={};let lp=0,Ks=0,dp;function up(t){let e="";do e=km[t%gl]+e,t=Math.floor(t/gl);while(t>0);return e}function xm(){const t=up(+new Date);return t!==dp?(lp=0,dp=t):t+"."+up(lp++)}for(;Ks<gl;Ks++)ny[km[Ks]]=Ks;let Lm=!1;try{Lm=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const iy=Lm;function Mm(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||iy))return new XMLHttpRequest}catch{}if(!e)try{return new lt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function sy(){}const oy=function(){return new Mm({xdomain:!1}).responseType!=null}();class ay extends Rd{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){const n=location.protocol==="https:";let i=location.port;i||(i=n?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||i!==e.port}const r=e&&e.forceBase64;this.supportsBinary=oy&&!r,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";const r=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let n=0;this.polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};K_(e,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,H_(e,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=xm()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(e,r)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new zt(this.uri(),e)}doWrite(e,r){const n=this.request({method:"POST",data:e});n.on("success",r),n.on("error",(i,s)=>{this.onError("xhr post error",i,s)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=e}}class zt extends be{constructor(e,r){super(),la(this,r),this.opts=r,this.method=r.method||"GET",this.uri=e,this.data=r.data!==void 0?r.data:null,this.create()}create(){var e;const r=Pm(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this.opts.xd;const n=this.xhr=new Mm(r);try{n.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let i in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(i)&&n.setRequestHeader(i,this.opts.extraHeaders[i])}}catch{}if(this.method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this.opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=()=>{var i;n.readyState===3&&((i=this.opts.cookieJar)===null||i===void 0||i.parseCookies(n)),n.readyState===4&&(n.status===200||n.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof n.status=="number"?n.status:0)},0))},n.send(this.data)}catch(i){this.setTimeoutFn(()=>{this.onError(i)},0);return}typeof document<"u"&&(this.index=zt.requestsCount++,zt.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=sy,e)try{this.xhr.abort()}catch{}typeof document<"u"&&delete zt.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}zt.requestsCount=0;zt.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",pp);else if(typeof addEventListener=="function"){const t="onpagehide"in lt?"pagehide":"unload";addEventListener(t,pp,!1)}}function pp(){for(let t in zt.requests)zt.requests.hasOwnProperty(t)&&zt.requests[t].abort()}const bd=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,r)=>r(e,0),Ws=lt.WebSocket||lt.MozWebSocket,fp=!0,cy="arraybuffer",hp=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class ly extends Rd{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),r=this.opts.protocols,n=hp?{}:Pm(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=fp&&!hp?r?new Ws(e,r):new Ws(e):new Ws(e,r,n)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let r=0;r<e.length;r++){const n=e[r],i=r===e.length-1;wd(n,this.supportsBinary,s=>{const o={};try{fp&&this.ws.send(s)}catch{}i&&bd(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=xm()),this.supportsBinary||(r.b64=1),this.createUri(e,r)}check(){return!!Ws}}class dy extends Rd{get name(){return"webtransport"}doOpen(){typeof WebTransport=="function"&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(e=>{const r=Q_(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(r).getReader(),i=W_();i.readable.pipeTo(e.writable),this.writer=i.writable.getWriter();const s=()=>{n.read().then(({done:a,value:c})=>{a||(this.onPacket(c),s())}).catch(a=>{})};s();const o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this.writer.write(o).then(()=>this.onOpen())})}))}write(e){this.writable=!1;for(let r=0;r<e.length;r++){const n=e[r],i=r===e.length-1;this.writer.write(n).then(()=>{i&&bd(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this.transport)===null||e===void 0||e.close()}}const uy={websocket:ly,webtransport:dy,polling:ay},py=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,fy=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function vl(t){if(t.length>2e3)throw"URI too long";const e=t,r=t.indexOf("["),n=t.indexOf("]");r!=-1&&n!=-1&&(t=t.substring(0,r)+t.substring(r,n).replace(/:/g,";")+t.substring(n,t.length));let i=py.exec(t||""),s={},o=14;for(;o--;)s[fy[o]]=i[o]||"";return r!=-1&&n!=-1&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=hy(s,s.path),s.queryKey=my(s,s.query),s}function hy(t,e){const r=/\/{2,9}/g,n=e.replace(r,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function my(t,e){const r={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,i,s){i&&(r[i]=s)}),r}let Om=class Tn extends be{constructor(e,r={}){super(),this.binaryType=cy,this.writeBuffer=[],e&&typeof e=="object"&&(r=e,e=null),e?(e=vl(e),r.hostname=e.host,r.secure=e.protocol==="https"||e.protocol==="wss",r.port=e.port,e.query&&(r.query=e.query)):r.host&&(r.hostname=vl(r.host).host),la(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=r.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=ty(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){const r=Object.assign({},this.opts.query);r.EIO=Em,r.transport=e,this.id&&(r.sid=this.id);const n=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new uy[e](n)}open(){let e;if(this.opts.rememberUpgrade&&Tn.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch{this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",r=>this.onClose("transport close",r))}probe(e){let r=this.createTransport(e),n=!1;Tn.priorWebsocketSuccess=!1;const i=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",p=>{if(!n)if(p.type==="pong"&&p.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;Tn.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(d(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const u=new Error("probe error");u.transport=r.name,this.emitReserved("upgradeError",u)}}))};function s(){n||(n=!0,d(),r.close(),r=null)}const o=p=>{const u=new Error("probe error: "+p);u.transport=r.name,s(),this.emitReserved("upgradeError",u)};function a(){o("transport closed")}function c(){o("socket closed")}function l(p){r&&p.name!==r.name&&s()}const d=()=>{r.removeListener("open",i),r.removeListener("error",o),r.removeListener("close",a),this.off("close",c),this.off("upgrading",l)};r.once("open",i),r.once("error",o),r.once("close",a),this.once("close",c),this.once("upgrading",l),this.upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onOpen(){if(this.readyState="open",Tn.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let e=0;const r=this.upgrades.length;for(;e<r;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),this.resetPingTimeout(),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const r=new Error("server error");r.code=e.data,this.onError(r);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){const i=this.writeBuffer[n].data;if(i&&(r+=J_(i)),n>0&&r>this.maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}write(e,r,n){return this.sendPacket("message",e,r,n),this}send(e,r,n){return this.sendPacket("message",e,r,n),this}sendPacket(e,r,n,i){if(typeof r=="function"&&(i=r,r=void 0),typeof n=="function"&&(i=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const s={type:e,data:r,options:n};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this.onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),e()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}onError(e){Tn.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,r){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,r),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){const r=[];let n=0;const i=e.length;for(;n<i;n++)~this.transports.indexOf(e[n])&&r.push(e[n]);return r}};Om.protocol=Em;function gy(t,e="",r){let n=t;r=r||typeof location<"u"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(typeof r<"u"?t=r.protocol+"//"+t:t="https://"+t),n=vl(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const s=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port+e,n.href=n.protocol+"://"+s+(r&&r.port===n.port?"":":"+n.port),n}const vy=typeof ArrayBuffer=="function",_y=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,Im=Object.prototype.toString,yy=typeof Blob=="function"||typeof Blob<"u"&&Im.call(Blob)==="[object BlobConstructor]",wy=typeof File=="function"||typeof File<"u"&&Im.call(File)==="[object FileConstructor]";function Cd(t){return vy&&(t instanceof ArrayBuffer||_y(t))||yy&&t instanceof Blob||wy&&t instanceof File}function wo(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(wo(t[r]))return!0;return!1}if(Cd(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return wo(t.toJSON(),!0);for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&wo(t[r]))return!0;return!1}function Sy(t){const e=[],r=t.data,n=t;return n.data=_l(r,e),n.attachments=e.length,{packet:n,buffers:e}}function _l(t,e){if(!t)return t;if(Cd(t)){const r={_placeholder:!0,num:e.length};return e.push(t),r}else if(Array.isArray(t)){const r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=_l(t[n],e);return r}else if(typeof t=="object"&&!(t instanceof Date)){const r={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=_l(t[n],e));return r}return t}function Ry(t,e){return t.data=yl(t.data,e),delete t.attachments,t}function yl(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=yl(t[r],e);else if(typeof t=="object")for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=yl(t[r],e));return t}const by=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Cy=5;var W;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(W||(W={}));class Ty{constructor(e){this.replacer=e}encode(e){return(e.type===W.EVENT||e.type===W.ACK)&&wo(e)?this.encodeAsBinary({type:e.type===W.EVENT?W.BINARY_EVENT:W.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let r=""+e.type;return(e.type===W.BINARY_EVENT||e.type===W.BINARY_ACK)&&(r+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(r+=e.nsp+","),e.id!=null&&(r+=e.id),e.data!=null&&(r+=JSON.stringify(e.data,this.replacer)),r}encodeAsBinary(e){const r=Sy(e),n=this.encodeAsString(r.packet),i=r.buffers;return i.unshift(n),i}}function mp(t){return Object.prototype.toString.call(t)==="[object Object]"}class Td extends be{constructor(e){super(),this.reviver=e}add(e){let r;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(e);const n=r.type===W.BINARY_EVENT;n||r.type===W.BINARY_ACK?(r.type=n?W.EVENT:W.ACK,this.reconstructor=new Dy(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(Cd(e)||e.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(e),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let r=0;const n={type:Number(e.charAt(0))};if(W[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===W.BINARY_EVENT||n.type===W.BINARY_ACK){const s=r+1;for(;e.charAt(++r)!=="-"&&r!=e.length;);const o=e.substring(s,r);if(o!=Number(o)||e.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(o)}if(e.charAt(r+1)==="/"){const s=r+1;for(;++r&&!(e.charAt(r)===","||r===e.length););n.nsp=e.substring(s,r)}else n.nsp="/";const i=e.charAt(r+1);if(i!==""&&Number(i)==i){const s=r+1;for(;++r;){const o=e.charAt(r);if(o==null||Number(o)!=o){--r;break}if(r===e.length)break}n.id=Number(e.substring(s,r+1))}if(e.charAt(++r)){const s=this.tryParse(e.substr(r));if(Td.isPayloadValid(n.type,s))n.data=s;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,r){switch(e){case W.CONNECT:return mp(r);case W.DISCONNECT:return r===void 0;case W.CONNECT_ERROR:return typeof r=="string"||mp(r);case W.EVENT:case W.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&by.indexOf(r[0])===-1);case W.ACK:case W.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Dy{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const r=Ry(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Ey=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Td,Encoder:Ty,get PacketType(){return W},protocol:Cy},Symbol.toStringTag,{value:"Module"}));function yt(t,e,r){return t.on(e,r),function(){t.off(e,r)}}const Py=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Nm extends be{constructor(e,r,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[yt(e,"open",this.onopen.bind(this)),yt(e,"packet",this.onpacket.bind(this)),yt(e,"error",this.onerror.bind(this)),yt(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...r){if(Py.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(r.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const n={type:W.EVENT,data:r};if(n.options={},n.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const o=this.ids++,a=r.pop();this._registerAckCallback(o,a),n.id=o}const i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!i||!this.connected)||(this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(e,r){var n;const i=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(i===void 0){this.acks[e]=r;return}const s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===e&&this.sendBuffer.splice(a,1);r.call(this,new Error("operation has timed out"))},i),o=(...a)=>{this.io.clearTimeoutFn(s),r.apply(this,a)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...r){return new Promise((n,i)=>{const s=(o,a)=>o?i(o):n(a);s.withError=!0,r.push(s),this.emit(e,...r)})}_addToQueue(e){let r;typeof e[e.length-1]=="function"&&(r=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((i,...s)=>n!==this._queue[0]?void 0:(i!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(i)):(this._queue.shift(),r&&r(null,...s)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!e||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:W.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case W.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case W.EVENT:case W.BINARY_EVENT:this.onevent(e);break;case W.ACK:case W.BINARY_ACK:this.onack(e);break;case W.DISCONNECT:this.ondisconnect();break;case W.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const r=e.data||[];e.id!=null&&r.push(this.ack(e.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const n of r)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const r=this;let n=!1;return function(...i){n||(n=!0,r.packet({type:W.ACK,id:e,data:i}))}}onack(e){const r=this.acks[e.id];typeof r=="function"&&(delete this.acks[e.id],r.withError&&e.data.unshift(null),r.apply(this,e.data))}onconnect(e,r){this.id=e,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:W.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const r=this._anyListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const n of r)n.apply(this,e.data)}}}function ii(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}ii.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=Math.floor(e*10)&1?t+r:t-r}return Math.min(t,this.max)|0};ii.prototype.reset=function(){this.attempts=0};ii.prototype.setMin=function(t){this.ms=t};ii.prototype.setMax=function(t){this.max=t};ii.prototype.setJitter=function(t){this.jitter=t};class wl extends be{constructor(e,r){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(r=e,e=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,la(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new ii({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=e;const i=r.parser||Ey;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var r;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(r=this.backoff)===null||r===void 0||r.setMin(e),this)}randomizationFactor(e){var r;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(r=this.backoff)===null||r===void 0||r.setJitter(e),this)}reconnectionDelayMax(e){var r;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(r=this.backoff)===null||r===void 0||r.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Om(this.uri,this.opts);const r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const i=yt(r,"open",function(){n.onopen(),e&&e()}),s=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),e?e(a):this.maybeReconnectOnOpen()},o=yt(r,"error",s);if(this._timeout!==!1){const a=this._timeout,c=this.setTimeoutFn(()=>{i(),s(new Error("timeout")),r.close()},a);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(i),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(yt(e,"ping",this.onping.bind(this)),yt(e,"data",this.ondata.bind(this)),yt(e,"error",this.onerror.bind(this)),yt(e,"close",this.onclose.bind(this)),yt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(r){this.onclose("parse error",r)}}ondecoded(e){bd(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,r){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new Nm(this,e,r),this.nsps[e]=n),n}_destroy(e){const r=Object.keys(this.nsps);for(const n of r)if(this.nsps[n].active)return;this._close()}_packet(e){const r=this.encoder.encode(e);for(let n=0;n<r.length;n++)this.engine.write(r[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,r){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Si={};function So(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const r=gy(t,e.path||"/socket.io"),n=r.source,i=r.id,s=r.path,o=Si[i]&&s in Si[i].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o;let c;return a?c=new wl(n,e):(Si[i]||(Si[i]=new wl(n,e)),c=Si[i]),r.query&&!e.query&&(e.query=r.queryKey),c.socket(r.path,e)}Object.assign(So,{Manager:wl,Socket:Nm,io:So,connect:So});const $e=So("http://localhost:3000/mediasoup");var jm={},Sl={exports:{}},cc,gp;function ky(){if(gp)return cc;gp=1;var t=1e3,e=t*60,r=e*60,n=r*24,i=n*7,s=n*365.25;cc=function(d,p){p=p||{};var u=typeof d;if(u==="string"&&d.length>0)return o(d);if(u==="number"&&isFinite(d))return p.long?c(d):a(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))};function o(d){if(d=String(d),!(d.length>100)){var p=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(p){var u=parseFloat(p[1]),f=(p[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return u*s;case"weeks":case"week":case"w":return u*i;case"days":case"day":case"d":return u*n;case"hours":case"hour":case"hrs":case"hr":case"h":return u*r;case"minutes":case"minute":case"mins":case"min":case"m":return u*e;case"seconds":case"second":case"secs":case"sec":case"s":return u*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return u;default:return}}}}function a(d){var p=Math.abs(d);return p>=n?Math.round(d/n)+"d":p>=r?Math.round(d/r)+"h":p>=e?Math.round(d/e)+"m":p>=t?Math.round(d/t)+"s":d+"ms"}function c(d){var p=Math.abs(d);return p>=n?l(d,p,n,"day"):p>=r?l(d,p,r,"hour"):p>=e?l(d,p,e,"minute"):p>=t?l(d,p,t,"second"):d+" ms"}function l(d,p,u,f){var h=p>=u*1.5;return Math.round(d/u)+" "+f+(h?"s":"")}return cc}function xy(t){r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=i,r.enabled=o,r.humanize=ky(),r.destroy=l,Object.keys(t).forEach(d=>{r[d]=t[d]}),r.names=[],r.skips=[],r.formatters={};function e(d){let p=0;for(let u=0;u<d.length;u++)p=(p<<5)-p+d.charCodeAt(u),p|=0;return r.colors[Math.abs(p)%r.colors.length]}r.selectColor=e;function r(d){let p,u=null,f,h;function m(...y){if(!m.enabled)return;const g=m,v=Number(new Date),_=v-(p||v);g.diff=_,g.prev=p,g.curr=v,p=v,y[0]=r.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let w=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(C,E)=>{if(C==="%%")return"%";w++;const P=r.formatters[E];if(typeof P=="function"){const Y=y[w];C=P.call(g,Y),y.splice(w,1),w--}return C}),r.formatArgs.call(g,y),(g.log||r.log).apply(g,y)}return m.namespace=d,m.useColors=r.useColors(),m.color=r.selectColor(d),m.extend=n,m.destroy=r.destroy,Object.defineProperty(m,"enabled",{enumerable:!0,configurable:!1,get:()=>u!==null?u:(f!==r.namespaces&&(f=r.namespaces,h=r.enabled(d)),h),set:y=>{u=y}}),typeof r.init=="function"&&r.init(m),m}function n(d,p){const u=r(this.namespace+(typeof p>"u"?":":p)+d);return u.log=this.log,u}function i(d){r.save(d),r.namespaces=d,r.names=[],r.skips=[];let p;const u=(typeof d=="string"?d:"").split(/[\s,]+/),f=u.length;for(p=0;p<f;p++)u[p]&&(d=u[p].replace(/\*/g,".*?"),d[0]==="-"?r.skips.push(new RegExp("^"+d.slice(1)+"$")):r.names.push(new RegExp("^"+d+"$")))}function s(){const d=[...r.names.map(a),...r.skips.map(a).map(p=>"-"+p)].join(",");return r.enable(""),d}function o(d){if(d[d.length-1]==="*")return!0;let p,u;for(p=0,u=r.skips.length;p<u;p++)if(r.skips[p].test(d))return!1;for(p=0,u=r.names.length;p<u;p++)if(r.names[p].test(d))return!0;return!1}function a(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function c(d){return d instanceof Error?d.stack||d.message:d}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}var Ly=xy;(function(t,e){var r={};e.formatArgs=i,e.save=s,e.load=o,e.useColors=n,e.storage=a(),e.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function i(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const d="color: "+this.color;l.splice(1,0,d,"color: inherit");let p=0,u=0;l[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(p++,f==="%c"&&(u=p))}),l.splice(u,0,d)}e.log=console.debug||console.log||(()=>{});function s(l){try{l?e.storage.setItem("debug",l):e.storage.removeItem("debug")}catch{}}function o(){let l;try{l=e.storage.getItem("debug")}catch{}return!l&&typeof process<"u"&&"env"in process&&(l=r.DEBUG),l}function a(){try{return localStorage}catch{}}t.exports=Ly(e);const{formatters:c}=t.exports;c.j=function(l){try{return JSON.stringify(l)}catch(d){return"[UnexpectedJSONParseError]: "+d.message}}})(Sl,Sl.exports);var da=Sl.exports,si={},Rl={exports:{}};(function(t,e){(function(r,n){var i="1.0.38",s="",o="?",a="function",c="undefined",l="object",d="string",p="major",u="model",f="name",h="type",m="vendor",y="version",g="architecture",v="console",_="mobile",w="tablet",b="smarttv",C="wearable",E="embedded",P=500,Y="Amazon",A="Apple",_e="ASUS",Ie="BlackBerry",Je="Browser",Fr="Chrome",xa="Edge",ar="Firefox",cr="Google",T="Huawei",N="LG",F="Microsoft",ce="Motorola",le="Opera",Wt="Samsung",Ct="Sharp",lr="Sony",ht="Xiaomi",dr="Zebra",Hd="Facebook",Kd="Chromium OS",Wd="Mac OS",ug=function(H,Z){var B={};for(var ie in H)Z[ie]&&Z[ie].length%2===0?B[ie]=Z[ie].concat(H[ie]):B[ie]=H[ie];return B},Cs=function(H){for(var Z={},B=0;B<H.length;B++)Z[H[B].toUpperCase()]=H[B];return Z},Qd=function(H,Z){return typeof H===d?ui(Z).indexOf(ui(H))!==-1:!1},ui=function(H){return H.toLowerCase()},pg=function(H){return typeof H===d?H.replace(/[^\d\.]/g,s).split(".")[0]:n},La=function(H,Z){if(typeof H===d)return H=H.replace(/^\s\s*/,s),typeof Z===c?H:H.substring(0,P)},pi=function(H,Z){for(var B=0,ie,Qt,Tt,X,j,Dt;B<Z.length&&!j;){var Oa=Z[B],Yd=Z[B+1];for(ie=Qt=0;ie<Oa.length&&!j&&Oa[ie];)if(j=Oa[ie++].exec(H),j)for(Tt=0;Tt<Yd.length;Tt++)Dt=j[++Qt],X=Yd[Tt],typeof X===l&&X.length>0?X.length===2?typeof X[1]==a?this[X[0]]=X[1].call(this,Dt):this[X[0]]=X[1]:X.length===3?typeof X[1]===a&&!(X[1].exec&&X[1].test)?this[X[0]]=Dt?X[1].call(this,Dt,X[2]):n:this[X[0]]=Dt?Dt.replace(X[1],X[2]):n:X.length===4&&(this[X[0]]=Dt?X[3].call(this,Dt.replace(X[1],X[2])):n):this[X]=Dt||n;B+=2}},Ma=function(H,Z){for(var B in Z)if(typeof Z[B]===l&&Z[B].length>0){for(var ie=0;ie<Z[B].length;ie++)if(Qd(Z[B][ie],H))return B===o?n:B}else if(Qd(Z[B],H))return B===o?n:B;return H},fg={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},qd={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Gd={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[y,[f,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[y,[f,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[f,y],[/opios[\/ ]+([\w\.]+)/i],[y,[f,le+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[y,[f,le+" GX"]],[/\bopr\/([\w\.]+)/i],[y,[f,le]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[y,[f,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[f,y],[/\bddg\/([\w\.]+)/i],[y,[f,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[y,[f,"UC"+Je]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[y,[f,"WeChat"]],[/konqueror\/([\w\.]+)/i],[y,[f,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[y,[f,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[y,[f,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[y,[f,"Smart Lenovo "+Je]],[/(avast|avg)\/([\w\.]+)/i],[[f,/(.+)/,"$1 Secure "+Je],y],[/\bfocus\/([\w\.]+)/i],[y,[f,ar+" Focus"]],[/\bopt\/([\w\.]+)/i],[y,[f,le+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[y,[f,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[y,[f,"Dolphin"]],[/coast\/([\w\.]+)/i],[y,[f,le+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[y,[f,"MIUI "+Je]],[/fxios\/([-\w\.]+)/i],[y,[f,ar]],[/\bqihu|(qi?ho?o?|360)browser/i],[[f,"360 "+Je]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[f,/(.+)/,"$1 "+Je],y],[/samsungbrowser\/([\w\.]+)/i],[y,[f,Wt+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[f,/_/g," "],y],[/metasr[\/ ]?([\d\.]+)/i],[y,[f,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[f,"Sogou Mobile"],y],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[f,y],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[f],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[f,Hd],y],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[f,y],[/\bgsa\/([\w\.]+) .*safari\//i],[y,[f,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[y,[f,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[y,[f,Fr+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[f,Fr+" WebView"],y],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[y,[f,"Android "+Je]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[f,y],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[y,[f,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[y,f],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[f,[y,Ma,fg]],[/(webkit|khtml)\/([\w\.]+)/i],[f,y],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[f,"Netscape"],y],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[y,[f,ar+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[f,y],[/(cobalt)\/([\w\.]+)/i],[f,[y,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[g,"amd64"]],[/(ia32(?=;))/i],[[g,ui]],[/((?:i[346]|x)86)[;\)]/i],[[g,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[g,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[g,"armhf"]],[/windows (ce|mobile); ppc;/i],[[g,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[g,/ower/,s,ui]],[/(sun4\w)[;\)]/i],[[g,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[g,ui]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[u,[m,Wt],[h,w]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[u,[m,Wt],[h,_]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[u,[m,A],[h,_]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[u,[m,A],[h,w]],[/(macintosh);/i],[u,[m,A]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[u,[m,Ct],[h,_]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[u,[m,T],[h,w]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[u,[m,T],[h,_]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[u,/_/g," "],[m,ht],[h,_]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[u,/_/g," "],[m,ht],[h,w]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[u,[m,"OPPO"],[h,_]],[/\b(opd2\d{3}a?) bui/i],[u,[m,"OPPO"],[h,w]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[u,[m,"Vivo"],[h,_]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[u,[m,"Realme"],[h,_]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[u,[m,ce],[h,_]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[u,[m,ce],[h,w]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[u,[m,N],[h,w]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[u,[m,N],[h,_]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[u,[m,"Lenovo"],[h,w]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[u,/_/g," "],[m,"Nokia"],[h,_]],[/(pixel c)\b/i],[u,[m,cr],[h,w]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[u,[m,cr],[h,_]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[u,[m,lr],[h,_]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[u,"Xperia Tablet"],[m,lr],[h,w]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[u,[m,"OnePlus"],[h,_]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[u,[m,Y],[h,w]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[u,/(.+)/g,"Fire Phone $1"],[m,Y],[h,_]],[/(playbook);[-\w\),; ]+(rim)/i],[u,m,[h,w]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[u,[m,Ie],[h,_]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[u,[m,_e],[h,w]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[u,[m,_e],[h,_]],[/(nexus 9)/i],[u,[m,"HTC"],[h,w]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[m,[u,/_/g," "],[h,_]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[u,[m,"Acer"],[h,w]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[u,[m,"Meizu"],[h,_]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[u,[m,"Ulefone"],[h,_]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[m,u,[h,_]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[m,u,[h,w]],[/(surface duo)/i],[u,[m,F],[h,w]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[u,[m,"Fairphone"],[h,_]],[/(u304aa)/i],[u,[m,"AT&T"],[h,_]],[/\bsie-(\w*)/i],[u,[m,"Siemens"],[h,_]],[/\b(rct\w+) b/i],[u,[m,"RCA"],[h,w]],[/\b(venue[\d ]{2,7}) b/i],[u,[m,"Dell"],[h,w]],[/\b(q(?:mv|ta)\w+) b/i],[u,[m,"Verizon"],[h,w]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[u,[m,"Barnes & Noble"],[h,w]],[/\b(tm\d{3}\w+) b/i],[u,[m,"NuVision"],[h,w]],[/\b(k88) b/i],[u,[m,"ZTE"],[h,w]],[/\b(nx\d{3}j) b/i],[u,[m,"ZTE"],[h,_]],[/\b(gen\d{3}) b.+49h/i],[u,[m,"Swiss"],[h,_]],[/\b(zur\d{3}) b/i],[u,[m,"Swiss"],[h,w]],[/\b((zeki)?tb.*\b) b/i],[u,[m,"Zeki"],[h,w]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[m,"Dragon Touch"],u,[h,w]],[/\b(ns-?\w{0,9}) b/i],[u,[m,"Insignia"],[h,w]],[/\b((nxa|next)-?\w{0,9}) b/i],[u,[m,"NextBook"],[h,w]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[m,"Voice"],u,[h,_]],[/\b(lvtel\-)?(v1[12]) b/i],[[m,"LvTel"],u,[h,_]],[/\b(ph-1) /i],[u,[m,"Essential"],[h,_]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[u,[m,"Envizen"],[h,w]],[/\b(trio[-\w\. ]+) b/i],[u,[m,"MachSpeed"],[h,w]],[/\btu_(1491) b/i],[u,[m,"Rotor"],[h,w]],[/(shield[\w ]+) b/i],[u,[m,"Nvidia"],[h,w]],[/(sprint) (\w+)/i],[m,u,[h,_]],[/(kin\.[onetw]{3})/i],[[u,/\./g," "],[m,F],[h,_]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[u,[m,dr],[h,w]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[u,[m,dr],[h,_]],[/smart-tv.+(samsung)/i],[m,[h,b]],[/hbbtv.+maple;(\d+)/i],[[u,/^/,"SmartTV"],[m,Wt],[h,b]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[m,N],[h,b]],[/(apple) ?tv/i],[m,[u,A+" TV"],[h,b]],[/crkey/i],[[u,Fr+"cast"],[m,cr],[h,b]],[/droid.+aft(\w+)( bui|\))/i],[u,[m,Y],[h,b]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[u,[m,Ct],[h,b]],[/(bravia[\w ]+)( bui|\))/i],[u,[m,lr],[h,b]],[/(mitv-\w{5}) bui/i],[u,[m,ht],[h,b]],[/Hbbtv.*(technisat) (.*);/i],[m,u,[h,b]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[m,La],[u,La],[h,b]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[h,b]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[m,u,[h,v]],[/droid.+; (shield) bui/i],[u,[m,"Nvidia"],[h,v]],[/(playstation [345portablevi]+)/i],[u,[m,lr],[h,v]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[u,[m,F],[h,v]],[/((pebble))app/i],[m,u,[h,C]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[u,[m,A],[h,C]],[/droid.+; (glass) \d/i],[u,[m,cr],[h,C]],[/droid.+; (wt63?0{2,3})\)/i],[u,[m,dr],[h,C]],[/(quest( \d| pro)?)/i],[u,[m,Hd],[h,C]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[m,[h,E]],[/(aeobc)\b/i],[u,[m,Y],[h,E]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[u,[h,_]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[u,[h,w]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[h,w]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[h,_]],[/(android[-\w\. ]{0,9});.+buil/i],[u,[m,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[y,[f,xa+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[y,[f,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[f,y],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[y,f]],os:[[/microsoft (windows) (vista|xp)/i],[f,y],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[f,[y,Ma,qd]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[y,Ma,qd],[f,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[y,/_/g,"."],[f,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[f,Wd],[y,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[y,f],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[f,y],[/\(bb(10);/i],[y,[f,Ie]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[y,[f,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[y,[f,ar+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[y,[f,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[y,[f,"watchOS"]],[/crkey\/([\d\.]+)/i],[y,[f,Fr+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[f,Kd],y],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[f,y],[/(sunos) ?([\w\.\d]*)/i],[[f,"Solaris"],y],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[f,y]]},mt=function(H,Z){if(typeof H===l&&(Z=H,H=n),!(this instanceof mt))return new mt(H,Z).getResult();var B=typeof r!==c&&r.navigator?r.navigator:n,ie=H||(B&&B.userAgent?B.userAgent:s),Qt=B&&B.userAgentData?B.userAgentData:n,Tt=Z?ug(Gd,Z):Gd,X=B&&B.userAgent==ie;return this.getBrowser=function(){var j={};return j[f]=n,j[y]=n,pi.call(j,ie,Tt.browser),j[p]=pg(j[y]),X&&B&&B.brave&&typeof B.brave.isBrave==a&&(j[f]="Brave"),j},this.getCPU=function(){var j={};return j[g]=n,pi.call(j,ie,Tt.cpu),j},this.getDevice=function(){var j={};return j[m]=n,j[u]=n,j[h]=n,pi.call(j,ie,Tt.device),X&&!j[h]&&Qt&&Qt.mobile&&(j[h]=_),X&&j[u]=="Macintosh"&&B&&typeof B.standalone!==c&&B.maxTouchPoints&&B.maxTouchPoints>2&&(j[u]="iPad",j[h]=w),j},this.getEngine=function(){var j={};return j[f]=n,j[y]=n,pi.call(j,ie,Tt.engine),j},this.getOS=function(){var j={};return j[f]=n,j[y]=n,pi.call(j,ie,Tt.os),X&&!j[f]&&Qt&&Qt.platform&&Qt.platform!="Unknown"&&(j[f]=Qt.platform.replace(/chrome os/i,Kd).replace(/macos/i,Wd)),j},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return ie},this.setUA=function(j){return ie=typeof j===d&&j.length>P?La(j,P):j,this},this.setUA(ie),this};mt.VERSION=i,mt.BROWSER=Cs([f,y,p]),mt.CPU=Cs([g]),mt.DEVICE=Cs([u,m,h,v,_,b,w,C,E]),mt.ENGINE=mt.OS=Cs([f,y]),t.exports&&(e=t.exports=mt),e.UAParser=mt;var nn=typeof r!==c&&(r.jQuery||r.Zepto);if(nn&&!nn.ua){var Ts=new mt;nn.ua=Ts.getResult(),nn.ua.get=function(){return Ts.getUA()},nn.ua.set=function(H){Ts.setUA(H);var Z=Ts.getResult();for(var B in Z)nn.ua[B]=Z[B]}}})(typeof window=="object"?window:S)})(Rl,Rl.exports);var My=Rl.exports,he={},Oy=S&&S.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(he,"__esModule",{value:!0});he.Logger=void 0;const on=Oy(da),an="mediasoup-client";let Iy=class{constructor(e){e?(this._debug=(0,on.default)(`${an}:${e}`),this._warn=(0,on.default)(`${an}:WARN:${e}`),this._error=(0,on.default)(`${an}:ERROR:${e}`)):(this._debug=(0,on.default)(an),this._warn=(0,on.default)(`${an}:WARN`),this._error=(0,on.default)(`${an}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};he.Logger=Iy;var Vt={},Dd={exports:{}},Hn=typeof Reflect=="object"?Reflect:null,vp=Hn&&typeof Hn.apply=="function"?Hn.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},Ro;Hn&&typeof Hn.ownKeys=="function"?Ro=Hn.ownKeys:Object.getOwnPropertySymbols?Ro=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Ro=function(e){return Object.getOwnPropertyNames(e)};function Ny(t){console&&console.warn&&console.warn(t)}var Am=Number.isNaN||function(e){return e!==e};function te(){te.init.call(this)}Dd.exports=te;Dd.exports.once=Fy;te.EventEmitter=te;te.prototype._events=void 0;te.prototype._eventsCount=0;te.prototype._maxListeners=void 0;var _p=10;function ua(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(te,"defaultMaxListeners",{enumerable:!0,get:function(){return _p},set:function(t){if(typeof t!="number"||t<0||Am(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");_p=t}});te.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};te.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Am(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function $m(t){return t._maxListeners===void 0?te.defaultMaxListeners:t._maxListeners}te.prototype.getMaxListeners=function(){return $m(this)};te.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")vp(c,this,r);else for(var l=c.length,d=Vm(c,l),n=0;n<l;++n)vp(d[n],this,r);return!0};function Fm(t,e,r,n){var i,s,o;if(ua(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=$m(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,Ny(a)}return t}te.prototype.addListener=function(e,r){return Fm(this,e,r,!1)};te.prototype.on=te.prototype.addListener;te.prototype.prependListener=function(e,r){return Fm(this,e,r,!0)};function jy(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Bm(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=jy.bind(n);return i.listener=r,n.wrapFn=i,i}te.prototype.once=function(e,r){return ua(r),this.on(e,Bm(this,e,r)),this};te.prototype.prependOnceListener=function(e,r){return ua(r),this.prependListener(e,Bm(this,e,r)),this};te.prototype.removeListener=function(e,r){var n,i,s,o,a;if(ua(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():Ay(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};te.prototype.off=te.prototype.removeListener;te.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function zm(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?$y(i):Vm(i,i.length)}te.prototype.listeners=function(e){return zm(this,e,!0)};te.prototype.rawListeners=function(e){return zm(this,e,!1)};te.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Um.call(t,e)};te.prototype.listenerCount=Um;function Um(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}te.prototype.eventNames=function(){return this._eventsCount>0?Ro(this._events):[]};function Vm(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function Ay(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function $y(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Fy(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}Hm(t,e,s,{once:!0}),e!=="error"&&By(t,i,{once:!0})})}function By(t,e,r){typeof t.on=="function"&&Hm(t,"error",e,r)}function Hm(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var zy=Dd.exports;Object.defineProperty(Vt,"__esModule",{value:!0});Vt.EnhancedEventEmitter=void 0;const Uy=zy,Vy=he,Hy=new Vy.Logger("EnhancedEventEmitter");class Ky extends Uy.EventEmitter{constructor(){super(),this.setMaxListeners(1/0)}emit(e,...r){return super.emit(e,...r)}safeEmit(e,...r){try{return super.emit(e,...r)}catch(n){Hy.error("safeEmit() | event listener threw an error [eventName:%s]:%o",e,n);try{super.emit("listenererror",e,n)}catch{}return!!super.listenerCount(e)}}on(e,r){return super.on(e,r),this}off(e,r){return super.off(e,r),this}addListener(e,r){return super.on(e,r),this}prependListener(e,r){return super.prependListener(e,r),this}once(e,r){return super.once(e,r),this}prependOnceListener(e,r){return super.prependOnceListener(e,r),this}removeListener(e,r){return super.off(e,r),this}removeAllListeners(e){return super.removeAllListeners(e),this}listenerCount(e){return super.listenerCount(e)}listeners(e){return super.listeners(e)}rawListeners(e){return super.rawListeners(e)}}Vt.EnhancedEventEmitter=Ky;var Ce={};Object.defineProperty(Ce,"__esModule",{value:!0});Ce.InvalidStateError=Ce.UnsupportedError=void 0;class Ed extends Error{constructor(e){super(e),this.name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,Ed):this.stack=new Error(e).stack}}Ce.UnsupportedError=Ed;class Pd extends Error{constructor(e){super(e),this.name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace(this,Pd):this.stack=new Error(e).stack}}Ce.InvalidStateError=Pd;var we={};Object.defineProperty(we,"__esModule",{value:!0});we.clone=Wy;we.generateRandomNumber=Qy;we.deepFreeze=Km;function Wy(t){if(t!==void 0)return Number.isNaN(t)?NaN:typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}function Qy(){return Math.round(Math.random()*1e7)}function Km(t){const e=Reflect.ownKeys(t);for(const r of e){const n=t[r];(n&&typeof n=="object"||typeof n=="function")&&Km(n)}return Object.freeze(t)}var ne={},me={},pa={},qy=S&&S.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(pa,"__esModule",{value:!0});pa.Logger=void 0;const cn=qy(da),ln="h264-profile-level-id";let Gy=class{constructor(e){e?(this._debug=(0,cn.default)(`${ln}:${e}`),this._warn=(0,cn.default)(`${ln}:WARN:${e}`),this._error=(0,cn.default)(`${ln}:ERROR:${e}`)):(this._debug=(0,cn.default)(ln),this._warn=(0,cn.default)(`${ln}:WARN`),this._error=(0,cn.default)(`${ln}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}};pa.Logger=Gy;Object.defineProperty(me,"__esModule",{value:!0});me.generateProfileLevelIdStringForAnswer=me.isSameProfile=me.parseSdpProfileLevelId=me.levelToString=me.profileToString=me.profileLevelIdToString=me.parseProfileLevelId=me.ProfileLevelId=me.Level=me.Profile=void 0;const Yy=pa,Nr=new Yy.Logger;var re;(function(t){t[t.ConstrainedBaseline=1]="ConstrainedBaseline",t[t.Baseline=2]="Baseline",t[t.Main=3]="Main",t[t.ConstrainedHigh=4]="ConstrainedHigh",t[t.High=5]="High",t[t.PredictiveHigh444=6]="PredictiveHigh444"})(re||(me.Profile=re={}));var $;(function(t){t[t.L1_b=0]="L1_b",t[t.L1=10]="L1",t[t.L1_1=11]="L1_1",t[t.L1_2=12]="L1_2",t[t.L1_3=13]="L1_3",t[t.L2=20]="L2",t[t.L2_1=21]="L2_1",t[t.L2_2=22]="L2_2",t[t.L3=30]="L3",t[t.L3_1=31]="L3_1",t[t.L3_2=32]="L3_2",t[t.L4=40]="L4",t[t.L4_1=41]="L4_1",t[t.L4_2=42]="L4_2",t[t.L5=50]="L5",t[t.L5_1=51]="L5_1",t[t.L5_2=52]="L5_2"})($||(me.Level=$={}));class fa{constructor(e,r){this.profile=e,this.level=r}}me.ProfileLevelId=fa;const Xy=new fa(re.ConstrainedBaseline,$.L3_1);class qt{constructor(e){this.mask=~yp("x",e),this.masked_value=yp("1",e)}isMatch(e){return this.masked_value===(e&this.mask)}}class Gt{constructor(e,r,n){this.profile_idc=e,this.profile_iop=r,this.profile=n}}const Jy=[new Gt(66,new qt("x1xx0000"),re.ConstrainedBaseline),new Gt(77,new qt("1xxx0000"),re.ConstrainedBaseline),new Gt(88,new qt("11xx0000"),re.ConstrainedBaseline),new Gt(66,new qt("x0xx0000"),re.Baseline),new Gt(88,new qt("10xx0000"),re.Baseline),new Gt(77,new qt("0x0x0000"),re.Main),new Gt(100,new qt("00000000"),re.High),new Gt(100,new qt("00001100"),re.ConstrainedHigh),new Gt(244,new qt("00000000"),re.PredictiveHigh444)];function Wm(t){if(typeof t!="string"||t.length!==6)return;const r=parseInt(t,16);if(r===0)return;const n=r&255,i=r>>8&255,s=r>>16&255;let o;switch(n){case $.L1_1:{o=i&16?$.L1_b:$.L1_1;break}case $.L1:case $.L1_2:case $.L1_3:case $.L2:case $.L2_1:case $.L2_2:case $.L3:case $.L3_1:case $.L3_2:case $.L4:case $.L4_1:case $.L4_2:case $.L5:case $.L5_1:case $.L5_2:{o=n;break}default:{Nr.warn(`parseProfileLevelId() | unrecognized level_idc [str:${t}, level_idc:${n}]`);return}}for(const a of Jy)if(s===a.profile_idc&&a.profile_iop.isMatch(i))return new fa(a.profile,o);Nr.warn(`parseProfileLevelId() | unrecognized profile_idc/profile_iop combination [str:${t}, profile_idc:${s}, profile_iop:${i}]`)}me.parseProfileLevelId=Wm;function Qm(t){if(t.level==$.L1_b)switch(t.profile){case re.ConstrainedBaseline:return"42f00b";case re.Baseline:return"42100b";case re.Main:return"4d100b";default:{Nr.warn(`profileLevelIdToString() | Level 1_b not is allowed for profile ${t.profile}`);return}}let e;switch(t.profile){case re.ConstrainedBaseline:{e="42e0";break}case re.Baseline:{e="4200";break}case re.Main:{e="4d00";break}case re.ConstrainedHigh:{e="640c";break}case re.High:{e="6400";break}case re.PredictiveHigh444:{e="f400";break}default:{Nr.warn(`profileLevelIdToString() | unrecognized profile ${t.profile}`);return}}let r=t.level.toString(16);return r.length===1&&(r=`0${r}`),`${e}${r}`}me.profileLevelIdToString=Qm;function Zy(t){switch(t){case re.ConstrainedBaseline:return"ConstrainedBaseline";case re.Baseline:return"Baseline";case re.Main:return"Main";case re.ConstrainedHigh:return"ConstrainedHigh";case re.High:return"High";case re.PredictiveHigh444:return"PredictiveHigh444";default:{Nr.warn(`profileToString() | unrecognized profile ${t}`);return}}}me.profileToString=Zy;function ew(t){switch(t){case $.L1_b:return"1b";case $.L1:return"1";case $.L1_1:return"1.1";case $.L1_2:return"1.2";case $.L1_3:return"1.3";case $.L2:return"2";case $.L2_1:return"2.1";case $.L2_2:return"2.2";case $.L3:return"3";case $.L3_1:return"3.1";case $.L3_2:return"3.2";case $.L4:return"4";case $.L4_1:return"4.1";case $.L4_2:return"4.2";case $.L5:return"5";case $.L5_1:return"5.1";case $.L5_2:return"5.2";default:{Nr.warn(`levelToString() | unrecognized level ${t}`);return}}}me.levelToString=ew;function os(t={}){const e=t["profile-level-id"];return e?Wm(e):Xy}me.parseSdpProfileLevelId=os;function tw(t={},e={}){const r=os(t),n=os(e);return!!(r&&n&&r.profile===n.profile)}me.isSameProfile=tw;function rw(t={},e={}){if(!t["profile-level-id"]&&!e["profile-level-id"]){Nr.warn("generateProfileLevelIdStringForAnswer() | profile-level-id missing in local and remote params");return}const r=os(t),n=os(e);if(!r)throw new TypeError("invalid local_profile_level_id");if(!n)throw new TypeError("invalid remote_profile_level_id");if(r.profile!==n.profile)throw new TypeError("H264 Profile mismatch");const i=wp(t)&&wp(e),s=r.level,o=n.level,a=iw(s,o),c=i?s:a;return Nr.debug(`generateProfileLevelIdStringForAnswer() | result [profile:${r.profile}, level:${c}]`),Qm(new fa(r.profile,c))}me.generateProfileLevelIdStringForAnswer=rw;function yp(t,e){return+(e[0]===t)<<7|+(e[1]===t)<<6|+(e[2]===t)<<5|+(e[3]===t)<<4|+(e[4]===t)<<3|+(e[5]===t)<<2|+(e[6]===t)<<1|+(e[7]===t)<<0}function nw(t,e){return t===$.L1_b?e!==$.L1&&e!==$.L1_b:e===$.L1_b?t!==$.L1:t<e}function iw(t,e){return nw(t,e)?t:e}function wp(t={}){const e=t["level-asymmetry-allowed"];return e===!0||e===1||e==="1"}var sw=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ow=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),qm=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&sw(e,t,r);return ow(e,t),e};Object.defineProperty(ne,"__esModule",{value:!0});ne.validateRtpCapabilities=uw;ne.validateRtpParameters=kd;ne.validateSctpStreamParameters=pw;ne.validateSctpCapabilities=fw;ne.getExtendedRtpCapabilities=hw;ne.getRecvRtpCapabilities=mw;ne.getSendingRtpParameters=gw;ne.getSendingRemoteRtpParameters=vw;ne.reduceCodecs=_w;ne.generateProbatorRtpParameters=yw;ne.canSend=ww;ne.canReceive=Sw;const Sp=qm(me),aw=qm(we),cw="probator",lw=1234,dw=127;function uw(t){if(typeof t!="object")throw new TypeError("caps is not an object");if(t.codecs&&!Array.isArray(t.codecs))throw new TypeError("caps.codecs is not an array");t.codecs||(t.codecs=[]);for(const e of t.codecs)Rw(e);if(t.headerExtensions&&!Array.isArray(t.headerExtensions))throw new TypeError("caps.headerExtensions is not an array");t.headerExtensions||(t.headerExtensions=[]);for(const e of t.headerExtensions)bw(e)}function kd(t){if(typeof t!="object")throw new TypeError("params is not an object");if(t.mid&&typeof t.mid!="string")throw new TypeError("params.mid is not a string");if(!Array.isArray(t.codecs))throw new TypeError("missing params.codecs");for(const e of t.codecs)Cw(e);if(t.headerExtensions&&!Array.isArray(t.headerExtensions))throw new TypeError("params.headerExtensions is not an array");t.headerExtensions||(t.headerExtensions=[]);for(const e of t.headerExtensions)Tw(e);if(t.encodings&&!Array.isArray(t.encodings))throw new TypeError("params.encodings is not an array");t.encodings||(t.encodings=[]);for(const e of t.encodings)Dw(e);if(t.rtcp&&typeof t.rtcp!="object")throw new TypeError("params.rtcp is not an object");t.rtcp||(t.rtcp={}),Ew(t.rtcp)}function pw(t){if(typeof t!="object")throw new TypeError("params is not an object");if(typeof t.streamId!="number")throw new TypeError("missing params.streamId");let e=!1;if(typeof t.ordered=="boolean"?e=!0:t.ordered=!0,t.maxPacketLifeTime&&typeof t.maxPacketLifeTime!="number")throw new TypeError("invalid params.maxPacketLifeTime");if(t.maxRetransmits&&typeof t.maxRetransmits!="number")throw new TypeError("invalid params.maxRetransmits");if(t.maxPacketLifeTime&&t.maxRetransmits)throw new TypeError("cannot provide both maxPacketLifeTime and maxRetransmits");if(e&&t.ordered&&(t.maxPacketLifeTime||t.maxRetransmits))throw new TypeError("cannot be ordered with maxPacketLifeTime or maxRetransmits");if(!e&&(t.maxPacketLifeTime||t.maxRetransmits)&&(t.ordered=!1),t.label&&typeof t.label!="string")throw new TypeError("invalid params.label");if(t.protocol&&typeof t.protocol!="string")throw new TypeError("invalid params.protocol")}function fw(t){if(typeof t!="object")throw new TypeError("caps is not an object");if(!t.numStreams||typeof t.numStreams!="object")throw new TypeError("missing caps.numStreams");Pw(t.numStreams)}function hw(t,e){const r={codecs:[],headerExtensions:[]};for(const n of e.codecs??[]){if(Bi(n))continue;const i=(t.codecs??[]).find(o=>Ym(o,n,{strict:!0,modify:!0}));if(!i)continue;const s={mimeType:i.mimeType,kind:i.kind,clockRate:i.clockRate,channels:i.channels,localPayloadType:i.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:n.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:i.parameters,remoteParameters:n.parameters,rtcpFeedback:xw(i,n)};r.codecs.push(s)}for(const n of r.codecs){const i=t.codecs.find(o=>Bi(o)&&o.parameters.apt===n.localPayloadType),s=e.codecs.find(o=>Bi(o)&&o.parameters.apt===n.remotePayloadType);i&&s&&(n.localRtxPayloadType=i.preferredPayloadType,n.remoteRtxPayloadType=s.preferredPayloadType)}for(const n of e.headerExtensions){const i=t.headerExtensions.find(o=>kw(o,n));if(!i)continue;const s={kind:n.kind,uri:n.uri,sendId:i.preferredId,recvId:n.preferredId,encrypt:i.preferredEncrypt,direction:"sendrecv"};switch(n.direction){case"sendrecv":{s.direction="sendrecv";break}case"recvonly":{s.direction="sendonly";break}case"sendonly":{s.direction="recvonly";break}case"inactive":{s.direction="inactive";break}}r.headerExtensions.push(s)}return r}function mw(t){const e={codecs:[],headerExtensions:[]};for(const r of t.codecs){const n={mimeType:r.mimeType,kind:r.kind,preferredPayloadType:r.remotePayloadType,clockRate:r.clockRate,channels:r.channels,parameters:r.localParameters,rtcpFeedback:r.rtcpFeedback};if(e.codecs.push(n),!r.remoteRtxPayloadType)continue;const i={mimeType:`${r.kind}/rtx`,kind:r.kind,preferredPayloadType:r.remoteRtxPayloadType,clockRate:r.clockRate,parameters:{apt:r.remotePayloadType},rtcpFeedback:[]};e.codecs.push(i)}for(const r of t.headerExtensions){if(r.direction!=="sendrecv"&&r.direction!=="recvonly")continue;const n={kind:r.kind,uri:r.uri,preferredId:r.recvId,preferredEncrypt:r.encrypt,direction:r.direction};e.headerExtensions.push(n)}return e}function gw(t,e){const r={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const n of e.codecs){if(n.kind!==t)continue;const i={mimeType:n.mimeType,payloadType:n.localPayloadType,clockRate:n.clockRate,channels:n.channels,parameters:n.localParameters,rtcpFeedback:n.rtcpFeedback};if(r.codecs.push(i),n.localRtxPayloadType){const s={mimeType:`${n.kind}/rtx`,payloadType:n.localRtxPayloadType,clockRate:n.clockRate,parameters:{apt:n.localPayloadType},rtcpFeedback:[]};r.codecs.push(s)}}for(const n of e.headerExtensions){if(n.kind&&n.kind!==t||n.direction!=="sendrecv"&&n.direction!=="sendonly")continue;const i={uri:n.uri,id:n.sendId,encrypt:n.encrypt,parameters:{}};r.headerExtensions.push(i)}return r}function vw(t,e){const r={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}};for(const n of e.codecs){if(n.kind!==t)continue;const i={mimeType:n.mimeType,payloadType:n.localPayloadType,clockRate:n.clockRate,channels:n.channels,parameters:n.remoteParameters,rtcpFeedback:n.rtcpFeedback};if(r.codecs.push(i),n.localRtxPayloadType){const s={mimeType:`${n.kind}/rtx`,payloadType:n.localRtxPayloadType,clockRate:n.clockRate,parameters:{apt:n.localPayloadType},rtcpFeedback:[]};r.codecs.push(s)}}for(const n of e.headerExtensions){if(n.kind&&n.kind!==t||n.direction!=="sendrecv"&&n.direction!=="sendonly")continue;const i={uri:n.uri,id:n.sendId,encrypt:n.encrypt,parameters:{}};r.headerExtensions.push(i)}if(r.headerExtensions.some(n=>n.uri==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"))for(const n of r.codecs)n.rtcpFeedback=(n.rtcpFeedback??[]).filter(i=>i.type!=="goog-remb");else if(r.headerExtensions.some(n=>n.uri==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"))for(const n of r.codecs)n.rtcpFeedback=(n.rtcpFeedback??[]).filter(i=>i.type!=="transport-cc");else for(const n of r.codecs)n.rtcpFeedback=(n.rtcpFeedback??[]).filter(i=>i.type!=="transport-cc"&&i.type!=="goog-remb");return r}function _w(t,e){const r=[];if(!e)r.push(t[0]),Bi(t[1])&&r.push(t[1]);else{for(let n=0;n<t.length;++n)if(Ym(t[n],e,{strict:!0})){r.push(t[n]),Bi(t[n+1])&&r.push(t[n+1]);break}if(r.length===0)throw new TypeError("no matching codec found")}return r}function yw(t){t=aw.clone(t),kd(t);const e={mid:cw,codecs:[],headerExtensions:[],encodings:[{ssrc:lw}],rtcp:{cname:"probator"}};return e.codecs.push(t.codecs[0]),e.codecs[0].payloadType=dw,e.headerExtensions=t.headerExtensions,e}function ww(t,e){return e.codecs.some(r=>r.kind===t)}function Sw(t,e){if(kd(t),t.codecs.length===0)return!1;const r=t.codecs[0];return e.codecs.some(n=>n.remotePayloadType===r.payloadType)}function Rw(t){const e=new RegExp("^(audio|video)/(.+)","i");if(typeof t!="object")throw new TypeError("codec is not an object");if(!t.mimeType||typeof t.mimeType!="string")throw new TypeError("missing codec.mimeType");const r=e.exec(t.mimeType);if(!r)throw new TypeError("invalid codec.mimeType");if(t.kind=r[1].toLowerCase(),t.preferredPayloadType&&typeof t.preferredPayloadType!="number")throw new TypeError("invalid codec.preferredPayloadType");if(typeof t.clockRate!="number")throw new TypeError("missing codec.clockRate");t.kind==="audio"?typeof t.channels!="number"&&(t.channels=1):delete t.channels,(!t.parameters||typeof t.parameters!="object")&&(t.parameters={});for(const n of Object.keys(t.parameters)){let i=t.parameters[n];if(i===void 0&&(t.parameters[n]="",i=""),typeof i!="string"&&typeof i!="number")throw new TypeError(`invalid codec parameter [key:${n}s, value:${i}]`);if(n==="apt"&&typeof i!="number")throw new TypeError("invalid codec apt parameter")}(!t.rtcpFeedback||!Array.isArray(t.rtcpFeedback))&&(t.rtcpFeedback=[]);for(const n of t.rtcpFeedback)Gm(n)}function Gm(t){if(typeof t!="object")throw new TypeError("fb is not an object");if(!t.type||typeof t.type!="string")throw new TypeError("missing fb.type");(!t.parameter||typeof t.parameter!="string")&&(t.parameter="")}function bw(t){if(typeof t!="object")throw new TypeError("ext is not an object");if(t.kind!=="audio"&&t.kind!=="video")throw new TypeError("invalid ext.kind");if(!t.uri||typeof t.uri!="string")throw new TypeError("missing ext.uri");if(typeof t.preferredId!="number")throw new TypeError("missing ext.preferredId");if(t.preferredEncrypt&&typeof t.preferredEncrypt!="boolean")throw new TypeError("invalid ext.preferredEncrypt");if(t.preferredEncrypt||(t.preferredEncrypt=!1),t.direction&&typeof t.direction!="string")throw new TypeError("invalid ext.direction");t.direction||(t.direction="sendrecv")}function Cw(t){const e=new RegExp("^(audio|video)/(.+)","i");if(typeof t!="object")throw new TypeError("codec is not an object");if(!t.mimeType||typeof t.mimeType!="string")throw new TypeError("missing codec.mimeType");const r=e.exec(t.mimeType);if(!r)throw new TypeError("invalid codec.mimeType");if(typeof t.payloadType!="number")throw new TypeError("missing codec.payloadType");if(typeof t.clockRate!="number")throw new TypeError("missing codec.clockRate");r[1].toLowerCase()==="audio"?typeof t.channels!="number"&&(t.channels=1):delete t.channels,(!t.parameters||typeof t.parameters!="object")&&(t.parameters={});for(const i of Object.keys(t.parameters)){let s=t.parameters[i];if(s===void 0&&(t.parameters[i]="",s=""),typeof s!="string"&&typeof s!="number")throw new TypeError(`invalid codec parameter [key:${i}s, value:${s}]`);if(i==="apt"&&typeof s!="number")throw new TypeError("invalid codec apt parameter")}(!t.rtcpFeedback||!Array.isArray(t.rtcpFeedback))&&(t.rtcpFeedback=[]);for(const i of t.rtcpFeedback)Gm(i)}function Tw(t){if(typeof t!="object")throw new TypeError("ext is not an object");if(!t.uri||typeof t.uri!="string")throw new TypeError("missing ext.uri");if(typeof t.id!="number")throw new TypeError("missing ext.id");if(t.encrypt&&typeof t.encrypt!="boolean")throw new TypeError("invalid ext.encrypt");t.encrypt||(t.encrypt=!1),(!t.parameters||typeof t.parameters!="object")&&(t.parameters={});for(const e of Object.keys(t.parameters)){let r=t.parameters[e];if(r===void 0&&(t.parameters[e]="",r=""),typeof r!="string"&&typeof r!="number")throw new TypeError("invalid header extension parameter")}}function Dw(t){if(typeof t!="object")throw new TypeError("encoding is not an object");if(t.ssrc&&typeof t.ssrc!="number")throw new TypeError("invalid encoding.ssrc");if(t.rid&&typeof t.rid!="string")throw new TypeError("invalid encoding.rid");if(t.rtx&&typeof t.rtx!="object")throw new TypeError("invalid encoding.rtx");if(t.rtx&&typeof t.rtx.ssrc!="number")throw new TypeError("missing encoding.rtx.ssrc");if((!t.dtx||typeof t.dtx!="boolean")&&(t.dtx=!1),t.scalabilityMode&&typeof t.scalabilityMode!="string")throw new TypeError("invalid encoding.scalabilityMode")}function Ew(t){if(typeof t!="object")throw new TypeError("rtcp is not an object");if(t.cname&&typeof t.cname!="string")throw new TypeError("invalid rtcp.cname");(!t.reducedSize||typeof t.reducedSize!="boolean")&&(t.reducedSize=!0)}function Pw(t){if(typeof t!="object")throw new TypeError("numStreams is not an object");if(typeof t.OS!="number")throw new TypeError("missing numStreams.OS");if(typeof t.MIS!="number")throw new TypeError("missing numStreams.MIS")}function Bi(t){return t?/.+\/rtx$/i.test(t.mimeType):!1}function Ym(t,e,{strict:r=!1,modify:n=!1}={}){const i=t.mimeType.toLowerCase(),s=e.mimeType.toLowerCase();if(i!==s||t.clockRate!==e.clockRate||t.channels!==e.channels)return!1;switch(i){case"video/h264":{if(r){const o=t.parameters["packetization-mode"]||0,a=e.parameters["packetization-mode"]||0;if(o!==a||!Sp.isSameProfile(t.parameters,e.parameters))return!1;let c;try{c=Sp.generateProfileLevelIdStringForAnswer(t.parameters,e.parameters)}catch{return!1}n&&(c?(t.parameters["profile-level-id"]=c,e.parameters["profile-level-id"]=c):(delete t.parameters["profile-level-id"],delete e.parameters["profile-level-id"]))}break}case"video/vp9":{if(r){const o=t.parameters["profile-id"]||0,a=e.parameters["profile-id"]||0;if(o!==a)return!1}break}}return!0}function kw(t,e){return!(t.kind&&e.kind&&t.kind!==e.kind||t.uri!==e.uri)}function xw(t,e){const r=[];for(const n of t.rtcpFeedback??[]){const i=(e.rtcpFeedback??[]).find(s=>s.type===n.type&&(s.parameter===n.parameter||!s.parameter&&!n.parameter));i&&r.push(i)}return r}var ps={},Lr={},ha={};Object.defineProperty(ha,"__esModule",{value:!0});ha.Logger=void 0;const dn=da,un="awaitqueue";class Lw{constructor(e){e?(this._debug=(0,dn.default)(`${un}:${e}`),this._warn=(0,dn.default)(`${un}:WARN:${e}`),this._error=(0,dn.default)(`${un}:ERROR:${e}`)):(this._debug=(0,dn.default)(un),this._warn=(0,dn.default)(`${un}:WARN`),this._error=(0,dn.default)(`${un}:ERROR`)),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}get debug(){return this._debug}get warn(){return this._warn}get error(){return this._error}}ha.Logger=Lw;Object.defineProperty(Lr,"__esModule",{value:!0});Lr.AwaitQueue=Lr.AwaitQueueRemovedTaskError=Lr.AwaitQueueStoppedError=void 0;const Mw=ha,pr=new Mw.Logger;class ma extends Error{constructor(e){super(e??"AwaitQueue stopped"),this.name="AwaitQueueStoppedError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ma)}}Lr.AwaitQueueStoppedError=ma;class ga extends Error{constructor(e){super(e??"AwaitQueue task removed"),this.name="AwaitQueueRemovedTaskError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ga)}}Lr.AwaitQueueRemovedTaskError=ga;class Ow{constructor(){this.pendingTasks=new Map,this.nextTaskId=0,this.stopping=!1}get size(){return this.pendingTasks.size}async push(e,r){if(r=r??e.name,pr.debug(`push() [name:${r}]`),typeof e!="function")throw new TypeError("given task is not a function");if(r)try{Object.defineProperty(e,"name",{value:r})}catch{}return new Promise((n,i)=>{const s={id:this.nextTaskId++,task:e,name:r,enqueuedAt:Date.now(),executedAt:void 0,completed:!1,resolve:o=>{if(s.completed)return;s.completed=!0,this.pendingTasks.delete(s.id),pr.debug(`resolving task [name:${s.name}]`),n(o);const[a]=this.pendingTasks.values();a&&!a.executedAt&&this.execute(a)},reject:o=>{if(!s.completed&&(s.completed=!0,this.pendingTasks.delete(s.id),pr.debug(`rejecting task [name:${s.name}]: %s`,String(o)),i(o),!this.stopping)){const[a]=this.pendingTasks.values();a&&!a.executedAt&&this.execute(a)}}};this.pendingTasks.set(s.id,s),this.pendingTasks.size===1&&this.execute(s)})}stop(){pr.debug("stop()"),this.stopping=!0;for(const e of this.pendingTasks.values())pr.debug(`stop() | stopping task [name:${e.name}]`),e.reject(new ma);this.stopping=!1}remove(e){pr.debug(`remove() [taskIdx:${e}]`);const r=Array.from(this.pendingTasks.values())[e];if(!r){pr.debug(`stop() | no task with given idx [taskIdx:${e}]`);return}r.reject(new ga)}dump(){const e=Date.now();let r=0;return Array.from(this.pendingTasks.values()).map(n=>({idx:r++,task:n.task,name:n.name,enqueuedTime:n.executedAt?n.executedAt-n.enqueuedAt:e-n.enqueuedAt,executionTime:n.executedAt?e-n.executedAt:0}))}async execute(e){if(pr.debug(`execute() [name:${e.name}]`),e.executedAt)throw new Error("task already being executed");e.executedAt=Date.now();try{const r=await e.task();e.resolve(r)}catch(r){e.reject(r)}}}Lr.AwaitQueue=Ow;/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let Rp;var Iw=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:S):t=>(Rp||(Rp=Promise.resolve())).then(t).catch(e=>setTimeout(()=>{throw e},0)),fs={};Object.defineProperty(fs,"__esModule",{value:!0});fs.Producer=void 0;const Nw=he,bp=Vt,pn=Ce,Pt=new Nw.Logger("Producer");class jw extends bp.EnhancedEventEmitter{constructor({id:e,localId:r,rtpSender:n,track:i,rtpParameters:s,stopTracks:o,disableTrackOnPause:a,zeroRtpOnPause:c,appData:l}){super(),this._closed=!1,this._observer=new bp.EnhancedEventEmitter,Pt.debug("constructor()"),this._id=e,this._localId=r,this._rtpSender=n,this._track=i,this._kind=i.kind,this._rtpParameters=s,this._paused=a?!i.enabled:!1,this._maxSpatialLayer=void 0,this._stopTracks=o,this._disableTrackOnPause=a,this._zeroRtpOnPause=c,this._appData=l??{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get closed(){return this._closed}get kind(){return this._kind}get rtpSender(){return this._rtpSender}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get maxSpatialLayer(){return this._maxSpatialLayer}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(Pt.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(Pt.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new pn.InvalidStateError("closed");return new Promise((e,r)=>{this.safeEmit("@getstats",e,r)})}pause(){if(Pt.debug("pause()"),this._closed){Pt.error("pause() | Producer closed");return}this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&new Promise((e,r)=>{this.safeEmit("@pause",e,r)}).catch(()=>{}),this._observer.safeEmit("pause")}resume(){if(Pt.debug("resume()"),this._closed){Pt.error("resume() | Producer closed");return}this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&new Promise((e,r)=>{this.safeEmit("@resume",e,r)}).catch(()=>{}),this._observer.safeEmit("resume")}async replaceTrack({track:e}){if(Pt.debug("replaceTrack() [track:%o]",e),this._closed){if(e&&this._stopTracks)try{e.stop()}catch{}throw new pn.InvalidStateError("closed")}else if(e&&e.readyState==="ended")throw new pn.InvalidStateError("track ended");if(e===this._track){Pt.debug("replaceTrack() | same track, ignored");return}await new Promise((r,n)=>{this.safeEmit("@replacetrack",e,r,n)}),this.destroyTrack(),this._track=e,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this.handleTrack()}async setMaxSpatialLayer(e){if(this._closed)throw new pn.InvalidStateError("closed");if(this._kind!=="video")throw new pn.UnsupportedError("not a video Producer");if(typeof e!="number")throw new TypeError("invalid spatialLayer");e!==this._maxSpatialLayer&&(await new Promise((r,n)=>{this.safeEmit("@setmaxspatiallayer",e,r,n)}).catch(()=>{}),this._maxSpatialLayer=e)}async setRtpEncodingParameters(e){if(this._closed)throw new pn.InvalidStateError("closed");if(typeof e!="object")throw new TypeError("invalid params");await new Promise((r,n)=>{this.safeEmit("@setrtpencodingparameters",e,r,n)})}onTrackEnded(){Pt.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track&&this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){if(this._track)try{this._track.removeEventListener("ended",this.onTrackEnded),this._stopTracks&&this._track.stop()}catch{}}}fs.Producer=jw;var hs={};Object.defineProperty(hs,"__esModule",{value:!0});hs.Consumer=void 0;const Aw=he,Cp=Vt,$w=Ce,kt=new Aw.Logger("Consumer");class Fw extends Cp.EnhancedEventEmitter{constructor({id:e,localId:r,producerId:n,rtpReceiver:i,track:s,rtpParameters:o,appData:a}){super(),this._closed=!1,this._observer=new Cp.EnhancedEventEmitter,kt.debug("constructor()"),this._id=e,this._localId=r,this._producerId=n,this._rtpReceiver=i,this._track=s,this._rtpParameters=o,this._paused=!s.enabled,this._appData=a??{},this.onTrackEnded=this.onTrackEnded.bind(this),this.handleTrack()}get id(){return this._id}get localId(){return this._localId}get producerId(){return this._producerId}get closed(){return this._closed}get kind(){return this._track.kind}get rtpReceiver(){return this._rtpReceiver}get track(){return this._track}get rtpParameters(){return this._rtpParameters}get paused(){return this._paused}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(kt.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(kt.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}async getStats(){if(this._closed)throw new $w.InvalidStateError("closed");return new Promise((e,r)=>{this.safeEmit("@getstats",e,r)})}pause(){if(kt.debug("pause()"),this._closed){kt.error("pause() | Consumer closed");return}if(this._paused){kt.debug("pause() | Consumer is already paused");return}this._paused=!0,this._track.enabled=!1,this.emit("@pause"),this._observer.safeEmit("pause")}resume(){if(kt.debug("resume()"),this._closed){kt.error("resume() | Consumer closed");return}if(!this._paused){kt.debug("resume() | Consumer is already resumed");return}this._paused=!1,this._track.enabled=!0,this.emit("@resume"),this._observer.safeEmit("resume")}onTrackEnded(){kt.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}handleTrack(){this._track.addEventListener("ended",this.onTrackEnded)}destroyTrack(){try{this._track.removeEventListener("ended",this.onTrackEnded),this._track.stop()}catch{}}}hs.Consumer=Fw;var ms={};Object.defineProperty(ms,"__esModule",{value:!0});ms.DataProducer=void 0;const Bw=he,Tp=Vt,zw=Ce,Yt=new Bw.Logger("DataProducer");class Uw extends Tp.EnhancedEventEmitter{constructor({id:e,dataChannel:r,sctpStreamParameters:n,appData:i}){super(),this._closed=!1,this._observer=new Tp.EnhancedEventEmitter,Yt.debug("constructor()"),this._id=e,this._dataChannel=r,this._sctpStreamParameters=n,this._appData=i??{},this.handleDataChannel()}get id(){return this._id}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get bufferedAmount(){return this._dataChannel.bufferedAmount}get bufferedAmountLowThreshold(){return this._dataChannel.bufferedAmountLowThreshold}set bufferedAmountLowThreshold(e){this._dataChannel.bufferedAmountLowThreshold=e}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(Yt.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(Yt.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}send(e){if(Yt.debug("send()"),this._closed)throw new zw.InvalidStateError("closed");this._dataChannel.send(e)}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(Yt.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",e=>{if(this._closed)return;let{error:r}=e;r||(r=new Error("unknown DataChannel error")),r.errorDetail==="sctp-failure"?Yt.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",r.sctpCauseCode,r.message):Yt.error('DataChannel "error" event: %o',r),this.safeEmit("error",r)}),this._dataChannel.addEventListener("close",()=>{this._closed||(Yt.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",()=>{this._closed||Yt.warn('DataChannel "message" event in a DataProducer, message discarded')}),this._dataChannel.addEventListener("bufferedamountlow",()=>{this._closed||this.safeEmit("bufferedamountlow")})}}ms.DataProducer=Uw;var gs={};Object.defineProperty(gs,"__esModule",{value:!0});gs.DataConsumer=void 0;const Vw=he,Dp=Vt,Br=new Vw.Logger("DataConsumer");class Hw extends Dp.EnhancedEventEmitter{constructor({id:e,dataProducerId:r,dataChannel:n,sctpStreamParameters:i,appData:s}){super(),this._closed=!1,this._observer=new Dp.EnhancedEventEmitter,Br.debug("constructor()"),this._id=e,this._dataProducerId=r,this._dataChannel=n,this._sctpStreamParameters=i,this._appData=s??{},this.handleDataChannel()}get id(){return this._id}get dataProducerId(){return this._dataProducerId}get closed(){return this._closed}get sctpStreamParameters(){return this._sctpStreamParameters}get readyState(){return this._dataChannel.readyState}get label(){return this._dataChannel.label}get protocol(){return this._dataChannel.protocol}get binaryType(){return this._dataChannel.binaryType}set binaryType(e){this._dataChannel.binaryType=e}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){this._closed||(Br.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}transportClosed(){this._closed||(Br.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}handleDataChannel(){this._dataChannel.addEventListener("open",()=>{this._closed||(Br.debug('DataChannel "open" event'),this.safeEmit("open"))}),this._dataChannel.addEventListener("error",e=>{if(this._closed)return;let{error:r}=e;r||(r=new Error("unknown DataChannel error")),r.errorDetail==="sctp-failure"?Br.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",r.sctpCauseCode,r.message):Br.error('DataChannel "error" event: %o',r),this.safeEmit("error",r)}),this._dataChannel.addEventListener("close",()=>{this._closed||(Br.warn('DataChannel "close" event'),this._closed=!0,this.emit("@close"),this.safeEmit("close"),this._observer.safeEmit("close"))}),this._dataChannel.addEventListener("message",e=>{this._closed||this.safeEmit("message",e.data)})}}gs.DataConsumer=Hw;var Kw=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ww=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Xm=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&Kw(e,t,r);return Ww(e,t),e},Qw=S&&S.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ps,"__esModule",{value:!0});ps.Transport=void 0;const qw=Lr,lc=Qw(Iw),Gw=he,Ep=Vt,Te=Ce,dc=Xm(we),Ri=Xm(ne),Yw=fs,Xw=hs,Jw=ms,Zw=gs,Se=new Gw.Logger("Transport");class eS{constructor(e){this.consumerOptions=e,this.promise=new Promise((r,n)=>{this.resolve=r,this.reject=n})}}class tS extends Ep.EnhancedEventEmitter{constructor({direction:e,id:r,iceParameters:n,iceCandidates:i,dtlsParameters:s,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:d,appData:p,handlerFactory:u,extendedRtpCapabilities:f,canProduceByKind:h}){super(),this._closed=!1,this._iceGatheringState="new",this._connectionState="new",this._producers=new Map,this._consumers=new Map,this._dataProducers=new Map,this._dataConsumers=new Map,this._probatorConsumerCreated=!1,this._awaitQueue=new qw.AwaitQueue,this._pendingConsumerTasks=[],this._consumerCreationInProgress=!1,this._pendingPauseConsumers=new Map,this._consumerPauseInProgress=!1,this._pendingResumeConsumers=new Map,this._consumerResumeInProgress=!1,this._pendingCloseConsumers=new Map,this._consumerCloseInProgress=!1,this._observer=new Ep.EnhancedEventEmitter,Se.debug("constructor() [id:%s, direction:%s]",r,e),this._id=r,this._direction=e,this._extendedRtpCapabilities=f,this._canProduceByKind=h,this._maxSctpMessageSize=o?o.maxMessageSize:null;const m=dc.clone(l)??{};delete m.iceServers,delete m.iceTransportPolicy,delete m.bundlePolicy,delete m.rtcpMuxPolicy,delete m.sdpSemantics,this._handler=u(),this._handler.run({direction:e,iceParameters:n,iceCandidates:i,dtlsParameters:s,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:m,proprietaryConstraints:d,extendedRtpCapabilities:f}),this._appData=p??{},this.handleHandler()}get id(){return this._id}get closed(){return this._closed}get direction(){return this._direction}get handler(){return this._handler}get iceGatheringState(){return this._iceGatheringState}get connectionState(){return this._connectionState}get appData(){return this._appData}set appData(e){this._appData=e}get observer(){return this._observer}close(){if(!this._closed){Se.debug("close()"),this._closed=!0,this._awaitQueue.stop(),this._handler.close(),this._connectionState="closed";for(const e of this._producers.values())e.transportClosed();this._producers.clear();for(const e of this._consumers.values())e.transportClosed();this._consumers.clear();for(const e of this._dataProducers.values())e.transportClosed();this._dataProducers.clear();for(const e of this._dataConsumers.values())e.transportClosed();this._dataConsumers.clear(),this._observer.safeEmit("close")}}async getStats(){if(this._closed)throw new Te.InvalidStateError("closed");return this._handler.getTransportStats()}async restartIce({iceParameters:e}){if(Se.debug("restartIce()"),this._closed)throw new Te.InvalidStateError("closed");if(!e)throw new TypeError("missing iceParameters");return this._awaitQueue.push(async()=>await this._handler.restartIce(e),"transport.restartIce()")}async updateIceServers({iceServers:e}={}){if(Se.debug("updateIceServers()"),this._closed)throw new Te.InvalidStateError("closed");if(!Array.isArray(e))throw new TypeError("missing iceServers");return this._awaitQueue.push(async()=>this._handler.updateIceServers(e),"transport.updateIceServers()")}async produce({track:e,encodings:r,codecOptions:n,codec:i,stopTracks:s=!0,disableTrackOnPause:o=!0,zeroRtpOnPause:a=!1,onRtpSender:c,appData:l={}}={}){if(Se.debug("produce() [track:%o]",e),this._closed)throw new Te.InvalidStateError("closed");if(e){if(this._direction!=="send")throw new Te.UnsupportedError("not a sending Transport");if(this._canProduceByKind[e.kind]){if(e.readyState==="ended")throw new Te.InvalidStateError("track ended");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("produce")===0)throw new TypeError('no "produce" listener set into this transport');if(l&&typeof l!="object")throw new TypeError("if given, appData must be an object")}else throw new Te.UnsupportedError(`cannot produce ${e.kind}`)}else throw new TypeError("missing track");return this._awaitQueue.push(async()=>{let d;if(r&&!Array.isArray(r))throw TypeError("encodings must be an array");r&&r.length===0?d=void 0:r&&(d=r.map(h=>{const m={active:!0};return h.active===!1&&(m.active=!1),typeof h.dtx=="boolean"&&(m.dtx=h.dtx),typeof h.scalabilityMode=="string"&&(m.scalabilityMode=h.scalabilityMode),typeof h.scaleResolutionDownBy=="number"&&(m.scaleResolutionDownBy=h.scaleResolutionDownBy),typeof h.maxBitrate=="number"&&(m.maxBitrate=h.maxBitrate),typeof h.maxFramerate=="number"&&(m.maxFramerate=h.maxFramerate),typeof h.adaptivePtime=="boolean"&&(m.adaptivePtime=h.adaptivePtime),typeof h.priority=="string"&&(m.priority=h.priority),typeof h.networkPriority=="string"&&(m.networkPriority=h.networkPriority),m}));const{localId:p,rtpParameters:u,rtpSender:f}=await this._handler.send({track:e,encodings:d,codecOptions:n,codec:i,onRtpSender:c});try{Ri.validateRtpParameters(u);const{id:h}=await new Promise((y,g)=>{this.safeEmit("produce",{kind:e.kind,rtpParameters:u,appData:l},y,g)}),m=new Yw.Producer({id:h,localId:p,rtpSender:f,track:e,rtpParameters:u,stopTracks:s,disableTrackOnPause:o,zeroRtpOnPause:a,appData:l});return this._producers.set(m.id,m),this.handleProducer(m),this._observer.safeEmit("newproducer",m),m}catch(h){throw this._handler.stopSending(p).catch(()=>{}),h}},"transport.produce()").catch(d=>{if(s)try{e.stop()}catch{}throw d})}async consume({id:e,producerId:r,kind:n,rtpParameters:i,streamId:s,onRtpReceiver:o,appData:a={}}){if(Se.debug("consume()"),this._closed)throw new Te.InvalidStateError("closed");if(this._direction!=="recv")throw new Te.UnsupportedError("not a receiving Transport");if(typeof e!="string")throw new TypeError("missing id");if(typeof r!="string")throw new TypeError("missing producerId");if(n!=="audio"&&n!=="video")throw new TypeError(`invalid kind '${n}'`);if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(a&&typeof a!="object")throw new TypeError("if given, appData must be an object");const c=dc.clone(i);if(!Ri.canReceive(c,this._extendedRtpCapabilities))throw new Te.UnsupportedError("cannot consume this Producer");const d=new eS({id:e,producerId:r,kind:n,rtpParameters:c,streamId:s,onRtpReceiver:o,appData:a});return this._pendingConsumerTasks.push(d),(0,lc.default)(()=>{this._closed||this._consumerCreationInProgress===!1&&this.createPendingConsumers()}),d.promise}async produceData({ordered:e=!0,maxPacketLifeTime:r,maxRetransmits:n,label:i="",protocol:s="",appData:o={}}={}){if(Se.debug("produceData()"),this._closed)throw new Te.InvalidStateError("closed");if(this._direction!=="send")throw new Te.UnsupportedError("not a sending Transport");if(this._maxSctpMessageSize){if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(this.listenerCount("producedata")===0)throw new TypeError('no "producedata" listener set into this transport');if(o&&typeof o!="object")throw new TypeError("if given, appData must be an object")}else throw new Te.UnsupportedError("SCTP not enabled by remote Transport");return(r||n)&&(e=!1),this._awaitQueue.push(async()=>{const{dataChannel:a,sctpStreamParameters:c}=await this._handler.sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s});Ri.validateSctpStreamParameters(c);const{id:l}=await new Promise((p,u)=>{this.safeEmit("producedata",{sctpStreamParameters:c,label:i,protocol:s,appData:o},p,u)}),d=new Jw.DataProducer({id:l,dataChannel:a,sctpStreamParameters:c,appData:o});return this._dataProducers.set(d.id,d),this.handleDataProducer(d),this._observer.safeEmit("newdataproducer",d),d},"transport.produceData()")}async consumeData({id:e,dataProducerId:r,sctpStreamParameters:n,label:i="",protocol:s="",appData:o={}}){if(Se.debug("consumeData()"),this._closed)throw new Te.InvalidStateError("closed");if(this._direction!=="recv")throw new Te.UnsupportedError("not a receiving Transport");if(this._maxSctpMessageSize){if(typeof e!="string")throw new TypeError("missing id");if(typeof r!="string")throw new TypeError("missing dataProducerId");if(this.listenerCount("connect")===0&&this._connectionState==="new")throw new TypeError('no "connect" listener set into this transport');if(o&&typeof o!="object")throw new TypeError("if given, appData must be an object")}else throw new Te.UnsupportedError("SCTP not enabled by remote Transport");const a=dc.clone(n);return Ri.validateSctpStreamParameters(a),this._awaitQueue.push(async()=>{const{dataChannel:c}=await this._handler.receiveDataChannel({sctpStreamParameters:a,label:i,protocol:s}),l=new Zw.DataConsumer({id:e,dataProducerId:r,dataChannel:c,sctpStreamParameters:a,appData:o});return this._dataConsumers.set(l.id,l),this.handleDataConsumer(l),this._observer.safeEmit("newdataconsumer",l),l},"transport.consumeData()")}async createPendingConsumers(){this._consumerCreationInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingConsumerTasks.length===0){Se.debug("createPendingConsumers() | there is no Consumer to be created");return}const e=[...this._pendingConsumerTasks];this._pendingConsumerTasks=[];let r;const n=[];for(const i of e){const{id:s,kind:o,rtpParameters:a,streamId:c,onRtpReceiver:l}=i.consumerOptions;n.push({trackId:s,kind:o,rtpParameters:a,streamId:c,onRtpReceiver:l})}try{const i=await this._handler.receive(n);for(let s=0;s<i.length;++s){const o=e[s],a=i[s],{id:c,producerId:l,kind:d,rtpParameters:p,appData:u}=o.consumerOptions,{localId:f,rtpReceiver:h,track:m}=a,y=new Xw.Consumer({id:c,localId:f,producerId:l,rtpReceiver:h,track:m,rtpParameters:p,appData:u});this._consumers.set(y.id,y),this.handleConsumer(y),!this._probatorConsumerCreated&&!r&&d==="video"&&(r=y),this._observer.safeEmit("newconsumer",y),o.resolve(y)}}catch(i){for(const s of e)s.reject(i)}if(r)try{const i=Ri.generateProbatorRtpParameters(r.rtpParameters);await this._handler.receive([{trackId:"probator",kind:"video",rtpParameters:i}]),Se.debug("createPendingConsumers() | Consumer for RTP probation created"),this._probatorConsumerCreated=!0}catch(i){Se.error("createPendingConsumers() | failed to create Consumer for RTP probation:%o",i)}},"transport.createPendingConsumers()").then(()=>{this._consumerCreationInProgress=!1,this._pendingConsumerTasks.length>0&&this.createPendingConsumers()}).catch(()=>{})}pausePendingConsumers(){this._consumerPauseInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingPauseConsumers.size===0){Se.debug("pausePendingConsumers() | there is no Consumer to be paused");return}const e=Array.from(this._pendingPauseConsumers.values());this._pendingPauseConsumers.clear();try{const r=e.map(n=>n.localId);await this._handler.pauseReceiving(r)}catch(r){Se.error("pausePendingConsumers() | failed to pause Consumers:",r)}},"transport.pausePendingConsumers").then(()=>{this._consumerPauseInProgress=!1,this._pendingPauseConsumers.size>0&&this.pausePendingConsumers()}).catch(()=>{})}resumePendingConsumers(){this._consumerResumeInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingResumeConsumers.size===0){Se.debug("resumePendingConsumers() | there is no Consumer to be resumed");return}const e=Array.from(this._pendingResumeConsumers.values());this._pendingResumeConsumers.clear();try{const r=e.map(n=>n.localId);await this._handler.resumeReceiving(r)}catch(r){Se.error("resumePendingConsumers() | failed to resume Consumers:",r)}},"transport.resumePendingConsumers").then(()=>{this._consumerResumeInProgress=!1,this._pendingResumeConsumers.size>0&&this.resumePendingConsumers()}).catch(()=>{})}closePendingConsumers(){this._consumerCloseInProgress=!0,this._awaitQueue.push(async()=>{if(this._pendingCloseConsumers.size===0){Se.debug("closePendingConsumers() | there is no Consumer to be closed");return}const e=Array.from(this._pendingCloseConsumers.values());this._pendingCloseConsumers.clear();try{await this._handler.stopReceiving(e.map(r=>r.localId))}catch(r){Se.error("closePendingConsumers() | failed to close Consumers:",r)}},"transport.closePendingConsumers").then(()=>{this._consumerCloseInProgress=!1,this._pendingCloseConsumers.size>0&&this.closePendingConsumers()}).catch(()=>{})}handleHandler(){const e=this._handler;e.on("@connect",({dtlsParameters:r},n,i)=>{if(this._closed){i(new Te.InvalidStateError("closed"));return}this.safeEmit("connect",{dtlsParameters:r},n,i)}),e.on("@icegatheringstatechange",r=>{r!==this._iceGatheringState&&(Se.debug("ICE gathering state changed to %s",r),this._iceGatheringState=r,this._closed||this.safeEmit("icegatheringstatechange",r))}),e.on("@connectionstatechange",r=>{r!==this._connectionState&&(Se.debug("connection state changed to %s",r),this._connectionState=r,this._closed||this.safeEmit("connectionstatechange",r))})}handleProducer(e){e.on("@close",()=>{this._producers.delete(e.id),!this._closed&&this._awaitQueue.push(async()=>await this._handler.stopSending(e.localId),"producer @close event").catch(r=>Se.warn("producer.close() failed:%o",r))}),e.on("@pause",(r,n)=>{this._awaitQueue.push(async()=>await this._handler.pauseSending(e.localId),"producer @pause event").then(r).catch(n)}),e.on("@resume",(r,n)=>{this._awaitQueue.push(async()=>await this._handler.resumeSending(e.localId),"producer @resume event").then(r).catch(n)}),e.on("@replacetrack",(r,n,i)=>{this._awaitQueue.push(async()=>await this._handler.replaceTrack(e.localId,r),"producer @replacetrack event").then(n).catch(i)}),e.on("@setmaxspatiallayer",(r,n,i)=>{this._awaitQueue.push(async()=>await this._handler.setMaxSpatialLayer(e.localId,r),"producer @setmaxspatiallayer event").then(n).catch(i)}),e.on("@setrtpencodingparameters",(r,n,i)=>{this._awaitQueue.push(async()=>await this._handler.setRtpEncodingParameters(e.localId,r),"producer @setrtpencodingparameters event").then(n).catch(i)}),e.on("@getstats",(r,n)=>{if(this._closed)return n(new Te.InvalidStateError("closed"));this._handler.getSenderStats(e.localId).then(r).catch(n)})}handleConsumer(e){e.on("@close",()=>{this._consumers.delete(e.id),this._pendingPauseConsumers.delete(e.id),this._pendingResumeConsumers.delete(e.id),!this._closed&&(this._pendingCloseConsumers.set(e.id,e),this._consumerCloseInProgress===!1&&this.closePendingConsumers())}),e.on("@pause",()=>{this._pendingResumeConsumers.has(e.id)&&this._pendingResumeConsumers.delete(e.id),this._pendingPauseConsumers.set(e.id,e),(0,lc.default)(()=>{this._closed||this._consumerPauseInProgress===!1&&this.pausePendingConsumers()})}),e.on("@resume",()=>{this._pendingPauseConsumers.has(e.id)&&this._pendingPauseConsumers.delete(e.id),this._pendingResumeConsumers.set(e.id,e),(0,lc.default)(()=>{this._closed||this._consumerResumeInProgress===!1&&this.resumePendingConsumers()})}),e.on("@getstats",(r,n)=>{if(this._closed)return n(new Te.InvalidStateError("closed"));this._handler.getReceiverStats(e.localId).then(r).catch(n)})}handleDataProducer(e){e.on("@close",()=>{this._dataProducers.delete(e.id)})}handleDataConsumer(e){e.on("@close",()=>{this._dataConsumers.delete(e.id)})}}ps.Transport=tS;var va={},ve={},Jm={},Zm={exports:{}},Pp=Zm.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(t){return t.encoding?"rtpmap:%d %s/%s/%s":t.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(t){return t.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(t){return t.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(t){return"extmap:%d"+(t.direction?"/%s":"%v")+(t["encrypt-uri"]?" %s":"%v")+" %s"+(t.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(t){return t.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(t){var e="candidate:%s %d %s %d %s %d typ %s";return e+=t.raddr!=null?" raddr %s rport %d":"%v%v",e+=t.tcptype!=null?" tcptype %s":"%v",t.generation!=null&&(e+=" generation %d"),e+=t["network-id"]!=null?" network-id %d":"%v",e+=t["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(t){var e="ssrc:%d";return t.attribute!=null&&(e+=" %s",t.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(t){return t.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(t){return t.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(t){return"imageattr:%s %s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(t){return"simulcast:%s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(t){return"ts-refclk:%s"+(t.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(t){var e="mediaclk:";return e+=t.id!=null?"id=%s %s":"%v%s",e+=t.mediaClockValue!=null?"=%s":"",e+=t.rateNumerator!=null?" rate=%s":"",e+=t.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(Pp).forEach(function(t){var e=Pp[t];e.forEach(function(r){r.reg||(r.reg=/(.*)/),r.format||(r.format="%s")})});var eg=Zm.exports;(function(t){var e=function(a){return String(Number(a))===a?Number(a):a},r=function(a,c,l,d){if(d&&!l)c[d]=e(a[1]);else for(var p=0;p<l.length;p+=1)a[p+1]!=null&&(c[l[p]]=e(a[p+1]))},n=function(a,c,l){var d=a.name&&a.names;a.push&&!c[a.push]?c[a.push]=[]:d&&!c[a.name]&&(c[a.name]={});var p=a.push?{}:d?c[a.name]:c;r(l.match(a.reg),p,a.names,a.name),a.push&&c[a.push].push(p)},i=eg,s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(a){var c={},l=[],d=c;return a.split(/(\r\n|\r|\n)/).filter(s).forEach(function(p){var u=p[0],f=p.slice(2);u==="m"&&(l.push({rtp:[],fmtp:[]}),d=l[l.length-1]);for(var h=0;h<(i[u]||[]).length;h+=1){var m=i[u][h];if(m.reg.test(f))return n(m,d,f)}}),c.media=l,c};var o=function(a,c){var l=c.split(/=(.+)/,2);return l.length===2?a[l[0]]=e(l[1]):l.length===1&&c.length>1&&(a[l[0]]=void 0),a};t.parseParams=function(a){return a.split(/;\s?/).reduce(o,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(a){return a.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(a){for(var c=[],l=a.split(" ").map(e),d=0;d<l.length;d+=3)c.push({component:l[d],ip:l[d+1],port:l[d+2]});return c},t.parseImageAttributes=function(a){return a.split(" ").map(function(c){return c.substring(1,c.length-1).split(",").reduce(o,{})})},t.parseSimulcastStreamList=function(a){return a.split(";").map(function(c){return c.split(",").map(function(l){var d,p=!1;return l[0]!=="~"?d=e(l):(d=e(l.substring(1,l.length)),p=!0),{scid:d,paused:p}})})}})(Jm);var uc=eg,rS=/%[sdv%]/g,nS=function(t){var e=1,r=arguments,n=r.length;return t.replace(rS,function(i){if(e>=n)return i;var s=r[e];switch(e+=1,i){case"%%":return"%";case"%s":return String(s);case"%d":return Number(s);case"%v":return""}})},bi=function(t,e,r){var n=e.format instanceof Function?e.format(e.push?r:r[e.name]):e.format,i=[t+"="+n];if(e.names)for(var s=0;s<e.names.length;s+=1){var o=e.names[s];e.name?i.push(r[e.name][o]):i.push(r[e.names[s]])}else i.push(r[e.name]);return nS.apply(null,i)},iS=["v","o","s","i","u","e","p","c","b","t","r","z","a"],sS=["i","c","b","a"],oS=function(t,e){e=e||{},t.version==null&&(t.version=0),t.name==null&&(t.name=" "),t.media.forEach(function(s){s.payloads==null&&(s.payloads="")});var r=e.outerOrder||iS,n=e.innerOrder||sS,i=[];return r.forEach(function(s){uc[s].forEach(function(o){o.name in t&&t[o.name]!=null?i.push(bi(s,o,t)):o.push in t&&t[o.push]!=null&&t[o.push].forEach(function(a){i.push(bi(s,o,a))})})}),t.media.forEach(function(s){i.push(bi("m",uc.m[0],s)),n.forEach(function(o){uc[o].forEach(function(a){a.name in s&&s[a.name]!=null?i.push(bi(o,a,s)):a.push in s&&s[a.push]!=null&&s[a.push].forEach(function(c){i.push(bi(o,a,c))})})})}),i.join(`\r
`)+`\r
`},tn=Jm,aS=oS;ve.write=aS;ve.parse=tn.parse;ve.parseParams=tn.parseParams;ve.parseFmtpConfig=tn.parseFmtpConfig;ve.parsePayloads=tn.parsePayloads;ve.parseRemoteCandidates=tn.parseRemoteCandidates;ve.parseImageAttributes=tn.parseImageAttributes;ve.parseSimulcastStreamList=tn.parseSimulcastStreamList;var Be={},cS=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),lS=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),dS=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&cS(e,t,r);return lS(e,t),e};Object.defineProperty(Be,"__esModule",{value:!0});Be.extractRtpCapabilities=uS;Be.extractDtlsParameters=pS;Be.getCname=fS;Be.applyCodecParameters=hS;const tg=dS(ve);function uS({sdpObject:t}){const e=new Map,r=[];let n=!1,i=!1;for(const o of t.media){const a=o.type;switch(a){case"audio":{if(n)continue;n=!0;break}case"video":{if(i)continue;i=!0;break}default:continue}for(const c of o.rtp){const l={kind:a,mimeType:`${a}/${c.codec}`,preferredPayloadType:c.payload,clockRate:c.rate,channels:c.encoding,parameters:{},rtcpFeedback:[]};e.set(l.preferredPayloadType,l)}for(const c of o.fmtp||[]){const l=tg.parseParams(c.config),d=e.get(c.payload);d&&(l!=null&&l.hasOwnProperty("profile-level-id")&&(l["profile-level-id"]=String(l["profile-level-id"])),d.parameters=l)}for(const c of o.rtcpFb||[]){const l={type:c.type,parameter:c.subtype};if(l.parameter||delete l.parameter,c.payload!=="*"){const d=e.get(c.payload);if(!d)continue;d.rtcpFeedback.push(l)}else for(const d of e.values())d.kind===a&&!/.+\/rtx$/i.test(d.mimeType)&&d.rtcpFeedback.push(l)}for(const c of o.ext||[]){if(c["encrypt-uri"])continue;const l={kind:a,uri:c.uri,preferredId:c.value};r.push(l)}}return{codecs:Array.from(e.values()),headerExtensions:r}}function pS({sdpObject:t}){let e=t.setup,r=t.fingerprint;if(!e||!r){const s=(t.media||[]).find(o=>o.port!==0);s&&(e??(e=s.setup),r??(r=s.fingerprint))}if(e){if(!r)throw new Error("no a=fingerprint found at SDP session or media level")}else throw new Error("no a=setup found at SDP session or media level");let n;switch(e){case"active":{n="client";break}case"passive":{n="server";break}case"actpass":{n="auto";break}}return{role:n,fingerprints:[{algorithm:r.type,value:r.hash}]}}function fS({offerMediaObject:t}){const e=(t.ssrcs||[]).find(r=>r.attribute==="cname");return e?e.value:""}function hS({offerRtpParameters:t,answerMediaObject:e}){for(const r of t.codecs){const n=r.mimeType.toLowerCase();if(n!=="audio/opus"||!(e.rtp||[]).find(a=>a.payload===r.payloadType))continue;e.fmtp=e.fmtp||[];let s=e.fmtp.find(a=>a.payload===r.payloadType);s||(s={payload:r.payloadType,config:""},e.fmtp.push(s));const o=tg.parseParams(s.config);switch(n){case"audio/opus":{const a=r.parameters["sprop-stereo"];a!==void 0&&(o.stereo=a?1:0);break}}s.config="";for(const a of Object.keys(o))s.config&&(s.config+=";"),s.config+=`${a}=${o[a]}`}}var Ht={};Object.defineProperty(Ht,"__esModule",{value:!0});Ht.getRtpEncodings=mS;Ht.addLegacySimulcast=gS;function mS({offerMediaObject:t}){const e=new Set;for(const i of t.ssrcs||[]){const s=i.id;e.add(s)}if(e.size===0)throw new Error("no a=ssrc lines found");const r=new Map;for(const i of t.ssrcGroups||[]){if(i.semantics!=="FID")continue;let[s,o]=i.ssrcs.split(/\s+/);s=Number(s),o=Number(o),e.has(s)&&(e.delete(s),e.delete(o),r.set(s,o))}for(const i of e)r.set(i,null);const n=[];for(const[i,s]of r){const o={ssrc:i};s&&(o.rtx={ssrc:s}),n.push(o)}return n}function gS({offerMediaObject:t,numStreams:e}){if(e<=1)throw new TypeError("numStreams must be greater than 1");const r=(t.ssrcs||[]).find(p=>p.attribute==="msid");if(!r)throw new Error("a=ssrc line with msid information not found");const[n,i]=r.value.split(" "),s=Number(r.id);let o;(t.ssrcGroups||[]).some(p=>{if(p.semantics!=="FID")return!1;const u=p.ssrcs.split(/\s+/);return Number(u[0])===s?(o=Number(u[1]),!0):!1});const a=t.ssrcs.find(p=>p.attribute==="cname");if(!a)throw new Error("a=ssrc line with cname information not found");const c=a.value,l=[],d=[];for(let p=0;p<e;++p)l.push(s+p),o&&d.push(o+p);t.ssrcGroups=[],t.ssrcs=[],t.ssrcGroups.push({semantics:"SIM",ssrcs:l.join(" ")});for(const p of l)t.ssrcs.push({id:p,attribute:"cname",value:c}),t.ssrcs.push({id:p,attribute:"msid",value:`${n} ${i}`});for(let p=0;p<d.length;++p){const u=l[p],f=d[p];t.ssrcs.push({id:f,attribute:"cname",value:c}),t.ssrcs.push({id:f,attribute:"msid",value:`${n} ${i}`}),t.ssrcGroups.push({semantics:"FID",ssrcs:`${u} ${f}`})}}var oi={};Object.defineProperty(oi,"__esModule",{value:!0});oi.addNackSuppportForOpus=vS;function vS(t){var e;for(const r of t.codecs??[])(r.mimeType.toLowerCase()==="audio/opus"||r.mimeType.toLowerCase()==="audio/multiopus")&&!((e=r.rtcpFeedback)!=null&&e.some(n=>n.type==="nack"&&!n.parameter))&&(r.rtcpFeedback||(r.rtcpFeedback=[]),r.rtcpFeedback.push({type:"nack"}))}var ze={};Object.defineProperty(ze,"__esModule",{value:!0});ze.HandlerInterface=void 0;const _S=Vt;class yS extends _S.EnhancedEventEmitter{constructor(){super()}}ze.HandlerInterface=yS;var Xe={},Mr={},wS=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),SS=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),rg=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&wS(e,t,r);return SS(e,t),e};Object.defineProperty(Mr,"__esModule",{value:!0});Mr.OfferMediaSection=Mr.AnswerMediaSection=Mr.MediaSection=void 0;const RS=rg(ve),kp=rg(we);class xd{constructor({iceParameters:e,iceCandidates:r,dtlsParameters:n,planB:i=!1}){if(this._mediaObject={},this._planB=i,e&&this.setIceParameters(e),r){this._mediaObject.candidates=[];for(const s of r){const o={};o.component=1,o.foundation=s.foundation,o.ip=s.address??s.ip,o.port=s.port,o.priority=s.priority,o.transport=s.protocol,o.type=s.type,s.tcpType&&(o.tcptype=s.tcpType),this._mediaObject.candidates.push(o)}this._mediaObject.endOfCandidates="end-of-candidates",this._mediaObject.iceOptions="renomination"}n&&this.setDtlsRole(n.role)}get mid(){return String(this._mediaObject.mid)}get closed(){return this._mediaObject.port===0}getObject(){return this._mediaObject}setIceParameters(e){this._mediaObject.iceUfrag=e.usernameFragment,this._mediaObject.icePwd=e.password}pause(){this._mediaObject.direction="inactive"}disable(){this.pause(),delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids,delete this._mediaObject.extmapAllowMixed}close(){this.disable(),this._mediaObject.port=0}}Mr.MediaSection=xd;class bS extends xd{constructor({iceParameters:e,iceCandidates:r,dtlsParameters:n,sctpParameters:i,plainRtpParameters:s,planB:o=!1,offerMediaObject:a,offerRtpParameters:c,answerRtpParameters:l,codecOptions:d,extmapAllowMixed:p=!1}){switch(super({iceParameters:e,iceCandidates:r,dtlsParameters:n,planB:o}),this._mediaObject.mid=String(a.mid),this._mediaObject.type=a.type,this._mediaObject.protocol=a.protocol,s?(this._mediaObject.connection={ip:s.ip,version:s.ipVersion},this._mediaObject.port=s.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},this._mediaObject.port=7),a.type){case"audio":case"video":{this._mediaObject.direction="recvonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[];for(const u of l.codecs){const f={payload:u.payloadType,codec:bl(u),rate:u.clockRate};u.channels>1&&(f.encoding=u.channels),this._mediaObject.rtp.push(f);const h=kp.clone(u.parameters)??{};let m=kp.clone(u.rtcpFeedback)??[];if(d){const{opusStereo:g,opusFec:v,opusDtx:_,opusMaxPlaybackRate:w,opusMaxAverageBitrate:b,opusPtime:C,opusNack:E,videoGoogleStartBitrate:P,videoGoogleMaxBitrate:Y,videoGoogleMinBitrate:A}=d,_e=c.codecs.find(Ie=>Ie.payloadType===u.payloadType);switch(u.mimeType.toLowerCase()){case"audio/opus":case"audio/multiopus":{g!==void 0&&(_e.parameters["sprop-stereo"]=g?1:0,h.stereo=g?1:0),v!==void 0&&(_e.parameters.useinbandfec=v?1:0,h.useinbandfec=v?1:0),_!==void 0&&(_e.parameters.usedtx=_?1:0,h.usedtx=_?1:0),w!==void 0&&(h.maxplaybackrate=w),b!==void 0&&(h.maxaveragebitrate=b),C!==void 0&&(_e.parameters.ptime=C,h.ptime=C),E||(_e.rtcpFeedback=_e.rtcpFeedback.filter(Ie=>Ie.type!=="nack"||Ie.parameter),m=m.filter(Ie=>Ie.type!=="nack"||Ie.parameter));break}case"video/vp8":case"video/vp9":case"video/h264":case"video/h265":{P!==void 0&&(h["x-google-start-bitrate"]=P),Y!==void 0&&(h["x-google-max-bitrate"]=Y),A!==void 0&&(h["x-google-min-bitrate"]=A);break}}}const y={payload:u.payloadType,config:""};for(const g of Object.keys(h))y.config&&(y.config+=";"),y.config+=`${g}=${h[g]}`;y.config&&this._mediaObject.fmtp.push(y);for(const g of m)this._mediaObject.rtcpFb.push({payload:u.payloadType,type:g.type,subtype:g.parameter})}this._mediaObject.payloads=l.codecs.map(u=>u.payloadType).join(" "),this._mediaObject.ext=[];for(const u of l.headerExtensions)(a.ext??[]).some(h=>h.uri===u.uri)&&this._mediaObject.ext.push({uri:u.uri,value:u.id});if(p&&a.extmapAllowMixed==="extmap-allow-mixed"&&(this._mediaObject.extmapAllowMixed="extmap-allow-mixed"),a.simulcast){this._mediaObject.simulcast={dir1:"recv",list1:a.simulcast.list1},this._mediaObject.rids=[];for(const u of a.rids??[])u.direction==="send"&&this._mediaObject.rids.push({id:u.id,direction:"recv"})}else if(a.simulcast_03){this._mediaObject.simulcast_03={value:a.simulcast_03.value.replace(/send/g,"recv")},this._mediaObject.rids=[];for(const u of a.rids??[])u.direction==="send"&&this._mediaObject.rids.push({id:u.id,direction:"recv"})}this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize",this._planB&&this._mediaObject.type==="video"&&(this._mediaObject.xGoogleFlag="conference");break}case"application":{typeof a.sctpPort=="number"?(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=i.port,this._mediaObject.maxMessageSize=i.maxMessageSize):a.sctpmap&&(this._mediaObject.payloads=i.port,this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:i.port,maxMessageSize:i.maxMessageSize});break}}}setDtlsRole(e){switch(e){case"client":{this._mediaObject.setup="active";break}case"server":{this._mediaObject.setup="passive";break}case"auto":{this._mediaObject.setup="actpass";break}}}resume(){this._mediaObject.direction="recvonly"}muxSimulcastStreams(e){var s,o;if(!((s=this._mediaObject.simulcast)!=null&&s.list1))return;const r={};for(const a of e)a.rid&&(r[a.rid]=a);const n=this._mediaObject.simulcast.list1,i=RS.parseSimulcastStreamList(n);for(const a of i)for(const c of a)c.paused=!((o=r[c.scid])!=null&&o.active);this._mediaObject.simulcast.list1=i.map(a=>a.map(c=>`${c.paused?"~":""}${c.scid}`).join(",")).join(";")}}Mr.AnswerMediaSection=bS;class CS extends xd{constructor({iceParameters:e,iceCandidates:r,dtlsParameters:n,sctpParameters:i,plainRtpParameters:s,planB:o=!1,mid:a,kind:c,offerRtpParameters:l,streamId:d,trackId:p,oldDataChannelSpec:u=!1}){var f;switch(super({iceParameters:e,iceCandidates:r,dtlsParameters:n,planB:o}),this._mediaObject.mid=String(a),this._mediaObject.type=c,s?(this._mediaObject.connection={ip:s.ip,version:s.ipVersion},this._mediaObject.protocol="RTP/AVP",this._mediaObject.port=s.port):(this._mediaObject.connection={ip:"127.0.0.1",version:4},i?this._mediaObject.protocol="UDP/DTLS/SCTP":this._mediaObject.protocol="UDP/TLS/RTP/SAVPF",this._mediaObject.port=7),c){case"audio":case"video":{this._mediaObject.direction="sendonly",this._mediaObject.rtp=[],this._mediaObject.rtcpFb=[],this._mediaObject.fmtp=[],this._planB||(this._mediaObject.msid=`${d??"-"} ${p}`);for(const g of l.codecs){const v={payload:g.payloadType,codec:bl(g),rate:g.clockRate};g.channels>1&&(v.encoding=g.channels),this._mediaObject.rtp.push(v);const _={payload:g.payloadType,config:""};for(const w of Object.keys(g.parameters))_.config&&(_.config+=";"),_.config+=`${w}=${g.parameters[w]}`;_.config&&this._mediaObject.fmtp.push(_);for(const w of g.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:g.payloadType,type:w.type,subtype:w.parameter})}this._mediaObject.payloads=l.codecs.map(g=>g.payloadType).join(" "),this._mediaObject.ext=[];for(const g of l.headerExtensions)this._mediaObject.ext.push({uri:g.uri,value:g.id});this._mediaObject.rtcpMux="rtcp-mux",this._mediaObject.rtcpRsize="rtcp-rsize";const h=l.encodings[0],m=h.ssrc,y=(f=h.rtx)==null?void 0:f.ssrc;this._mediaObject.ssrcs=[],this._mediaObject.ssrcGroups=[],l.rtcp.cname&&this._mediaObject.ssrcs.push({id:m,attribute:"cname",value:l.rtcp.cname}),this._planB&&this._mediaObject.ssrcs.push({id:m,attribute:"msid",value:`${d??"-"} ${p}`}),y&&(l.rtcp.cname&&this._mediaObject.ssrcs.push({id:y,attribute:"cname",value:l.rtcp.cname}),this._planB&&this._mediaObject.ssrcs.push({id:y,attribute:"msid",value:`${d??"-"} ${p}`}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${m} ${y}`}));break}case"application":{u?(this._mediaObject.payloads=i.port,this._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:i.port,maxMessageSize:i.maxMessageSize}):(this._mediaObject.payloads="webrtc-datachannel",this._mediaObject.sctpPort=i.port,this._mediaObject.maxMessageSize=i.maxMessageSize);break}}}setDtlsRole(e){this._mediaObject.setup="actpass"}resume(){this._mediaObject.direction="sendonly"}planBReceive({offerRtpParameters:e,streamId:r,trackId:n}){var c;const i=e.encodings[0],s=i.ssrc,o=(c=i.rtx)==null?void 0:c.ssrc,a=this._mediaObject.payloads.split(" ");for(const l of e.codecs){if(a.includes(String(l.payloadType)))continue;const d={payload:l.payloadType,codec:bl(l),rate:l.clockRate};l.channels>1&&(d.encoding=l.channels),this._mediaObject.rtp.push(d);const p={payload:l.payloadType,config:""};for(const u of Object.keys(l.parameters))p.config&&(p.config+=";"),p.config+=`${u}=${l.parameters[u]}`;p.config&&this._mediaObject.fmtp.push(p);for(const u of l.rtcpFeedback)this._mediaObject.rtcpFb.push({payload:l.payloadType,type:u.type,subtype:u.parameter})}this._mediaObject.payloads+=` ${e.codecs.filter(l=>!this._mediaObject.payloads.includes(l.payloadType)).map(l=>l.payloadType).join(" ")}`,this._mediaObject.payloads=this._mediaObject.payloads.trim(),e.rtcp.cname&&this._mediaObject.ssrcs.push({id:s,attribute:"cname",value:e.rtcp.cname}),this._mediaObject.ssrcs.push({id:s,attribute:"msid",value:`${r??"-"} ${n}`}),o&&(e.rtcp.cname&&this._mediaObject.ssrcs.push({id:o,attribute:"cname",value:e.rtcp.cname}),this._mediaObject.ssrcs.push({id:o,attribute:"msid",value:`${r??"-"} ${n}`}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:`${s} ${o}`}))}planBStopReceiving({offerRtpParameters:e}){var s;const r=e.encodings[0],n=r.ssrc,i=(s=r.rtx)==null?void 0:s.ssrc;this._mediaObject.ssrcs=this._mediaObject.ssrcs.filter(o=>o.id!==n&&o.id!==i),i&&(this._mediaObject.ssrcGroups=this._mediaObject.ssrcGroups.filter(o=>o.ssrcs!==`${n} ${i}`))}}Mr.OfferMediaSection=CS;function bl(t){const r=new RegExp("^(audio|video)/(.+)","i").exec(t.mimeType);if(!r)throw new TypeError("invalid codec.mimeType");return r[2]}var TS=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),DS=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ES=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&TS(e,t,r);return DS(e,t),e};Object.defineProperty(Xe,"__esModule",{value:!0});Xe.RemoteSdp=void 0;const PS=ES(ve),kS=he,Qs=Mr,pc=new kS.Logger("RemoteSdp");class xS{constructor({iceParameters:e,iceCandidates:r,dtlsParameters:n,sctpParameters:i,plainRtpParameters:s,planB:o=!1}){if(this._mediaSections=[],this._midToIndex=new Map,this._iceParameters=e,this._iceCandidates=r,this._dtlsParameters=n,this._sctpParameters=i,this._plainRtpParameters=s,this._planB=o,this._sdpObject={version:0,origin:{address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:1e4,sessionVersion:0,username:"mediasoup-client"},name:"-",timing:{start:0,stop:0},media:[]},e!=null&&e.iceLite&&(this._sdpObject.icelite="ice-lite"),n){this._sdpObject.msidSemantic={semantic:"WMS",token:"*"};const a=this._dtlsParameters.fingerprints.length;this._sdpObject.fingerprint={type:n.fingerprints[a-1].algorithm,hash:n.fingerprints[a-1].value},this._sdpObject.groups=[{type:"BUNDLE",mids:""}]}s&&(this._sdpObject.origin.address=s.ip,this._sdpObject.origin.ipVer=s.ipVersion)}updateIceParameters(e){pc.debug("updateIceParameters() [iceParameters:%o]",e),this._iceParameters=e,this._sdpObject.icelite=e.iceLite?"ice-lite":void 0;for(const r of this._mediaSections)r.setIceParameters(e)}updateDtlsRole(e){pc.debug("updateDtlsRole() [role:%s]",e),this._dtlsParameters.role=e;for(const r of this._mediaSections)r.setDtlsRole(e)}getNextMediaSectionIdx(){for(let e=0;e<this._mediaSections.length;++e){const r=this._mediaSections[e];if(r.closed)return{idx:e,reuseMid:r.mid}}return{idx:this._mediaSections.length}}send({offerMediaObject:e,reuseMid:r,offerRtpParameters:n,answerRtpParameters:i,codecOptions:s,extmapAllowMixed:o=!1}){const a=new Qs.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,offerMediaObject:e,offerRtpParameters:n,answerRtpParameters:i,codecOptions:s,extmapAllowMixed:o});r?this._replaceMediaSection(a,r):this._midToIndex.has(a.mid)?this._replaceMediaSection(a):this._addMediaSection(a)}receive({mid:e,kind:r,offerRtpParameters:n,streamId:i,trackId:s}){const o=this._midToIndex.get(e);let a;if(o!==void 0&&(a=this._mediaSections[o]),a)a.planBReceive({offerRtpParameters:n,streamId:i,trackId:s}),this._replaceMediaSection(a);else{a=new Qs.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,mid:e,kind:r,offerRtpParameters:n,streamId:i,trackId:s});const c=this._mediaSections.find(l=>l.closed);c?this._replaceMediaSection(a,c.mid):this._addMediaSection(a)}}pauseMediaSection(e){this._findMediaSection(e).pause()}resumeSendingMediaSection(e){this._findMediaSection(e).resume()}resumeReceivingMediaSection(e){this._findMediaSection(e).resume()}disableMediaSection(e){this._findMediaSection(e).disable()}closeMediaSection(e){const r=this._findMediaSection(e);return e===this._firstMid?(pc.debug("closeMediaSection() | cannot close first media section, disabling it instead [mid:%s]",e),this.disableMediaSection(e),!1):(r.close(),this._regenerateBundleMids(),!0)}muxMediaSectionSimulcast(e,r){const n=this._findMediaSection(e);n.muxSimulcastStreams(r),this._replaceMediaSection(n)}planBStopReceiving({mid:e,offerRtpParameters:r}){const n=this._findMediaSection(e);n.planBStopReceiving({offerRtpParameters:r}),this._replaceMediaSection(n)}sendSctpAssociation({offerMediaObject:e}){const r=new Qs.AnswerMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:e});this._addMediaSection(r)}receiveSctpAssociation({oldDataChannelSpec:e=!1}={}){const r=new Qs.OfferMediaSection({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,mid:"datachannel",kind:"application",oldDataChannelSpec:e});this._addMediaSection(r)}getSdp(){return this._sdpObject.origin.sessionVersion++,PS.write(this._sdpObject)}_addMediaSection(e){this._firstMid||(this._firstMid=e.mid),this._mediaSections.push(e),this._midToIndex.set(e.mid,this._mediaSections.length-1),this._sdpObject.media.push(e.getObject()),this._regenerateBundleMids()}_replaceMediaSection(e,r){if(typeof r=="string"){const n=this._midToIndex.get(r);if(n===void 0)throw new Error(`no media section found for reuseMid '${r}'`);const i=this._mediaSections[n];this._mediaSections[n]=e,this._midToIndex.delete(i.mid),this._midToIndex.set(e.mid,n),this._sdpObject.media[n]=e.getObject(),this._regenerateBundleMids()}else{const n=this._midToIndex.get(e.mid);if(n===void 0)throw new Error(`no media section found with mid '${e.mid}'`);this._mediaSections[n]=e,this._sdpObject.media[n]=e.getObject()}}_findMediaSection(e){const r=this._midToIndex.get(e);if(r===void 0)throw new Error(`no media section found with mid '${e}'`);return this._mediaSections[r]}_regenerateBundleMids(){this._dtlsParameters&&(this._sdpObject.groups[0].mids=this._mediaSections.filter(e=>!e.closed).map(e=>e.mid).join(" "))}}Xe.RemoteSdp=xS;var Kt={};Object.defineProperty(Kt,"__esModule",{value:!0});Kt.parse=MS;const LS=new RegExp("^[LS]([1-9]\\d{0,1})T([1-9]\\d{0,1})");function MS(t){const e=LS.exec(t??"");return e?{spatialLayers:Number(e[1]),temporalLayers:Number(e[2])}:{spatialLayers:1,temporalLayers:1}}var OS=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),IS=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ai=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&OS(e,t,r);return IS(e,t),e};Object.defineProperty(va,"__esModule",{value:!0});va.Chrome111=void 0;const fr=ai(ve),NS=he,xp=ai(we),fn=ai(ne),qs=ai(Be),Lp=ai(Ht),jS=ai(oi),AS=Ce,$S=ze,FS=Xe,BS=Kt,M=new NS.Logger("Chrome111"),zS="Chrome111",Mp={OS:1024,MIS:1024};class Ld extends $S.HandlerInterface{static createFactory(){return()=>new Ld}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return zS}close(){if(M.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){M.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const r=await e.createOffer();try{e.close()}catch{}const n=fr.parse(r.sdp),i=qs.extractRtpCapabilities({sdpObject:n});return jS.addNackSuppportForOpus(i),i}catch(r){try{e.close()}catch{}throw r}}async getNativeSctpCapabilities(){return M.debug("getNativeSctpCapabilities()"),{numStreams:Mp}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){this.assertNotClosed(),M.debug("run()"),this._direction=e,this._remoteSdp=new FS.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:fn.getSendingRtpParameters("audio",d),video:fn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:fn.getSendingRemoteRtpParameters("audio",d),video:fn.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):(M.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}))}async updateIceServers(e){this.assertNotClosed(),M.debug("updateIceServers()");const r=this._pc.getConfiguration();r.iceServers=e,this._pc.setConfiguration(r)}async restartIce(e){if(this.assertNotClosed(),M.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});M.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};M.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};M.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();M.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i,onRtpSender:s}){if(this.assertNotClosed(),this.assertSendDirection(),M.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),r&&r.length>1){let m=1;for(const y of r){const g=y.scalabilityMode?(0,BS.parse)(y.scalabilityMode).temporalLayers:3;g>m&&(m=g)}r.forEach((y,g)=>{y.rid=`r${g}`,y.scalabilityMode=`L1T${m}`})}const o=xp.clone(this._sendingRtpParametersByKind[e.kind]);o.codecs=fn.reduceCodecs(o.codecs,i);const a=xp.clone(this._sendingRemoteRtpParametersByKind[e.kind]);a.codecs=fn.reduceCodecs(a.codecs,i);const c=this._remoteSdp.getNextMediaSectionIdx(),l=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream],sendEncodings:r});s&&s(l.sender);const d=await this._pc.createOffer();let p=fr.parse(d.sdp);this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p}),M.debug("send() | calling pc.setLocalDescription() [offer:%o]",d),await this._pc.setLocalDescription(d);const u=l.mid;o.mid=u,p=fr.parse(this._pc.localDescription.sdp);const f=p.media[c.idx];if(o.rtcp.cname=qs.getCname({offerMediaObject:f}),!r)o.encodings=Lp.getRtpEncodings({offerMediaObject:f});else if(r.length===1){const m=Lp.getRtpEncodings({offerMediaObject:f});Object.assign(m[0],r[0]),o.encodings=m}else o.encodings=r;this._remoteSdp.send({offerMediaObject:f,reuseMid:c.reuseMid,offerRtpParameters:o,answerRtpParameters:a,codecOptions:n,extmapAllowMixed:!0});const h={type:"answer",sdp:this._remoteSdp.getSdp()};return M.debug("send() | calling pc.setRemoteDescription() [answer:%o]",h),await this._pc.setRemoteDescription(h),this._mapMidTransceiver.set(u,l),{localId:u,rtpParameters:o,rtpSender:l.sender}}async stopSending(e){if(this.assertSendDirection(),M.debug("stopSending() [localId:%s]",e),this._closed)return;const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch{}const i=await this._pc.createOffer();M.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const s={type:"answer",sdp:this._remoteSdp.getSdp()};M.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),M.debug("pauseSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="inactive",this._remoteSdp.pauseMediaSection(e);const n=await this._pc.createOffer();M.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};M.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),M.debug("resumeSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(this._remoteSdp.resumeSendingMediaSection(e),!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="sendonly";const n=await this._pc.createOffer();M.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};M.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(e,r){this.assertNotClosed(),this.assertSendDirection(),r?M.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):M.debug("replaceTrack() [localId:%s, no track]",e);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");await n.sender.replaceTrack(r)}async setMaxSpatialLayer(e,r){this.assertNotClosed(),this.assertSendDirection(),M.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{c<=r?a.active=!0:a.active=!1}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();M.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};M.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,r){this.assertNotClosed(),this.assertSendDirection(),M.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{i.encodings[c]={...a,...r}}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();M.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};M.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmits:n,protocol:s};M.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Mp.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=fr.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),M.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};M.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();const r=[],n=new Map;for(const a of e){const{trackId:c,kind:l,rtpParameters:d,streamId:p}=a;M.debug("receive() [trackId:%s, kind:%s]",c,l);const u=d.mid??String(this._mapMidTransceiver.size);n.set(c,u),this._remoteSdp.receive({mid:u,kind:l,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:c})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};M.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);for(const a of e){const{trackId:c,onRtpReceiver:l}=a;if(l){const d=n.get(c),p=this._pc.getTransceivers().find(u=>u.mid===d);if(!p)throw new Error("transceiver not found");l(p.receiver)}}let s=await this._pc.createAnswer();const o=fr.parse(s.sdp);for(const a of e){const{trackId:c,rtpParameters:l}=a,d=n.get(c),p=o.media.find(u=>String(u.mid)===d);qs.applyCodecParameters({offerRtpParameters:l,answerMediaObject:p})}s={type:"answer",sdp:fr.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),M.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const a of e){const{trackId:c}=a,l=n.get(c),d=this._pc.getTransceivers().find(p=>p.mid===l);if(d)this._mapMidTransceiver.set(l,d),r.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver});else throw new Error("new RTCRtpTransceiver not found")}return r}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(const i of e){M.debug("stopReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(s.mid)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};M.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();M.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n);for(const i of e)this._mapMidTransceiver.delete(i)}async pauseReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){M.debug("pauseReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};M.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();M.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async resumeReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){M.debug("resumeReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};M.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();M.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertNotClosed(),this.assertRecvDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a,protocol:n};M.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};M.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=fr.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u})}M.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=fr.parse(this._pc.localDescription.sdp));const n=qs.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new AS.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}va.Chrome111=Ld;var _a={},US=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),VS=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ci=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&US(e,t,r);return VS(e,t),e};Object.defineProperty(_a,"__esModule",{value:!0});_a.Chrome74=void 0;const xt=ci(ve),HS=he,Op=ci(we),hn=ci(ne),Gs=ci(Be),fc=ci(Ht),KS=ci(oi),WS=Ce,QS=ze,qS=Xe,GS=Kt,x=new HS.Logger("Chrome74"),YS="Chrome74",Ip={OS:1024,MIS:1024};class Md extends QS.HandlerInterface{static createFactory(){return()=>new Md}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return YS}close(){if(x.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){x.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const r=await e.createOffer();try{e.close()}catch{}const n=xt.parse(r.sdp),i=Gs.extractRtpCapabilities({sdpObject:n});return KS.addNackSuppportForOpus(i),i}catch(r){try{e.close()}catch{}throw r}}async getNativeSctpCapabilities(){return x.debug("getNativeSctpCapabilities()"),{numStreams:Ip}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){x.debug("run()"),this._direction=e,this._remoteSdp=new qS.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:hn.getSendingRtpParameters("audio",d),video:hn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:hn.getSendingRemoteRtpParameters("audio",d),video:hn.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):(x.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",()=>{switch(this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}))}async updateIceServers(e){this.assertNotClosed(),x.debug("updateIceServers()");const r=this._pc.getConfiguration();r.iceServers=e,this._pc.setConfiguration(r)}async restartIce(e){if(this.assertNotClosed(),x.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});x.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};x.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};x.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();x.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i}){this.assertNotClosed(),this.assertSendDirection(),x.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),r&&r.length>1&&r.forEach((y,g)=>{y.rid=`r${g}`});const s=Op.clone(this._sendingRtpParametersByKind[e.kind]);s.codecs=hn.reduceCodecs(s.codecs,i);const o=Op.clone(this._sendingRemoteRtpParametersByKind[e.kind]);o.codecs=hn.reduceCodecs(o.codecs,i);const a=this._remoteSdp.getNextMediaSectionIdx(),c=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream],sendEncodings:r});let l=await this._pc.createOffer(),d=xt.parse(l.sdp),p;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d});let u=!1;const f=(0,GS.parse)((r??[{}])[0].scalabilityMode);r&&r.length===1&&f.spatialLayers>1&&s.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(x.debug("send() | enabling legacy simulcast for VP9 SVC"),u=!0,d=xt.parse(l.sdp),p=d.media[a.idx],fc.addLegacySimulcast({offerMediaObject:p,numStreams:f.spatialLayers}),l={type:"offer",sdp:xt.write(d)}),x.debug("send() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l);const h=c.mid;if(s.mid=h,d=xt.parse(this._pc.localDescription.sdp),p=d.media[a.idx],s.rtcp.cname=Gs.getCname({offerMediaObject:p}),!r)s.encodings=fc.getRtpEncodings({offerMediaObject:p});else if(r.length===1){let y=fc.getRtpEncodings({offerMediaObject:p});Object.assign(y[0],r[0]),u&&(y=[y[0]]),s.encodings=y}else s.encodings=r;if(s.encodings.length>1&&(s.codecs[0].mimeType.toLowerCase()==="video/vp8"||s.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const y of s.encodings)y.scalabilityMode?y.scalabilityMode=`L1T${f.temporalLayers}`:y.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:p,reuseMid:a.reuseMid,offerRtpParameters:s,answerRtpParameters:o,codecOptions:n,extmapAllowMixed:!0});const m={type:"answer",sdp:this._remoteSdp.getSdp()};return x.debug("send() | calling pc.setRemoteDescription() [answer:%o]",m),await this._pc.setRemoteDescription(m),this._mapMidTransceiver.set(h,c),{localId:h,rtpParameters:s,rtpSender:c.sender}}async stopSending(e){if(this.assertSendDirection(),x.debug("stopSending() [localId:%s]",e),this._closed)return;const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch{}const i=await this._pc.createOffer();x.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const s={type:"answer",sdp:this._remoteSdp.getSdp()};x.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),x.debug("pauseSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="inactive",this._remoteSdp.pauseMediaSection(e);const n=await this._pc.createOffer();x.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};x.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),x.debug("resumeSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(this._remoteSdp.resumeSendingMediaSection(e),!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="sendonly";const n=await this._pc.createOffer();x.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};x.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(e,r){this.assertNotClosed(),this.assertSendDirection(),r?x.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):x.debug("replaceTrack() [localId:%s, no track]",e);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");await n.sender.replaceTrack(r)}async setMaxSpatialLayer(e,r){this.assertNotClosed(),this.assertSendDirection(),x.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{c<=r?a.active=!0:a.active=!1}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();x.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};x.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,r){this.assertNotClosed(),this.assertSendDirection(),x.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{i.encodings[c]={...a,...r}}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();x.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};x.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmits:n,protocol:s};x.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Ip.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=xt.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),x.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};x.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();const r=[],n=new Map;for(const a of e){const{trackId:c,kind:l,rtpParameters:d,streamId:p}=a;x.debug("receive() [trackId:%s, kind:%s]",c,l);const u=d.mid??String(this._mapMidTransceiver.size);n.set(c,u),this._remoteSdp.receive({mid:u,kind:l,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:c})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};x.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let s=await this._pc.createAnswer();const o=xt.parse(s.sdp);for(const a of e){const{trackId:c,rtpParameters:l}=a,d=n.get(c),p=o.media.find(u=>String(u.mid)===d);Gs.applyCodecParameters({offerRtpParameters:l,answerMediaObject:p})}s={type:"answer",sdp:xt.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),x.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const a of e){const{trackId:c}=a,l=n.get(c),d=this._pc.getTransceivers().find(p=>p.mid===l);if(d)this._mapMidTransceiver.set(l,d),r.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver});else throw new Error("new RTCRtpTransceiver not found")}return r}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(const i of e){x.debug("stopReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(s.mid)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};x.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();x.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n);for(const i of e)this._mapMidTransceiver.delete(i)}async pauseReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){x.debug("pauseReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};x.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();x.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async resumeReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){x.debug("resumeReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};x.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();x.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertNotClosed(),this.assertRecvDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a,protocol:n};x.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};x.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=xt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u})}x.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=xt.parse(this._pc.localDescription.sdp));const n=Gs.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new WS.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}_a.Chrome74=Md;var ya={},XS=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),JS=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),vs=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&XS(e,t,r);return JS(e,t),e};Object.defineProperty(ya,"__esModule",{value:!0});ya.Chrome70=void 0;const ot=vs(ve),ZS=he,Np=vs(we),mn=vs(ne),Ys=vs(Be),hc=vs(Ht),eR=ze,tR=Xe,rR=Kt,z=new ZS.Logger("Chrome70"),nR="Chrome70",jp={OS:1024,MIS:1024};class Od extends eR.HandlerInterface{static createFactory(){return()=>new Od}constructor(){super(),this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return nR}close(){if(z.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){z.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const r=await e.createOffer();try{e.close()}catch{}const n=ot.parse(r.sdp);return Ys.extractRtpCapabilities({sdpObject:n})}catch(r){try{e.close()}catch{}throw r}}async getNativeSctpCapabilities(){return z.debug("getNativeSctpCapabilities()"),{numStreams:jp}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){z.debug("run()"),this._direction=e,this._remoteSdp=new tR.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:mn.getSendingRtpParameters("audio",d),video:mn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:mn.getSendingRemoteRtpParameters("audio",d),video:mn.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(z.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(e){z.debug("updateIceServers()");const r=this._pc.getConfiguration();r.iceServers=e,this._pc.setConfiguration(r)}async restartIce(e){if(z.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});z.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();z.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i}){this.assertSendDirection(),z.debug("send() [kind:%s, track.id:%s]",e.kind,e.id);const s=Np.clone(this._sendingRtpParametersByKind[e.kind]);s.codecs=mn.reduceCodecs(s.codecs,i);const o=Np.clone(this._sendingRemoteRtpParametersByKind[e.kind]);o.codecs=mn.reduceCodecs(o.codecs,i);const a=this._remoteSdp.getNextMediaSectionIdx(),c=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream]});let l=await this._pc.createOffer(),d=ot.parse(l.sdp),p;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),r&&r.length>1&&(z.debug("send() | enabling legacy simulcast"),d=ot.parse(l.sdp),p=d.media[a.idx],hc.addLegacySimulcast({offerMediaObject:p,numStreams:r.length}),l={type:"offer",sdp:ot.write(d)});let u=!1;const f=(0,rR.parse)((r??[{}])[0].scalabilityMode);if(r&&r.length===1&&f.spatialLayers>1&&s.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(z.debug("send() | enabling legacy simulcast for VP9 SVC"),u=!0,d=ot.parse(l.sdp),p=d.media[a.idx],hc.addLegacySimulcast({offerMediaObject:p,numStreams:f.spatialLayers}),l={type:"offer",sdp:ot.write(d)}),z.debug("send() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),r){z.debug("send() | applying given encodings");const y=c.sender.getParameters();for(let g=0;g<(y.encodings??[]).length;++g){const v=y.encodings[g],_=r[g];if(!_)break;y.encodings[g]=Object.assign(v,_)}await c.sender.setParameters(y)}const h=c.mid;if(s.mid=h,d=ot.parse(this._pc.localDescription.sdp),p=d.media[a.idx],s.rtcp.cname=Ys.getCname({offerMediaObject:p}),s.encodings=hc.getRtpEncodings({offerMediaObject:p}),r)for(let y=0;y<s.encodings.length;++y)r[y]&&Object.assign(s.encodings[y],r[y]);if(u&&(s.encodings=[s.encodings[0]]),s.encodings.length>1&&(s.codecs[0].mimeType.toLowerCase()==="video/vp8"||s.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const y of s.encodings)y.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:p,reuseMid:a.reuseMid,offerRtpParameters:s,answerRtpParameters:o,codecOptions:n});const m={type:"answer",sdp:this._remoteSdp.getSdp()};return z.debug("send() | calling pc.setRemoteDescription() [answer:%o]",m),await this._pc.setRemoteDescription(m),this._mapMidTransceiver.set(h,c),{localId:h,rtpParameters:s,rtpSender:c.sender}}async stopSending(e){this.assertSendDirection(),z.debug("stopSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch{}const i=await this._pc.createOffer();z.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const s={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s),this._mapMidTransceiver.delete(e)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,r){this.assertSendDirection(),r?z.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):z.debug("replaceTrack() [localId:%s, no track]",e);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");await n.sender.replaceTrack(r)}async setMaxSpatialLayer(e,r){this.assertSendDirection(),z.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{c<=r?a.active=!0:a.active=!1}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();z.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,r){this.assertSendDirection(),z.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{i.encodings[c]={...a,...r}}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();z.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertSendDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:n,protocol:s};z.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%jp.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=ot.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),z.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};z.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertRecvDirection();const r=[],n=new Map;for(const a of e){const{trackId:c,kind:l,rtpParameters:d,streamId:p}=a;z.debug("receive() [trackId:%s, kind:%s]",c,l);const u=d.mid??String(this._mapMidTransceiver.size);n.set(c,u),this._remoteSdp.receive({mid:u,kind:l,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:c})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let s=await this._pc.createAnswer();const o=ot.parse(s.sdp);for(const a of e){const{trackId:c,rtpParameters:l}=a,d=n.get(c),p=o.media.find(u=>String(u.mid)===d);Ys.applyCodecParameters({offerRtpParameters:l,answerMediaObject:p})}s={type:"answer",sdp:ot.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),z.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const a of e){const{trackId:c}=a,l=n.get(c),d=this._pc.getTransceivers().find(p=>p.mid===l);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(l,d),r.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver})}return r}async stopReceiving(e){this.assertRecvDirection();for(const i of e){z.debug("stopReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(s.mid)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();z.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n);for(const i of e)this._mapMidTransceiver.delete(i)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){this.assertRecvDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmitTime:o,maxRetransmits:a,protocol:n};z.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};z.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=ot.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u})}z.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=ot.parse(this._pc.localDescription.sdp));const n=Ys.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}ya.Chrome70=Od;var wa={},rn={};Object.defineProperty(rn,"__esModule",{value:!0});rn.getRtpEncodings=iR;rn.addLegacySimulcast=sR;function iR({offerMediaObject:t,track:e}){const r=new Set;for(const s of t.ssrcs||[]){if(s.attribute!=="msid")continue;if(s.value.split(" ")[1]===e.id){const a=s.id;r.add(a)}}if(r.size===0)throw new Error(`a=ssrc line with msid information not found [track.id:${e.id}]`);const n=new Map;for(const s of t.ssrcGroups||[]){if(s.semantics!=="FID")continue;let[o,a]=s.ssrcs.split(/\s+/);o=Number(o),a=Number(a),r.has(o)&&(r.delete(o),r.delete(a),n.set(o,a))}for(const s of r)n.set(s,null);const i=[];for(const[s,o]of n){const a={ssrc:s};o&&(a.rtx={ssrc:o}),i.push(a)}return i}function sR({offerMediaObject:t,track:e,numStreams:r}){if(r<=1)throw new TypeError("numStreams must be greater than 1");let n,i,s;if(!(t.ssrcs||[]).find(p=>p.attribute!=="msid"?!1:p.value.split(" ")[1]===e.id?(n=p.id,s=p.value.split(" ")[0],!0):!1))throw new Error(`a=ssrc line with msid information not found [track.id:${e.id}]`);(t.ssrcGroups||[]).some(p=>{if(p.semantics!=="FID")return!1;const u=p.ssrcs.split(/\s+/);return Number(u[0])===n?(i=Number(u[1]),!0):!1});const a=t.ssrcs.find(p=>p.attribute==="cname"&&p.id===n);if(!a)throw new Error(`a=ssrc line with cname information not found [track.id:${e.id}]`);const c=a.value,l=[],d=[];for(let p=0;p<r;++p)l.push(n+p),i&&d.push(i+p);t.ssrcGroups=t.ssrcGroups||[],t.ssrcs=t.ssrcs||[],t.ssrcGroups.push({semantics:"SIM",ssrcs:l.join(" ")});for(const p of l)t.ssrcs.push({id:p,attribute:"cname",value:c}),t.ssrcs.push({id:p,attribute:"msid",value:`${s} ${e.id}`});for(let p=0;p<d.length;++p){const u=l[p],f=d[p];t.ssrcs.push({id:f,attribute:"cname",value:c}),t.ssrcs.push({id:f,attribute:"msid",value:`${s} ${e.id}`}),t.ssrcGroups.push({semantics:"FID",ssrcs:`${u} ${f}`})}}var oR=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),aR=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),_s=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&oR(e,t,r);return aR(e,t),e};Object.defineProperty(wa,"__esModule",{value:!0});wa.Chrome67=void 0;const Lt=_s(ve),cR=he,Ap=_s(we),gn=_s(ne),Xs=_s(Be),$p=_s(rn),lR=ze,dR=Xe,V=new cR.Logger("Chrome67"),uR="Chrome67",Fp={OS:1024,MIS:1024};class Id extends lR.HandlerInterface{static createFactory(){return()=>new Id}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdRtpSender=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return uR}close(){if(V.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){V.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const r=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch{}const n=Lt.parse(r.sdp);return Xs.extractRtpCapabilities({sdpObject:n})}catch(r){try{e.close()}catch{}throw r}}async getNativeSctpCapabilities(){return V.debug("getNativeSctpCapabilities()"),{numStreams:Fp}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){V.debug("run()"),this._direction=e,this._remoteSdp=new dR.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:gn.getSendingRtpParameters("audio",d),video:gn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:gn.getSendingRemoteRtpParameters("audio",d),video:gn.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(V.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(e){V.debug("updateIceServers()");const r=this._pc.getConfiguration();r.iceServers=e,this._pc.setConfiguration(r)}async restartIce(e){if(V.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});V.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();V.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i}){this.assertSendDirection(),V.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),i&&V.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addTrack(e,this._sendStream);let s=await this._pc.createOffer(),o=Lt.parse(s.sdp),a;const c=Ap.clone(this._sendingRtpParametersByKind[e.kind]);c.codecs=gn.reduceCodecs(c.codecs);const l=Ap.clone(this._sendingRemoteRtpParametersByKind[e.kind]);if(l.codecs=gn.reduceCodecs(l.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),e.kind==="video"&&r&&r.length>1&&(V.debug("send() | enabling simulcast"),o=Lt.parse(s.sdp),a=o.media.find(f=>f.type==="video"),$p.addLegacySimulcast({offerMediaObject:a,track:e,numStreams:r.length}),s={type:"offer",sdp:Lt.write(o)}),V.debug("send() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s),o=Lt.parse(this._pc.localDescription.sdp),a=o.media.find(f=>f.type===e.kind),c.rtcp.cname=Xs.getCname({offerMediaObject:a}),c.encodings=$p.getRtpEncodings({offerMediaObject:a,track:e}),r)for(let f=0;f<c.encodings.length;++f)r[f]&&Object.assign(c.encodings[f],r[f]);if(c.encodings.length>1&&c.codecs[0].mimeType.toLowerCase()==="video/vp8")for(const f of c.encodings)f.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:a,offerRtpParameters:c,answerRtpParameters:l,codecOptions:n});const d={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const p=String(this._nextSendLocalId);this._nextSendLocalId++;const u=this._pc.getSenders().find(f=>f.track===e);return this._mapSendLocalIdRtpSender.set(p,u),{localId:p,rtpParameters:c,rtpSender:u}}async stopSending(e){this.assertSendDirection(),V.debug("stopSending() [localId:%s]",e);const r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw new Error("associated RTCRtpSender not found");this._pc.removeTrack(r),r.track&&this._sendStream.removeTrack(r.track),this._mapSendLocalIdRtpSender.delete(e);const n=await this._pc.createOffer();V.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n);try{await this._pc.setLocalDescription(n)}catch(s){if(this._sendStream.getTracks().length===0){V.warn("stopSending() | ignoring expected error due no sending tracks: %s",s.toString());return}throw s}if(this._pc.signalingState==="stable")return;const i={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,r){this.assertSendDirection(),r?V.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):V.debug("replaceTrack() [localId:%s, no track]",e);const n=this._mapSendLocalIdRtpSender.get(e);if(!n)throw new Error("associated RTCRtpSender not found");const i=n.track;await n.replaceTrack(r),i&&this._sendStream.removeTrack(i),r&&this._sendStream.addTrack(r)}async setMaxSpatialLayer(e,r){this.assertSendDirection(),V.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._mapSendLocalIdRtpSender.get(e);if(!n)throw new Error("associated RTCRtpSender not found");const i=n.getParameters();i.encodings.forEach((s,o)=>{o<=r?s.active=!0:s.active=!1}),await n.setParameters(i)}async setRtpEncodingParameters(e,r){this.assertSendDirection(),V.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._mapSendLocalIdRtpSender.get(e);if(!n)throw new Error("associated RTCRtpSender not found");const i=n.getParameters();i.encodings.forEach((s,o)=>{i.encodings[o]={...s,...r}}),await n.setParameters(i)}async getSenderStats(e){this.assertSendDirection();const r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw new Error("associated RTCRtpSender not found");return r.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:n,protocol:s};V.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Fp.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=Lt.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),V.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};V.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertRecvDirection();const r=[];for(const o of e){const{trackId:a,kind:c,rtpParameters:l,streamId:d}=o;V.debug("receive() [trackId:%s, kind:%s]",a,c);const p=c;this._remoteSdp.receive({mid:p,kind:c,offerRtpParameters:l,streamId:d??l.rtcp.cname,trackId:a})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let i=await this._pc.createAnswer();const s=Lt.parse(i.sdp);for(const o of e){const{kind:a,rtpParameters:c}=o,l=a,d=s.media.find(p=>String(p.mid)===l);Xs.applyCodecParameters({offerRtpParameters:c,answerMediaObject:d})}i={type:"answer",sdp:Lt.write(s)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:s}),V.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const o of e){const{kind:a,trackId:c,rtpParameters:l}=o,d=c,p=a,u=this._pc.getReceivers().find(f=>f.track&&f.track.id===d);if(!u)throw new Error("new RTCRtpReceiver not");this._mapRecvLocalIdInfo.set(d,{mid:p,rtpParameters:l,rtpReceiver:u}),r.push({localId:d,track:u.track,rtpReceiver:u})}return r}async stopReceiving(e){this.assertRecvDirection();for(const i of e){V.debug("stopReceiving() [localId:%s]",i);const{mid:s,rtpParameters:o}=this._mapRecvLocalIdInfo.get(i)??{};this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:s,offerRtpParameters:o})}const r={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();V.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){this.assertRecvDirection();const{rtpReceiver:r}=this._mapRecvLocalIdInfo.get(e)??{};if(!r)throw new Error("associated RTCRtpReceiver not found");return r.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmitTime:o,maxRetransmits:a,protocol:n};V.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};V.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=Lt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u})}V.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=Lt.parse(this._pc.localDescription.sdp));const n=Xs.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}wa.Chrome67=Id;var Sa={},pR=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),fR=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ys=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&pR(e,t,r);return fR(e,t),e};Object.defineProperty(Sa,"__esModule",{value:!0});Sa.Chrome55=void 0;const Mt=ys(ve),hR=he,Ci=Ce,Bp=ys(we),vn=ys(ne),Js=ys(Be),zp=ys(rn),mR=ze,gR=Xe,G=new hR.Logger("Chrome55"),vR="Chrome55",Up={OS:1024,MIS:1024};class Nd extends mR.HandlerInterface{static createFactory(){return()=>new Nd}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdTrack=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return vR}close(){if(G.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){G.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const r=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch{}const n=Mt.parse(r.sdp);return Js.extractRtpCapabilities({sdpObject:n})}catch(r){try{e.close()}catch{}throw r}}async getNativeSctpCapabilities(){return G.debug("getNativeSctpCapabilities()"),{numStreams:Up}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){G.debug("run()"),this._direction=e,this._remoteSdp=new gR.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:vn.getSendingRtpParameters("audio",d),video:vn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:vn.getSendingRemoteRtpParameters("audio",d),video:vn.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(G.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(e){G.debug("updateIceServers()");const r=this._pc.getConfiguration();r.iceServers=e,this._pc.setConfiguration(r)}async restartIce(e){if(G.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});G.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};G.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};G.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();G.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i}){this.assertSendDirection(),G.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),i&&G.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addStream(this._sendStream);let s=await this._pc.createOffer(),o=Mt.parse(s.sdp),a;const c=Bp.clone(this._sendingRtpParametersByKind[e.kind]);c.codecs=vn.reduceCodecs(c.codecs);const l=Bp.clone(this._sendingRemoteRtpParametersByKind[e.kind]);if(l.codecs=vn.reduceCodecs(l.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),e.kind==="video"&&r&&r.length>1&&(G.debug("send() | enabling simulcast"),o=Mt.parse(s.sdp),a=o.media.find(u=>u.type==="video"),zp.addLegacySimulcast({offerMediaObject:a,track:e,numStreams:r.length}),s={type:"offer",sdp:Mt.write(o)}),G.debug("send() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s),o=Mt.parse(this._pc.localDescription.sdp),a=o.media.find(u=>u.type===e.kind),c.rtcp.cname=Js.getCname({offerMediaObject:a}),c.encodings=zp.getRtpEncodings({offerMediaObject:a,track:e}),r)for(let u=0;u<c.encodings.length;++u)r[u]&&Object.assign(c.encodings[u],r[u]);if(c.encodings.length>1&&c.codecs[0].mimeType.toLowerCase()==="video/vp8")for(const u of c.encodings)u.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:a,offerRtpParameters:c,answerRtpParameters:l,codecOptions:n});const d={type:"answer",sdp:this._remoteSdp.getSdp()};G.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const p=String(this._nextSendLocalId);return this._nextSendLocalId++,this._mapSendLocalIdTrack.set(p,e),{localId:p,rtpParameters:c}}async stopSending(e){this.assertSendDirection(),G.debug("stopSending() [localId:%s]",e);const r=this._mapSendLocalIdTrack.get(e);if(!r)throw new Error("track not found");this._mapSendLocalIdTrack.delete(e),this._sendStream.removeTrack(r),this._pc.addStream(this._sendStream);const n=await this._pc.createOffer();G.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n);try{await this._pc.setLocalDescription(n)}catch(s){if(this._sendStream.getTracks().length===0){G.warn("stopSending() | ignoring expected error due no sending tracks: %s",s.toString());return}throw s}if(this._pc.signalingState==="stable")return;const i={type:"answer",sdp:this._remoteSdp.getSdp()};G.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,r){throw new Ci.UnsupportedError("not implemented")}async setMaxSpatialLayer(e,r){throw new Ci.UnsupportedError(" not implemented")}async setRtpEncodingParameters(e,r){throw new Ci.UnsupportedError("not supported")}async getSenderStats(e){throw new Ci.UnsupportedError("not implemented")}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:n,protocol:s};G.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Up.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=Mt.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),G.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};G.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertRecvDirection();const r=[];for(const o of e){const{trackId:a,kind:c,rtpParameters:l,streamId:d}=o;G.debug("receive() [trackId:%s, kind:%s]",a,c);const p=c;this._remoteSdp.receive({mid:p,kind:c,offerRtpParameters:l,streamId:d??l.rtcp.cname,trackId:a})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};G.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let i=await this._pc.createAnswer();const s=Mt.parse(i.sdp);for(const o of e){const{kind:a,rtpParameters:c}=o,l=a,d=s.media.find(p=>String(p.mid)===l);Js.applyCodecParameters({offerRtpParameters:c,answerMediaObject:d})}i={type:"answer",sdp:Mt.write(s)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:s}),G.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const o of e){const{kind:a,trackId:c,rtpParameters:l}=o,d=a,p=c,u=o.streamId??l.rtcp.cname,h=this._pc.getRemoteStreams().find(m=>m.id===u).getTrackById(p);if(!h)throw new Error("remote track not found");this._mapRecvLocalIdInfo.set(p,{mid:d,rtpParameters:l}),r.push({localId:p,track:h})}return r}async stopReceiving(e){this.assertRecvDirection();for(const i of e){G.debug("stopReceiving() [localId:%s]",i);const{mid:s,rtpParameters:o}=this._mapRecvLocalIdInfo.get(i)??{};this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:s,offerRtpParameters:o})}const r={type:"offer",sdp:this._remoteSdp.getSdp()};G.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();G.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){throw new Ci.UnsupportedError("not implemented")}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmitTime:o,maxRetransmits:a,protocol:n};G.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};G.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=Mt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u})}G.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=Mt.parse(this._pc.localDescription.sdp));const n=Js.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Sa.Chrome55=Nd;var Ra={},_R=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),yR=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ws=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&_R(e,t,r);return yR(e,t),e};Object.defineProperty(Ra,"__esModule",{value:!0});Ra.Firefox120=void 0;const hr=ws(ve),wR=he,Vp=Ce,Hp=ws(we),_n=ws(ne),Zs=ws(Be),Kp=ws(Ht),SR=ze,RR=Xe,bR=Kt,O=new wR.Logger("Firefox120"),CR="Firefox120",Wp={OS:16,MIS:2048};class jd extends SR.HandlerInterface{static createFactory(){return()=>new jd}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return CR}close(){if(O.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){O.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),r=document.createElement("canvas");r.getContext("2d");const i=r.captureStream().getVideoTracks()[0];try{e.addTransceiver("audio",{direction:"sendrecv"}),e.addTransceiver(i,{direction:"sendrecv",sendEncodings:[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}]});const s=await e.createOffer();try{r.remove()}catch{}try{i.stop()}catch{}try{e.close()}catch{}const o=hr.parse(s.sdp);return Zs.extractRtpCapabilities({sdpObject:o})}catch(s){try{r.remove()}catch{}try{i.stop()}catch{}try{e.close()}catch{}throw s}}async getNativeSctpCapabilities(){return O.debug("getNativeSctpCapabilities()"),{numStreams:Wp}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){this.assertNotClosed(),O.debug("run()"),this._direction=e,this._remoteSdp=new RR.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:_n.getSendingRtpParameters("audio",d),video:_n.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:_n.getSendingRemoteRtpParameters("audio",d),video:_n.getSendingRemoteRtpParameters("video",d)},this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(O.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(e){throw this.assertNotClosed(),new Vp.UnsupportedError("not supported")}async restartIce(e){if(this.assertNotClosed(),O.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});O.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};O.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};O.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();O.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i,onRtpSender:s}){this.assertNotClosed(),this.assertSendDirection(),O.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),r&&r.length>1&&r.forEach((m,y)=>{m.rid=`r${y}`});const o=Hp.clone(this._sendingRtpParametersByKind[e.kind]);o.codecs=_n.reduceCodecs(o.codecs,i);const a=Hp.clone(this._sendingRemoteRtpParametersByKind[e.kind]);a.codecs=_n.reduceCodecs(a.codecs,i);const c=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream],sendEncodings:r});s&&s(c.sender);const l=await this._pc.createOffer();let d=hr.parse(l.sdp);this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:d});const p=(0,bR.parse)((r??[{}])[0].scalabilityMode);O.debug("send() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l);const u=c.mid;o.mid=u,d=hr.parse(this._pc.localDescription.sdp);const f=d.media[d.media.length-1];if(o.rtcp.cname=Zs.getCname({offerMediaObject:f}),!r)o.encodings=Kp.getRtpEncodings({offerMediaObject:f});else if(r.length===1){const m=Kp.getRtpEncodings({offerMediaObject:f});Object.assign(m[0],r[0]),o.encodings=m}else o.encodings=r;if(o.encodings.length>1&&(o.codecs[0].mimeType.toLowerCase()==="video/vp8"||o.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const m of o.encodings)m.scalabilityMode?m.scalabilityMode=`L1T${p.temporalLayers}`:m.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:f,offerRtpParameters:o,answerRtpParameters:a,codecOptions:n,extmapAllowMixed:!0});const h={type:"answer",sdp:this._remoteSdp.getSdp()};return O.debug("send() | calling pc.setRemoteDescription() [answer:%o]",h),await this._pc.setRemoteDescription(h),this._mapMidTransceiver.set(u,c),{localId:u,rtpParameters:o,rtpSender:c.sender}}async stopSending(e){if(this.assertSendDirection(),O.debug("stopSending() [localId:%s]",e),this._closed)return;const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated transceiver not found");r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.disableMediaSection(r.mid);const n=await this._pc.createOffer();O.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};O.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),O.debug("pauseSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="inactive",this._remoteSdp.pauseMediaSection(e);const n=await this._pc.createOffer();O.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};O.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),O.debug("resumeSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(e);const n=await this._pc.createOffer();O.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};O.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(e,r){this.assertNotClosed(),this.assertSendDirection(),r?O.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):O.debug("replaceTrack() [localId:%s, no track]",e);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");await n.sender.replaceTrack(r)}async setMaxSpatialLayer(e,r){this.assertNotClosed(),this.assertSendDirection(),O.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated transceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{c<=r?a.active=!0:a.active=!1}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();O.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};O.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,r){this.assertNotClosed(),this.assertSendDirection(),O.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{i.encodings[c]={...a,...r}}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();O.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};O.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmits:n,protocol:s};O.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Wp.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=hr.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:d}),O.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};O.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();const r=[],n=new Map;for(const a of e){const{trackId:c,kind:l,rtpParameters:d,streamId:p}=a;O.debug("receive() [trackId:%s, kind:%s]",c,l);const u=d.mid??String(this._mapMidTransceiver.size);n.set(c,u),this._remoteSdp.receive({mid:u,kind:l,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:c})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};O.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);for(const a of e){const{trackId:c,onRtpReceiver:l}=a;if(l){const d=n.get(c),p=this._pc.getTransceivers().find(u=>u.mid===d);if(!p)throw new Error("transceiver not found");l(p.receiver)}}let s=await this._pc.createAnswer();const o=hr.parse(s.sdp);for(const a of e){const{trackId:c,rtpParameters:l}=a,d=n.get(c),p=o.media.find(u=>String(u.mid)===d);Zs.applyCodecParameters({offerRtpParameters:l,answerMediaObject:p}),s={type:"answer",sdp:hr.write(o)}}this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:o}),O.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const a of e){const{trackId:c}=a,l=n.get(c),d=this._pc.getTransceivers().find(p=>p.mid===l);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(l,d),r.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver})}return r}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(const i of e){O.debug("stopReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(s.mid)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};O.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();O.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n);for(const i of e)this._mapMidTransceiver.delete(i)}async pauseReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){O.debug("pauseReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};O.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();O.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async resumeReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){O.debug("resumeReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};O.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();O.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertRecvDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a,protocol:n};O.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};O.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=hr.parse(p.sdp);await this.setupTransport({localDtlsRole:"client",localSdpObject:u})}O.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=hr.parse(this._pc.localDescription.sdp));const n=Zs.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new Vp.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Ra.Firefox120=jd;var ba={},TR=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),DR=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ss=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&TR(e,t,r);return DR(e,t),e};Object.defineProperty(ba,"__esModule",{value:!0});ba.Firefox60=void 0;const mr=Ss(ve),ER=he,Qp=Ce,mc=Ss(we),yn=Ss(ne),eo=Ss(Be),qp=Ss(Ht),PR=ze,kR=Xe,xR=Kt,I=new ER.Logger("Firefox60"),LR="Firefox60",Gp={OS:16,MIS:2048};class Ad extends PR.HandlerInterface{static createFactory(){return()=>new Ad}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return LR}close(){if(I.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){I.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),r=document.createElement("canvas");r.getContext("2d");const i=r.captureStream().getVideoTracks()[0];try{e.addTransceiver("audio",{direction:"sendrecv"});const s=e.addTransceiver(i,{direction:"sendrecv"}),o=s.sender.getParameters(),a=[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}];o.encodings=a,await s.sender.setParameters(o);const c=await e.createOffer();try{r.remove()}catch{}try{i.stop()}catch{}try{e.close()}catch{}const l=mr.parse(c.sdp);return eo.extractRtpCapabilities({sdpObject:l})}catch(s){try{r.remove()}catch{}try{i.stop()}catch{}try{e.close()}catch{}throw s}}async getNativeSctpCapabilities(){return I.debug("getNativeSctpCapabilities()"),{numStreams:Gp}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){this.assertNotClosed(),I.debug("run()"),this._direction=e,this._remoteSdp=new kR.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:yn.getSendingRtpParameters("audio",d),video:yn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:yn.getSendingRemoteRtpParameters("audio",d),video:yn.getSendingRemoteRtpParameters("video",d)},this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(I.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(e){throw this.assertNotClosed(),new Qp.UnsupportedError("not supported")}async restartIce(e){if(this.assertNotClosed(),I.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});I.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};I.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};I.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();I.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i}){this.assertNotClosed(),this.assertSendDirection(),I.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),r&&(r=mc.clone(r),r.forEach((h,m)=>{h.rid=`r${m}`}),r.reverse());const s=mc.clone(this._sendingRtpParametersByKind[e.kind]);s.codecs=yn.reduceCodecs(s.codecs,i);const o=mc.clone(this._sendingRemoteRtpParametersByKind[e.kind]);o.codecs=yn.reduceCodecs(o.codecs,i);const a=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream]});if(r){const h=a.sender.getParameters();h.encodings=r,await a.sender.setParameters(h)}const c=await this._pc.createOffer();let l=mr.parse(c.sdp);this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:l});const d=(0,xR.parse)((r??[{}])[0].scalabilityMode);I.debug("send() | calling pc.setLocalDescription() [offer:%o]",c),await this._pc.setLocalDescription(c);const p=a.mid;s.mid=p,l=mr.parse(this._pc.localDescription.sdp);const u=l.media[l.media.length-1];if(s.rtcp.cname=eo.getCname({offerMediaObject:u}),!r)s.encodings=qp.getRtpEncodings({offerMediaObject:u});else if(r.length===1){const h=qp.getRtpEncodings({offerMediaObject:u});Object.assign(h[0],r[0]),s.encodings=h}else s.encodings=r.reverse();if(s.encodings.length>1&&(s.codecs[0].mimeType.toLowerCase()==="video/vp8"||s.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const h of s.encodings)h.scalabilityMode?h.scalabilityMode=`L1T${d.temporalLayers}`:h.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:u,offerRtpParameters:s,answerRtpParameters:o,codecOptions:n,extmapAllowMixed:!0});const f={type:"answer",sdp:this._remoteSdp.getSdp()};return I.debug("send() | calling pc.setRemoteDescription() [answer:%o]",f),await this._pc.setRemoteDescription(f),this._mapMidTransceiver.set(p,a),{localId:p,rtpParameters:s,rtpSender:a.sender}}async stopSending(e){if(this.assertSendDirection(),I.debug("stopSending() [localId:%s]",e),this._closed)return;const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated transceiver not found");r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.disableMediaSection(r.mid);const n=await this._pc.createOffer();I.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};I.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),I.debug("pauseSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="inactive",this._remoteSdp.pauseMediaSection(e);const n=await this._pc.createOffer();I.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};I.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),I.debug("resumeSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(e);const n=await this._pc.createOffer();I.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};I.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(e,r){this.assertNotClosed(),this.assertSendDirection(),r?I.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):I.debug("replaceTrack() [localId:%s, no track]",e);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");await n.sender.replaceTrack(r)}async setMaxSpatialLayer(e,r){this.assertNotClosed(),this.assertSendDirection(),I.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated transceiver not found");const i=n.sender.getParameters();r=i.encodings.length-1-r,i.encodings.forEach((a,c)=>{c>=r?a.active=!0:a.active=!1}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();I.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};I.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,r){this.assertNotClosed(),this.assertSendDirection(),I.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{i.encodings[c]={...a,...r}}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();I.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};I.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmits:n,protocol:s};I.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Gp.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=mr.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:d}),I.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};I.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();const r=[],n=new Map;for(const a of e){const{trackId:c,kind:l,rtpParameters:d,streamId:p}=a;I.debug("receive() [trackId:%s, kind:%s]",c,l);const u=d.mid??String(this._mapMidTransceiver.size);n.set(c,u),this._remoteSdp.receive({mid:u,kind:l,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:c})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};I.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let s=await this._pc.createAnswer();const o=mr.parse(s.sdp);for(const a of e){const{trackId:c,rtpParameters:l}=a,d=n.get(c),p=o.media.find(u=>String(u.mid)===d);eo.applyCodecParameters({offerRtpParameters:l,answerMediaObject:p}),s={type:"answer",sdp:mr.write(o)}}this._transportReady||await this.setupTransport({localDtlsRole:"client",localSdpObject:o}),I.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const a of e){const{trackId:c}=a,l=n.get(c),d=this._pc.getTransceivers().find(p=>p.mid===l);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(l,d),r.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver})}return r}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(const i of e){I.debug("stopReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(s.mid)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};I.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();I.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n);for(const i of e)this._mapMidTransceiver.delete(i)}async pauseReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){I.debug("pauseReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};I.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();I.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async resumeReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){I.debug("resumeReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};I.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();I.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertRecvDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a,protocol:n};I.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};I.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=mr.parse(p.sdp);await this.setupTransport({localDtlsRole:"client",localSdpObject:u})}I.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=mr.parse(this._pc.localDescription.sdp));const n=eo.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new Qp.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}ba.Firefox60=Ad;var Ca={},MR=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),OR=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),li=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&MR(e,t,r);return OR(e,t),e};Object.defineProperty(Ca,"__esModule",{value:!0});Ca.Safari12=void 0;const Ot=li(ve),IR=he,Yp=li(we),wn=li(ne),to=li(Be),Xp=li(Ht),NR=li(oi),jR=Ce,AR=ze,$R=Xe,FR=Kt,L=new IR.Logger("Safari12"),BR="Safari12",Jp={OS:1024,MIS:1024};class $d extends AR.HandlerInterface{static createFactory(){return()=>new $d}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return BR}close(){if(L.debug("close()"),!this._closed){if(this._closed=!0,this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){L.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"});try{e.addTransceiver("audio"),e.addTransceiver("video");const r=await e.createOffer();try{e.close()}catch{}const n=Ot.parse(r.sdp),i=to.extractRtpCapabilities({sdpObject:n});return NR.addNackSuppportForOpus(i),i}catch(r){try{e.close()}catch{}throw r}}async getNativeSctpCapabilities(){return L.debug("getNativeSctpCapabilities()"),{numStreams:Jp}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){this.assertNotClosed(),L.debug("run()"),this._direction=e,this._remoteSdp=new $R.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:wn.getSendingRtpParameters("audio",d),video:wn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:wn.getSendingRemoteRtpParameters("audio",d),video:wn.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(L.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(e){this.assertNotClosed(),L.debug("updateIceServers()");const r=this._pc.getConfiguration();r.iceServers=e,this._pc.setConfiguration(r)}async restartIce(e){if(this.assertNotClosed(),L.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});L.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};L.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();L.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i,onRtpSender:s}){this.assertNotClosed(),this.assertSendDirection(),L.debug("send() [kind:%s, track.id:%s]",e.kind,e.id);const o=Yp.clone(this._sendingRtpParametersByKind[e.kind]);o.codecs=wn.reduceCodecs(o.codecs,i);const a=Yp.clone(this._sendingRemoteRtpParametersByKind[e.kind]);a.codecs=wn.reduceCodecs(a.codecs,i);const c=this._remoteSdp.getNextMediaSectionIdx(),l=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream]});s&&s(l.sender);let d=await this._pc.createOffer(),p=Ot.parse(d.sdp),u;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p});const f=(0,FR.parse)((r??[{}])[0].scalabilityMode);r&&r.length>1&&(L.debug("send() | enabling legacy simulcast"),p=Ot.parse(d.sdp),u=p.media[c.idx],Xp.addLegacySimulcast({offerMediaObject:u,numStreams:r.length}),d={type:"offer",sdp:Ot.write(p)}),L.debug("send() | calling pc.setLocalDescription() [offer:%o]",d),await this._pc.setLocalDescription(d);const h=l.mid;if(o.mid=h,p=Ot.parse(this._pc.localDescription.sdp),u=p.media[c.idx],o.rtcp.cname=to.getCname({offerMediaObject:u}),o.encodings=Xp.getRtpEncodings({offerMediaObject:u}),r)for(let y=0;y<o.encodings.length;++y)r[y]&&Object.assign(o.encodings[y],r[y]);if(o.encodings.length>1&&(o.codecs[0].mimeType.toLowerCase()==="video/vp8"||o.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const y of o.encodings)y.scalabilityMode?y.scalabilityMode=`L1T${f.temporalLayers}`:y.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:u,reuseMid:c.reuseMid,offerRtpParameters:o,answerRtpParameters:a,codecOptions:n});const m={type:"answer",sdp:this._remoteSdp.getSdp()};return L.debug("send() | calling pc.setRemoteDescription() [answer:%o]",m),await this._pc.setRemoteDescription(m),this._mapMidTransceiver.set(h,l),{localId:h,rtpParameters:o,rtpSender:l.sender}}async stopSending(e){if(this.assertSendDirection(),this._closed)return;L.debug("stopSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch{}const i=await this._pc.createOffer();L.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const s={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),L.debug("pauseSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="inactive",this._remoteSdp.pauseMediaSection(e);const n=await this._pc.createOffer();L.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),L.debug("resumeSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(e);const n=await this._pc.createOffer();L.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(e,r){this.assertNotClosed(),this.assertSendDirection(),r?L.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):L.debug("replaceTrack() [localId:%s, no track]",e);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");await n.sender.replaceTrack(r)}async setMaxSpatialLayer(e,r){this.assertNotClosed(),this.assertSendDirection(),L.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{c<=r?a.active=!0:a.active=!1}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();L.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,r){this.assertNotClosed(),this.assertSendDirection(),L.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{i.encodings[c]={...a,...r}}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();L.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmits:n,protocol:s};L.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Jp.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=Ot.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),L.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};L.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();const r=[],n=new Map;for(const a of e){const{trackId:c,kind:l,rtpParameters:d,streamId:p}=a;L.debug("receive() [trackId:%s, kind:%s]",c,l);const u=d.mid??String(this._mapMidTransceiver.size);n.set(c,u),this._remoteSdp.receive({mid:u,kind:l,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:c})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};L.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);for(const a of e){const{trackId:c,onRtpReceiver:l}=a;if(l){const d=n.get(c),p=this._pc.getTransceivers().find(u=>u.mid===d);if(!p)throw new Error("transceiver not found");l(p.receiver)}}let s=await this._pc.createAnswer();const o=Ot.parse(s.sdp);for(const a of e){const{trackId:c,rtpParameters:l}=a,d=n.get(c),p=o.media.find(u=>String(u.mid)===d);to.applyCodecParameters({offerRtpParameters:l,answerMediaObject:p})}s={type:"answer",sdp:Ot.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),L.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const a of e){const{trackId:c}=a,l=n.get(c),d=this._pc.getTransceivers().find(p=>p.mid===l);if(!d)throw new Error("new RTCRtpTransceiver not found");this._mapMidTransceiver.set(l,d),r.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver})}return r}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(const i of e){L.debug("stopReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(s.mid)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};L.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();L.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n);for(const i of e)this._mapMidTransceiver.delete(i)}async pauseReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){L.debug("pauseReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};L.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();L.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async resumeReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){L.debug("resumeReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};L.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();L.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertNotClosed(),this.assertRecvDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a,protocol:n};L.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};L.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=Ot.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u})}L.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=Ot.parse(this._pc.localDescription.sdp));const n=to.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new jR.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Ca.Safari12=$d;var Ta={},zR=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),UR=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Rs=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&zR(e,t,r);return UR(e,t),e};Object.defineProperty(Ta,"__esModule",{value:!0});Ta.Safari11=void 0;const It=Rs(ve),VR=he,Zp=Rs(we),Sn=Rs(ne),ro=Rs(Be),ef=Rs(rn),HR=ze,KR=Xe,K=new VR.Logger("Safari11"),WR="Safari11",tf={OS:1024,MIS:1024};class Fd extends HR.HandlerInterface{static createFactory(){return()=>new Fd}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdRtpSender=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return WR}close(){if(K.debug("close()"),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){K.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const r=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch{}const n=It.parse(r.sdp);return ro.extractRtpCapabilities({sdpObject:n})}catch(r){try{e.close()}catch{}throw r}}async getNativeSctpCapabilities(){return K.debug("getNativeSctpCapabilities()"),{numStreams:tf}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){K.debug("run()"),this._direction=e,this._remoteSdp=new KR.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:Sn.getSendingRtpParameters("audio",d),video:Sn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:Sn.getSendingRemoteRtpParameters("audio",d),video:Sn.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(K.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(e){K.debug("updateIceServers()");const r=this._pc.getConfiguration();r.iceServers=e,this._pc.setConfiguration(r)}async restartIce(e){if(K.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});K.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};K.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};K.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();K.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i}){this.assertSendDirection(),K.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),i&&K.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addTrack(e,this._sendStream);let s=await this._pc.createOffer(),o=It.parse(s.sdp),a;const c=Zp.clone(this._sendingRtpParametersByKind[e.kind]);c.codecs=Sn.reduceCodecs(c.codecs);const l=Zp.clone(this._sendingRemoteRtpParametersByKind[e.kind]);if(l.codecs=Sn.reduceCodecs(l.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),e.kind==="video"&&r&&r.length>1&&(K.debug("send() | enabling simulcast"),o=It.parse(s.sdp),a=o.media.find(f=>f.type==="video"),ef.addLegacySimulcast({offerMediaObject:a,track:e,numStreams:r.length}),s={type:"offer",sdp:It.write(o)}),K.debug("send() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s),o=It.parse(this._pc.localDescription.sdp),a=o.media.find(f=>f.type===e.kind),c.rtcp.cname=ro.getCname({offerMediaObject:a}),c.encodings=ef.getRtpEncodings({offerMediaObject:a,track:e}),r)for(let f=0;f<c.encodings.length;++f)r[f]&&Object.assign(c.encodings[f],r[f]);if(c.encodings.length>1&&c.codecs[0].mimeType.toLowerCase()==="video/vp8")for(const f of c.encodings)f.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:a,offerRtpParameters:c,answerRtpParameters:l,codecOptions:n});const d={type:"answer",sdp:this._remoteSdp.getSdp()};K.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const p=String(this._nextSendLocalId);this._nextSendLocalId++;const u=this._pc.getSenders().find(f=>f.track===e);return this._mapSendLocalIdRtpSender.set(p,u),{localId:p,rtpParameters:c,rtpSender:u}}async stopSending(e){this.assertSendDirection();const r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw new Error("associated RTCRtpSender not found");r.track&&this._sendStream.removeTrack(r.track),this._mapSendLocalIdRtpSender.delete(e);const n=await this._pc.createOffer();K.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n);try{await this._pc.setLocalDescription(n)}catch(s){if(this._sendStream.getTracks().length===0){K.warn("stopSending() | ignoring expected error due no sending tracks: %s",s.toString());return}throw s}if(this._pc.signalingState==="stable")return;const i={type:"answer",sdp:this._remoteSdp.getSdp()};K.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,r){this.assertSendDirection(),r?K.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):K.debug("replaceTrack() [localId:%s, no track]",e);const n=this._mapSendLocalIdRtpSender.get(e);if(!n)throw new Error("associated RTCRtpSender not found");const i=n.track;await n.replaceTrack(r),i&&this._sendStream.removeTrack(i),r&&this._sendStream.addTrack(r)}async setMaxSpatialLayer(e,r){this.assertSendDirection(),K.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._mapSendLocalIdRtpSender.get(e);if(!n)throw new Error("associated RTCRtpSender not found");const i=n.getParameters();i.encodings.forEach((s,o)=>{o<=r?s.active=!0:s.active=!1}),await n.setParameters(i)}async setRtpEncodingParameters(e,r){this.assertSendDirection(),K.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._mapSendLocalIdRtpSender.get(e);if(!n)throw new Error("associated RTCRtpSender not found");const i=n.getParameters();i.encodings.forEach((s,o)=>{i.encodings[o]={...s,...r}}),await n.setParameters(i)}async getSenderStats(e){this.assertSendDirection();const r=this._mapSendLocalIdRtpSender.get(e);if(!r)throw new Error("associated RTCRtpSender not found");return r.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmits:n,protocol:s};K.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%tf.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=It.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),K.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};K.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertRecvDirection();const r=[];for(const o of e){const{trackId:a,kind:c,rtpParameters:l,streamId:d}=o;K.debug("receive() [trackId:%s, kind:%s]",a,c);const p=c;this._remoteSdp.receive({mid:p,kind:c,offerRtpParameters:l,streamId:d??l.rtcp.cname,trackId:a})}const n={type:"offer",sdp:this._remoteSdp.getSdp()};K.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",n),await this._pc.setRemoteDescription(n);let i=await this._pc.createAnswer();const s=It.parse(i.sdp);for(const o of e){const{kind:a,rtpParameters:c}=o,l=a,d=s.media.find(p=>String(p.mid)===l);ro.applyCodecParameters({offerRtpParameters:c,answerMediaObject:d})}i={type:"answer",sdp:It.write(s)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:s}),K.debug("receive() | calling pc.setLocalDescription() [answer:%o]",i),await this._pc.setLocalDescription(i);for(const o of e){const{kind:a,trackId:c,rtpParameters:l}=o,d=a,p=c,u=this._pc.getReceivers().find(f=>f.track&&f.track.id===p);if(!u)throw new Error("new RTCRtpReceiver not");this._mapRecvLocalIdInfo.set(p,{mid:d,rtpParameters:l,rtpReceiver:u}),r.push({localId:p,track:u.track,rtpReceiver:u})}return r}async stopReceiving(e){this.assertRecvDirection();for(const i of e){K.debug("stopReceiving() [localId:%s]",i);const{mid:s,rtpParameters:o}=this._mapRecvLocalIdInfo.get(i)??{};this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:s,offerRtpParameters:o})}const r={type:"offer",sdp:this._remoteSdp.getSdp()};K.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();K.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertRecvDirection();const{rtpReceiver:r}=this._mapRecvLocalIdInfo.get(e)??{};if(!r)throw new Error("associated RTCRtpReceiver not found");return r.getStats()}async pauseReceiving(e){}async resumeReceiving(e){}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a,protocol:n};K.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};K.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=It.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u})}K.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=It.parse(this._pc.localDescription.sdp));const n=ro.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Ta.Safari11=Fd;var Da={},Ea={},QR=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),qR=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),GR=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&QR(e,t,r);return qR(e,t),e};Object.defineProperty(Ea,"__esModule",{value:!0});Ea.getCapabilities=YR;Ea.mangleRtpParameters=XR;const ng=GR(we);function YR(){const t=RTCRtpReceiver.getCapabilities(),e=ng.clone(t);for(const r of e.codecs??[]){if(r.channels=r.numChannels,delete r.numChannels,r.mimeType=r.mimeType??`${r.kind}/${r.name}`,r.parameters){const n=r.parameters;n.apt&&(n.apt=Number(n.apt)),n["packetization-mode"]&&(n["packetization-mode"]=Number(n["packetization-mode"]))}for(const n of r.rtcpFeedback??[])n.parameter||(n.parameter="")}return e}function XR(t){const e=ng.clone(t);e.mid&&(e.muxId=e.mid,delete e.mid);for(const r of e.codecs)r.channels&&(r.numChannels=r.channels,delete r.channels),r.mimeType&&!r.name&&(r.name=r.mimeType.split("/")[1]),delete r.mimeType;return e}var JR=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),ZR=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Bd=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&JR(e,t,r);return ZR(e,t),e};Object.defineProperty(Da,"__esModule",{value:!0});Da.Edge11=void 0;const e0=he,gc=Ce,no=Bd(we),vc=Bd(ne),_c=Bd(Ea),t0=ze,J=new e0.Logger("Edge11"),r0="Edge11";class zd extends t0.HandlerInterface{static createFactory(){return()=>new zd}constructor(){super(),this._rtpSenders=new Map,this._rtpReceivers=new Map,this._nextSendLocalId=0,this._transportReady=!1}get name(){return r0}close(){J.debug("close()");try{this._iceGatherer.close()}catch{}try{this._iceTransport.stop()}catch{}try{this._dtlsTransport.stop()}catch{}for(const e of this._rtpSenders.values())try{e.stop()}catch{}for(const e of this._rtpReceivers.values())try{e.stop()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){return J.debug("getNativeRtpCapabilities()"),_c.getCapabilities()}async getNativeSctpCapabilities(){return J.debug("getNativeSctpCapabilities()"),{numStreams:{OS:0,MIS:0}}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){J.debug("run()"),this._sendingRtpParametersByKind={audio:vc.getSendingRtpParameters("audio",d),video:vc.getSendingRtpParameters("video",d)},this._remoteIceParameters=r,this._remoteIceCandidates=n,this._remoteDtlsParameters=i,this._cname=`CNAME-${no.generateRandomNumber()}`,this.setIceGatherer({iceServers:o,iceTransportPolicy:a}),this.setIceTransport(),this.setDtlsTransport()}async updateIceServers(e){throw new gc.UnsupportedError("not supported")}async restartIce(e){if(J.debug("restartIce()"),this._remoteIceParameters=e,!!this._transportReady){J.debug("restartIce() | calling iceTransport.start()"),this._iceTransport.start(this._iceGatherer,e,"controlling");for(const r of this._remoteIceCandidates)this._iceTransport.addRemoteCandidate(r);this._iceTransport.addRemoteCandidate({})}}async getTransportStats(){return this._iceTransport.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i}){J.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),this._transportReady||await this.setupTransport({localDtlsRole:"server"}),J.debug("send() | calling new RTCRtpSender()");const s=new RTCRtpSender(e,this._dtlsTransport),o=no.clone(this._sendingRtpParametersByKind[e.kind]);o.codecs=vc.reduceCodecs(o.codecs,i);const a=o.codecs.some(d=>/.+\/rtx$/i.test(d.mimeType));r||(r=[{}]);for(const d of r)d.ssrc=no.generateRandomNumber(),a&&(d.rtx={ssrc:no.generateRandomNumber()});o.encodings=r,o.rtcp={cname:this._cname,reducedSize:!0,mux:!0};const c=_c.mangleRtpParameters(o);J.debug("send() | calling rtpSender.send() [params:%o]",c),await s.send(c);const l=String(this._nextSendLocalId);return this._nextSendLocalId++,this._rtpSenders.set(l,s),{localId:l,rtpParameters:o,rtpSender:s}}async stopSending(e){J.debug("stopSending() [localId:%s]",e);const r=this._rtpSenders.get(e);if(!r)throw new Error("RTCRtpSender not found");this._rtpSenders.delete(e);try{J.debug("stopSending() | calling rtpSender.stop()"),r.stop()}catch(n){throw J.warn("stopSending() | rtpSender.stop() failed:%o",n),n}}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,r){r?J.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):J.debug("replaceTrack() [localId:%s, no track]",e);const n=this._rtpSenders.get(e);if(!n)throw new Error("RTCRtpSender not found");n.setTrack(r)}async setMaxSpatialLayer(e,r){J.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._rtpSenders.get(e);if(!n)throw new Error("RTCRtpSender not found");const i=n.getParameters();i.encodings.forEach((s,o)=>{o<=r?s.active=!0:s.active=!1}),await n.setParameters(i)}async setRtpEncodingParameters(e,r){J.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._rtpSenders.get(e);if(!n)throw new Error("RTCRtpSender not found");const i=n.getParameters();i.encodings.forEach((s,o)=>{i.encodings[o]={...s,...r}}),await n.setParameters(i)}async getSenderStats(e){const r=this._rtpSenders.get(e);if(!r)throw new Error("RTCRtpSender not found");return r.getStats()}async sendDataChannel(e){throw new gc.UnsupportedError("not implemented")}async receive(e){const r=[];for(const n of e){const{trackId:i,kind:s}=n;J.debug("receive() [trackId:%s, kind:%s]",i,s)}this._transportReady||await this.setupTransport({localDtlsRole:"server"});for(const n of e){const{trackId:i,kind:s,rtpParameters:o}=n;J.debug("receive() | calling new RTCRtpReceiver()");const a=new RTCRtpReceiver(this._dtlsTransport,s);a.addEventListener("error",d=>{J.error('rtpReceiver "error" event [event:%o]',d)});const c=_c.mangleRtpParameters(o);J.debug("receive() | calling rtpReceiver.receive() [params:%o]",c),await a.receive(c);const l=i;this._rtpReceivers.set(l,a),r.push({localId:l,track:a.track,rtpReceiver:a})}return r}async stopReceiving(e){for(const r of e){J.debug("stopReceiving() [localId:%s]",r);const n=this._rtpReceivers.get(r);if(!n)throw new Error("RTCRtpReceiver not found");this._rtpReceivers.delete(r);try{J.debug("stopReceiving() | calling rtpReceiver.stop()"),n.stop()}catch(i){J.warn("stopReceiving() | rtpReceiver.stop() failed:%o",i)}}}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){const r=this._rtpReceivers.get(e);if(!r)throw new Error("RTCRtpReceiver not found");return r.getStats()}async receiveDataChannel(e){throw new gc.UnsupportedError("not implemented")}setIceGatherer({iceServers:e,iceTransportPolicy:r}){const n=new RTCIceGatherer({iceServers:e??[],gatherPolicy:r??"all"});n.addEventListener("error",i=>{J.error('iceGatherer "error" event [event:%o]',i)});try{n.gather()}catch(i){J.debug("setIceGatherer() | iceGatherer.gather() failed: %s",i.toString())}this._iceGatherer=n}setIceTransport(){const e=new RTCIceTransport(this._iceGatherer);e.addEventListener("statechange",()=>{switch(e.state){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),e.addEventListener("icestatechange",()=>{switch(e.state){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}}),e.addEventListener("candidatepairchange",r=>{J.debug('iceTransport "candidatepairchange" event [pair:%o]',r.pair)}),this._iceTransport=e}setDtlsTransport(){const e=new RTCDtlsTransport(this._iceTransport);e.addEventListener("statechange",()=>{J.debug('dtlsTransport "statechange" event [state:%s]',e.state)}),e.addEventListener("dtlsstatechange",()=>{J.debug('dtlsTransport "dtlsstatechange" event [state:%s]',e.state),e.state==="closed"&&this.emit("@connectionstatechange","closed")}),e.addEventListener("error",r=>{J.error('dtlsTransport "error" event [event:%o]',r)}),this._dtlsTransport=e}async setupTransport({localDtlsRole:e}){J.debug("setupTransport()");const r=this._dtlsTransport.getLocalParameters();r.role=e,await new Promise((n,i)=>{this.safeEmit("@connect",{dtlsParameters:r},n,i)}),this._iceTransport.start(this._iceGatherer,this._remoteIceParameters,"controlling");for(const n of this._remoteIceCandidates)this._iceTransport.addRemoteCandidate(n);this._iceTransport.addRemoteCandidate({}),this._remoteDtlsParameters.fingerprints=this._remoteDtlsParameters.fingerprints.filter(n=>n.algorithm==="sha-256"||n.algorithm==="sha-384"||n.algorithm==="sha-512"),this._dtlsTransport.start(this._remoteDtlsParameters),this._transportReady=!0}}Da.Edge11=zd;var Pa={},n0=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),i0=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),di=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&n0(e,t,r);return i0(e,t),e};Object.defineProperty(Pa,"__esModule",{value:!0});Pa.ReactNativeUnifiedPlan=void 0;const Nt=di(ve),s0=he,rf=di(we),Rn=di(ne),io=di(Be),yc=di(Ht),o0=di(oi),a0=Ce,c0=ze,l0=Xe,d0=Kt,k=new s0.Logger("ReactNativeUnifiedPlan"),u0="ReactNativeUnifiedPlan",nf={OS:1024,MIS:1024};class Ud extends c0.HandlerInterface{static createFactory(){return()=>new Ud}constructor(){super(),this._closed=!1,this._mapMidTransceiver=new Map,this._sendStream=new MediaStream,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return u0}close(){if(k.debug("close()"),!this._closed){if(this._closed=!0,this._sendStream.release(!1),this._pc)try{this._pc.close()}catch{}this.emit("@close")}}async getNativeRtpCapabilities(){k.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"});try{e.addTransceiver("audio"),e.addTransceiver("video");const r=await e.createOffer();try{e.close()}catch{}const n=Nt.parse(r.sdp),i=io.extractRtpCapabilities({sdpObject:n});return o0.addNackSuppportForOpus(i),i}catch(r){try{e.close()}catch{}throw r}}async getNativeSctpCapabilities(){return k.debug("getNativeSctpCapabilities()"),{numStreams:nf}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){this.assertNotClosed(),k.debug("run()"),this._direction=e,this._remoteSdp=new l0.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s}),this._sendingRtpParametersByKind={audio:Rn.getSendingRtpParameters("audio",d),video:Rn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:Rn.getSendingRemoteRtpParameters("audio",d),video:Rn.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(k.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(e){this.assertNotClosed(),k.debug("updateIceServers()");const r=this._pc.getConfiguration();r.iceServers=e,this._pc.setConfiguration(r)}async restartIce(e){if(this.assertNotClosed(),k.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});k.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};k.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};k.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();k.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this.assertNotClosed(),this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i,onRtpSender:s}){this.assertNotClosed(),this.assertSendDirection(),k.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),r&&r.length>1&&r.forEach((g,v)=>{g.rid=`r${v}`});const o=rf.clone(this._sendingRtpParametersByKind[e.kind]);o.codecs=Rn.reduceCodecs(o.codecs,i);const a=rf.clone(this._sendingRemoteRtpParametersByKind[e.kind]);a.codecs=Rn.reduceCodecs(a.codecs,i);const c=this._remoteSdp.getNextMediaSectionIdx(),l=this._pc.addTransceiver(e,{direction:"sendonly",streams:[this._sendStream],sendEncodings:r});s&&s(l.sender);let d=await this._pc.createOffer(),p=Nt.parse(d.sdp),u;this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:p});let f=!1;const h=(0,d0.parse)((r??[{}])[0].scalabilityMode);r&&r.length===1&&h.spatialLayers>1&&o.codecs[0].mimeType.toLowerCase()==="video/vp9"&&(k.debug("send() | enabling legacy simulcast for VP9 SVC"),f=!0,p=Nt.parse(d.sdp),u=p.media[c.idx],yc.addLegacySimulcast({offerMediaObject:u,numStreams:h.spatialLayers}),d={type:"offer",sdp:Nt.write(p)}),k.debug("send() | calling pc.setLocalDescription() [offer:%o]",d),await this._pc.setLocalDescription(d);let m=l.mid??void 0;if(m||k.warn("send() | missing transceiver.mid (bug in react-native-webrtc, using a workaround"),o.mid=m,p=Nt.parse(this._pc.localDescription.sdp),u=p.media[c.idx],o.rtcp.cname=io.getCname({offerMediaObject:u}),!r)o.encodings=yc.getRtpEncodings({offerMediaObject:u});else if(r.length===1){let g=yc.getRtpEncodings({offerMediaObject:u});Object.assign(g[0],r[0]),f&&(g=[g[0]]),o.encodings=g}else o.encodings=r;if(o.encodings.length>1&&(o.codecs[0].mimeType.toLowerCase()==="video/vp8"||o.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const g of o.encodings)g.scalabilityMode?g.scalabilityMode=`L1T${h.temporalLayers}`:g.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:u,reuseMid:c.reuseMid,offerRtpParameters:o,answerRtpParameters:a,codecOptions:n,extmapAllowMixed:!0});const y={type:"answer",sdp:this._remoteSdp.getSdp()};return k.debug("send() | calling pc.setRemoteDescription() [answer:%o]",y),await this._pc.setRemoteDescription(y),m||(m=l.mid,o.mid=m),this._mapMidTransceiver.set(m,l),{localId:m,rtpParameters:o,rtpSender:l.sender}}async stopSending(e){if(this.assertSendDirection(),this._closed)return;k.debug("stopSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");if(r.sender.replaceTrack(null),this._pc.removeTrack(r.sender),this._remoteSdp.closeMediaSection(r.mid))try{r.stop()}catch{}const i=await this._pc.createOffer();k.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",i),await this._pc.setLocalDescription(i);const s={type:"answer",sdp:this._remoteSdp.getSdp()};k.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",s),await this._pc.setRemoteDescription(s),this._mapMidTransceiver.delete(e)}async pauseSending(e){this.assertNotClosed(),this.assertSendDirection(),k.debug("pauseSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="inactive",this._remoteSdp.pauseMediaSection(e);const n=await this._pc.createOffer();k.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};k.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async resumeSending(e){this.assertNotClosed(),this.assertSendDirection(),k.debug("resumeSending() [localId:%s]",e);const r=this._mapMidTransceiver.get(e);if(this._remoteSdp.resumeSendingMediaSection(e),!r)throw new Error("associated RTCRtpTransceiver not found");r.direction="sendonly";const n=await this._pc.createOffer();k.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",n),await this._pc.setLocalDescription(n);const i={type:"answer",sdp:this._remoteSdp.getSdp()};k.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async replaceTrack(e,r){this.assertNotClosed(),this.assertSendDirection(),r?k.debug("replaceTrack() [localId:%s, track.id:%s]",e,r.id):k.debug("replaceTrack() [localId:%s, no track]",e);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");await n.sender.replaceTrack(r)}async setMaxSpatialLayer(e,r){this.assertNotClosed(),this.assertSendDirection(),k.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{c<=r?a.active=!0:a.active=!1}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();k.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};k.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async setRtpEncodingParameters(e,r){this.assertNotClosed(),this.assertSendDirection(),k.debug("setRtpEncodingParameters() [localId:%s, params:%o]",e,r);const n=this._mapMidTransceiver.get(e);if(!n)throw new Error("associated RTCRtpTransceiver not found");const i=n.sender.getParameters();i.encodings.forEach((a,c)=>{i.encodings[c]={...a,...r}}),await n.sender.setParameters(i),this._remoteSdp.muxMediaSectionSimulcast(e,i.encodings);const s=await this._pc.createOffer();k.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s);const o={type:"answer",sdp:this._remoteSdp.getSdp()};k.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),await this._pc.setRemoteDescription(o)}async getSenderStats(e){this.assertNotClosed(),this.assertSendDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.sender.getStats()}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertNotClosed(),this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmits:n,protocol:s};k.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%nf.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=Nt.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),k.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};k.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertNotClosed(),this.assertRecvDirection();const r=[],n=new Map;for(const a of e){const{trackId:c,kind:l,rtpParameters:d,streamId:p}=a;k.debug("receive() [trackId:%s, kind:%s]",c,l);const u=d.mid??String(this._mapMidTransceiver.size);n.set(c,u),this._remoteSdp.receive({mid:u,kind:l,offerRtpParameters:d,streamId:p??d.rtcp.cname,trackId:c})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};k.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);for(const a of e){const{trackId:c,onRtpReceiver:l}=a;if(l){const d=n.get(c),p=this._pc.getTransceivers().find(u=>u.mid===d);if(!p)throw new Error("transceiver not found");l(p.receiver)}}let s=await this._pc.createAnswer();const o=Nt.parse(s.sdp);for(const a of e){const{trackId:c,rtpParameters:l}=a,d=n.get(c),p=o.media.find(u=>String(u.mid)===d);io.applyCodecParameters({offerRtpParameters:l,answerMediaObject:p})}s={type:"answer",sdp:Nt.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),k.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const a of e){const{trackId:c}=a,l=n.get(c),d=this._pc.getTransceivers().find(p=>p.mid===l);if(d)this._mapMidTransceiver.set(l,d),r.push({localId:l,track:d.receiver.track,rtpReceiver:d.receiver});else throw new Error("new RTCRtpTransceiver not found")}return r}async stopReceiving(e){if(this.assertRecvDirection(),this._closed)return;for(const i of e){k.debug("stopReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");this._remoteSdp.closeMediaSection(s.mid)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};k.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();k.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n);for(const i of e)this._mapMidTransceiver.delete(i)}async pauseReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){k.debug("pauseReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="inactive",this._remoteSdp.pauseMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};k.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();k.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async resumeReceiving(e){this.assertNotClosed(),this.assertRecvDirection();for(const i of e){k.debug("resumeReceiving() [localId:%s]",i);const s=this._mapMidTransceiver.get(i);if(!s)throw new Error("associated RTCRtpTransceiver not found");s.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(i)}const r={type:"offer",sdp:this._remoteSdp.getSdp()};k.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();k.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async getReceiverStats(e){this.assertNotClosed(),this.assertRecvDirection();const r=this._mapMidTransceiver.get(e);if(!r)throw new Error("associated RTCRtpTransceiver not found");return r.receiver.getStats()}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertNotClosed(),this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a,protocol:n};k.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation();const d={type:"offer",sdp:this._remoteSdp.getSdp()};k.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=Nt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u})}k.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=Nt.parse(this._pc.localDescription.sdp));const n=io.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertNotClosed(){if(this._closed)throw new a0.InvalidStateError("method called in a closed handler")}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}Pa.ReactNativeUnifiedPlan=Ud;var ka={},p0=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),f0=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),bs=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&p0(e,t,r);return f0(e,t),e};Object.defineProperty(ka,"__esModule",{value:!0});ka.ReactNative=void 0;const jt=bs(ve),h0=he,Ti=Ce,wc=bs(we),bn=bs(ne),so=bs(Be),sf=bs(rn),m0=ze,g0=Xe,Q=new h0.Logger("ReactNative"),v0="ReactNative",of={OS:1024,MIS:1024};class Vd extends m0.HandlerInterface{static createFactory(){return()=>new Vd}constructor(){super(),this._sendStream=new MediaStream,this._mapSendLocalIdTrack=new Map,this._nextSendLocalId=0,this._mapRecvLocalIdInfo=new Map,this._hasDataChannelMediaSection=!1,this._nextSendSctpStreamId=0,this._transportReady=!1}get name(){return v0}close(){if(Q.debug("close()"),this._sendStream.release(!1),this._pc)try{this._pc.close()}catch{}this.emit("@close")}async getNativeRtpCapabilities(){Q.debug("getNativeRtpCapabilities()");const e=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"});try{const r=await e.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});try{e.close()}catch{}const n=jt.parse(r.sdp);return so.extractRtpCapabilities({sdpObject:n})}catch(r){try{e.close()}catch{}throw r}}async getNativeSctpCapabilities(){return Q.debug("getNativeSctpCapabilities()"),{numStreams:of}}run({direction:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,extendedRtpCapabilities:d}){Q.debug("run()"),this._direction=e,this._remoteSdp=new g0.RemoteSdp({iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,planB:!0}),this._sendingRtpParametersByKind={audio:bn.getSendingRtpParameters("audio",d),video:bn.getSendingRtpParameters("video",d)},this._sendingRemoteRtpParametersByKind={audio:bn.getSendingRemoteRtpParameters("audio",d),video:bn.getSendingRemoteRtpParameters("video",d)},i.role&&i.role!=="auto"&&(this._forcedLocalDtlsRole=i.role==="server"?"client":"server"),this._pc=new RTCPeerConnection({iceServers:o??[],iceTransportPolicy:a??"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b",...c},l),this._pc.addEventListener("icegatheringstatechange",()=>{this.emit("@icegatheringstatechange",this._pc.iceGatheringState)}),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",()=>{this.emit("@connectionstatechange",this._pc.connectionState)}):this._pc.addEventListener("iceconnectionstatechange",()=>{switch(Q.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.iceConnectionState){case"checking":{this.emit("@connectionstatechange","connecting");break}case"connected":case"completed":{this.emit("@connectionstatechange","connected");break}case"failed":{this.emit("@connectionstatechange","failed");break}case"disconnected":{this.emit("@connectionstatechange","disconnected");break}case"closed":{this.emit("@connectionstatechange","closed");break}}})}async updateIceServers(e){Q.debug("updateIceServers()");const r=this._pc.getConfiguration();r.iceServers=e,this._pc.setConfiguration(r)}async restartIce(e){if(Q.debug("restartIce()"),this._remoteSdp.updateIceParameters(e),!!this._transportReady)if(this._direction==="send"){const r=await this._pc.createOffer({iceRestart:!0});Q.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",r),await this._pc.setLocalDescription(r);const n={type:"answer",sdp:this._remoteSdp.getSdp()};Q.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",n),await this._pc.setRemoteDescription(n)}else{const r={type:"offer",sdp:this._remoteSdp.getSdp()};Q.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();Q.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}}async getTransportStats(){return this._pc.getStats()}async send({track:e,encodings:r,codecOptions:n,codec:i}){this.assertSendDirection(),Q.debug("send() [kind:%s, track.id:%s]",e.kind,e.id),i&&Q.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(e),this._pc.addStream(this._sendStream);let s=await this._pc.createOffer(),o=jt.parse(s.sdp),a;const c=wc.clone(this._sendingRtpParametersByKind[e.kind]);c.codecs=bn.reduceCodecs(c.codecs);const l=wc.clone(this._sendingRemoteRtpParametersByKind[e.kind]);if(l.codecs=bn.reduceCodecs(l.codecs),this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),e.kind==="video"&&r&&r.length>1&&(Q.debug("send() | enabling simulcast"),o=jt.parse(s.sdp),a=o.media.find(u=>u.type==="video"),sf.addLegacySimulcast({offerMediaObject:a,track:e,numStreams:r.length}),s={type:"offer",sdp:jt.write(o)}),Q.debug("send() | calling pc.setLocalDescription() [offer:%o]",s),await this._pc.setLocalDescription(s),o=jt.parse(this._pc.localDescription.sdp),a=o.media.find(u=>u.type===e.kind),c.rtcp.cname=so.getCname({offerMediaObject:a}),c.encodings=sf.getRtpEncodings({offerMediaObject:a,track:e}),r)for(let u=0;u<c.encodings.length;++u)r[u]&&Object.assign(c.encodings[u],r[u]);if(c.encodings.length>1&&(c.codecs[0].mimeType.toLowerCase()==="video/vp8"||c.codecs[0].mimeType.toLowerCase()==="video/h264"))for(const u of c.encodings)u.scalabilityMode="L1T3";this._remoteSdp.send({offerMediaObject:a,offerRtpParameters:c,answerRtpParameters:l,codecOptions:n});const d={type:"answer",sdp:this._remoteSdp.getSdp()};Q.debug("send() | calling pc.setRemoteDescription() [answer:%o]",d),await this._pc.setRemoteDescription(d);const p=String(this._nextSendLocalId);return this._nextSendLocalId++,this._mapSendLocalIdTrack.set(p,e),{localId:p,rtpParameters:c}}async stopSending(e){this.assertSendDirection(),Q.debug("stopSending() [localId:%s]",e);const r=this._mapSendLocalIdTrack.get(e);if(!r)throw new Error("track not found");this._mapSendLocalIdTrack.delete(e),this._sendStream.removeTrack(r),this._pc.addStream(this._sendStream);const n=await this._pc.createOffer();Q.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",n);try{await this._pc.setLocalDescription(n)}catch(s){if(this._sendStream.getTracks().length===0){Q.warn("stopSending() | ignoring expected error due no sending tracks: %s",s.toString());return}throw s}if(this._pc.signalingState==="stable")return;const i={type:"answer",sdp:this._remoteSdp.getSdp()};Q.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",i),await this._pc.setRemoteDescription(i)}async pauseSending(e){}async resumeSending(e){}async replaceTrack(e,r){throw new Ti.UnsupportedError("not implemented")}async setMaxSpatialLayer(e,r){throw new Ti.UnsupportedError("not implemented")}async setRtpEncodingParameters(e,r){throw new Ti.UnsupportedError("not implemented")}async getSenderStats(e){throw new Ti.UnsupportedError("not implemented")}async sendDataChannel({ordered:e,maxPacketLifeTime:r,maxRetransmits:n,label:i,protocol:s}){this.assertSendDirection();const o={negotiated:!0,id:this._nextSendSctpStreamId,ordered:e,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:n,protocol:s};Q.debug("sendDataChannel() [options:%o]",o);const a=this._pc.createDataChannel(i,o);if(this._nextSendSctpStreamId=++this._nextSendSctpStreamId%of.MIS,!this._hasDataChannelMediaSection){const l=await this._pc.createOffer(),d=jt.parse(l.sdp),p=d.media.find(f=>f.type==="application");this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:d}),Q.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",l),await this._pc.setLocalDescription(l),this._remoteSdp.sendSctpAssociation({offerMediaObject:p});const u={type:"answer",sdp:this._remoteSdp.getSdp()};Q.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",u),await this._pc.setRemoteDescription(u),this._hasDataChannelMediaSection=!0}const c={streamId:o.id,ordered:o.ordered,maxPacketLifeTime:o.maxPacketLifeTime,maxRetransmits:o.maxRetransmits};return{dataChannel:a,sctpStreamParameters:c}}async receive(e){this.assertRecvDirection();const r=[],n=new Map;for(const a of e){const{trackId:c,kind:l,rtpParameters:d}=a;Q.debug("receive() [trackId:%s, kind:%s]",c,l);const p=l;let u=a.streamId??d.rtcp.cname;Q.debug("receive() | forcing a random remote streamId to avoid well known bug in react-native-webrtc"),u+=`-hack-${wc.generateRandomNumber()}`,n.set(c,u),this._remoteSdp.receive({mid:p,kind:l,offerRtpParameters:d,streamId:u,trackId:c})}const i={type:"offer",sdp:this._remoteSdp.getSdp()};Q.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",i),await this._pc.setRemoteDescription(i);let s=await this._pc.createAnswer();const o=jt.parse(s.sdp);for(const a of e){const{kind:c,rtpParameters:l}=a,d=c,p=o.media.find(u=>String(u.mid)===d);so.applyCodecParameters({offerRtpParameters:l,answerMediaObject:p})}s={type:"answer",sdp:jt.write(o)},this._transportReady||await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:o}),Q.debug("receive() | calling pc.setLocalDescription() [answer:%o]",s),await this._pc.setLocalDescription(s);for(const a of e){const{kind:c,trackId:l,rtpParameters:d}=a,p=l,u=c,f=n.get(l),m=this._pc.getRemoteStreams().find(y=>y.id===f).getTrackById(p);if(!m)throw new Error("remote track not found");this._mapRecvLocalIdInfo.set(p,{mid:u,rtpParameters:d}),r.push({localId:p,track:m})}return r}async stopReceiving(e){this.assertRecvDirection();for(const i of e){Q.debug("stopReceiving() [localId:%s]",i);const{mid:s,rtpParameters:o}=this._mapRecvLocalIdInfo.get(i)??{};this._mapRecvLocalIdInfo.delete(i),this._remoteSdp.planBStopReceiving({mid:s,offerRtpParameters:o})}const r={type:"offer",sdp:this._remoteSdp.getSdp()};Q.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",r),await this._pc.setRemoteDescription(r);const n=await this._pc.createAnswer();Q.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",n),await this._pc.setLocalDescription(n)}async pauseReceiving(e){}async resumeReceiving(e){}async getReceiverStats(e){throw new Ti.UnsupportedError("not implemented")}async receiveDataChannel({sctpStreamParameters:e,label:r,protocol:n}){this.assertRecvDirection();const{streamId:i,ordered:s,maxPacketLifeTime:o,maxRetransmits:a}=e,c={negotiated:!0,id:i,ordered:s,maxPacketLifeTime:o,maxRetransmitTime:o,maxRetransmits:a,protocol:n};Q.debug("receiveDataChannel() [options:%o]",c);const l=this._pc.createDataChannel(r,c);if(!this._hasDataChannelMediaSection){this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0});const d={type:"offer",sdp:this._remoteSdp.getSdp()};Q.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",d),await this._pc.setRemoteDescription(d);const p=await this._pc.createAnswer();if(!this._transportReady){const u=jt.parse(p.sdp);await this.setupTransport({localDtlsRole:this._forcedLocalDtlsRole??"client",localSdpObject:u})}Q.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",p),await this._pc.setLocalDescription(p),this._hasDataChannelMediaSection=!0}return{dataChannel:l}}async setupTransport({localDtlsRole:e,localSdpObject:r}){r||(r=jt.parse(this._pc.localDescription.sdp));const n=so.extractDtlsParameters({sdpObject:r});n.role=e,this._remoteSdp.updateDtlsRole(e==="client"?"server":"client"),await new Promise((i,s)=>{this.safeEmit("@connect",{dtlsParameters:n},i,s)}),this._transportReady=!0}assertSendDirection(){if(this._direction!=="send")throw new Error('method can just be called for handlers with "send" direction')}assertRecvDirection(){if(this._direction!=="recv")throw new Error('method can just be called for handlers with "recv" direction')}}ka.ReactNative=Vd;var _0=S&&S.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),y0=S&&S.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ig=S&&S.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&_0(e,t,r);return y0(e,t),e};Object.defineProperty(si,"__esModule",{value:!0});si.Device=void 0;si.detectDevice=sg;const w0=My,S0=he,R0=Vt,Cn=Ce,af=ig(we),gr=ig(ne),b0=ps,C0=va,T0=_a,D0=ya,E0=wa,P0=Sa,k0=Ra,x0=ba,L0=Ca,M0=Ta,O0=Da,I0=Pa,N0=ka,De=new S0.Logger("Device");function sg(){var t,e,r,n;if(typeof navigator=="object"&&navigator.product==="ReactNative"){if(De.debug("detectDevice() | React-Native detected"),typeof RTCPeerConnection>"u"){De.warn("detectDevice() | unsupported react-native-webrtc without RTCPeerConnection, forgot to call registerGlobals()?");return}return typeof RTCRtpTransceiver<"u"?(De.debug("detectDevice() | ReactNative UnifiedPlan handler chosen"),"ReactNativeUnifiedPlan"):(De.debug("detectDevice() | ReactNative PlanB handler chosen"),"ReactNative")}else if(typeof navigator=="object"&&typeof navigator.userAgent=="string"){const i=navigator.userAgent,s=new w0.UAParser(i);De.debug("detectDevice() | browser detected [ua:%s, parsed:%o]",i,s.getResult());const o=s.getBrowser(),a=(t=o.name)==null?void 0:t.toLowerCase(),c=parseInt(o.major??"0"),d=(e=s.getEngine().name)==null?void 0:e.toLowerCase(),p=s.getOS(),u=(r=p.name)==null?void 0:r.toLowerCase(),f=parseFloat(p.version??"0"),m=(n=s.getDevice().model)==null?void 0:n.toLowerCase(),y=u==="ios"||m==="ipad",g=a&&["chrome","chromium","mobile chrome","chrome webview","chrome headless"].includes(a),v=a&&["firefox","mobile firefox","mobile focus"].includes(a),_=a&&["safari","mobile safari"].includes(a),w=a&&["edge"].includes(a);if((g||w)&&!y&&c>=111)return"Chrome111";if(g&&!y&&c>=74||w&&!y&&c>=88)return"Chrome74";if(g&&!y&&c>=70)return"Chrome70";if(g&&!y&&c>=67)return"Chrome67";if(g&&!y&&c>=55)return"Chrome55";if(v&&!y&&c>=120)return"Firefox120";if(v&&!y&&c>=60)return"Firefox60";if(v&&y&&f>=14.3)return"Safari12";if(_&&c>=12&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(_&&c>=11)return"Safari11";if(w&&!y&&c>=11&&c<=18)return"Edge11";if(d==="webkit"&&y&&typeof RTCRtpTransceiver<"u"&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(d==="blink"){const b=i.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(b){const C=Number(b[1]);return C>=111?"Chrome111":C>=74?"Chrome74":C>=70?"Chrome70":C>=67?"Chrome67":"Chrome55"}else return"Chrome111"}else{De.warn("detectDevice() | browser not supported [name:%s, version:%s]",a,c);return}}else{De.warn("detectDevice() | unknown device");return}}class j0{constructor({handlerName:e,handlerFactory:r,Handler:n}={}){if(this._loaded=!1,this._observer=new R0.EnhancedEventEmitter,De.debug("constructor()"),n)if(De.warn("constructor() | Handler option is DEPRECATED, use handlerName or handlerFactory instead"),typeof n=="string")e=n;else throw new TypeError("non string Handler option no longer supported, use handlerFactory instead");if(e&&r)throw new TypeError("just one of handlerName or handlerInterface can be given");if(r)this._handlerFactory=r;else{if(e)De.debug("constructor() | handler given: %s",e);else if(e=sg(),e)De.debug("constructor() | detected handler: %s",e);else throw new Cn.UnsupportedError("device not supported");switch(e){case"Chrome111":{this._handlerFactory=C0.Chrome111.createFactory();break}case"Chrome74":{this._handlerFactory=T0.Chrome74.createFactory();break}case"Chrome70":{this._handlerFactory=D0.Chrome70.createFactory();break}case"Chrome67":{this._handlerFactory=E0.Chrome67.createFactory();break}case"Chrome55":{this._handlerFactory=P0.Chrome55.createFactory();break}case"Firefox120":{this._handlerFactory=k0.Firefox120.createFactory();break}case"Firefox60":{this._handlerFactory=x0.Firefox60.createFactory();break}case"Safari12":{this._handlerFactory=L0.Safari12.createFactory();break}case"Safari11":{this._handlerFactory=M0.Safari11.createFactory();break}case"Edge11":{this._handlerFactory=O0.Edge11.createFactory();break}case"ReactNativeUnifiedPlan":{this._handlerFactory=I0.ReactNativeUnifiedPlan.createFactory();break}case"ReactNative":{this._handlerFactory=N0.ReactNative.createFactory();break}default:throw new TypeError(`unknown handlerName "${e}"`)}}const i=this._handlerFactory();this._handlerName=i.name,i.close(),this._extendedRtpCapabilities=void 0,this._recvRtpCapabilities=void 0,this._canProduceByKind={audio:!1,video:!1},this._sctpCapabilities=void 0}get handlerName(){return this._handlerName}get loaded(){return this._loaded}get rtpCapabilities(){if(!this._loaded)throw new Cn.InvalidStateError("not loaded");return this._recvRtpCapabilities}get sctpCapabilities(){if(!this._loaded)throw new Cn.InvalidStateError("not loaded");return this._sctpCapabilities}get observer(){return this._observer}async load({routerRtpCapabilities:e}){De.debug("load() [routerRtpCapabilities:%o]",e);let r;try{if(this._loaded)throw new Cn.InvalidStateError("already loaded");const n=af.clone(e);gr.validateRtpCapabilities(n),r=this._handlerFactory();const i=await r.getNativeRtpCapabilities();De.debug("load() | got native RTP capabilities:%o",i);const s=af.clone(i);gr.validateRtpCapabilities(s),this._extendedRtpCapabilities=gr.getExtendedRtpCapabilities(s,n),De.debug("load() | got extended RTP capabilities:%o",this._extendedRtpCapabilities),this._canProduceByKind.audio=gr.canSend("audio",this._extendedRtpCapabilities),this._canProduceByKind.video=gr.canSend("video",this._extendedRtpCapabilities),this._recvRtpCapabilities=gr.getRecvRtpCapabilities(this._extendedRtpCapabilities),gr.validateRtpCapabilities(this._recvRtpCapabilities),De.debug("load() | got receiving RTP capabilities:%o",this._recvRtpCapabilities),this._sctpCapabilities=await r.getNativeSctpCapabilities(),De.debug("load() | got native SCTP capabilities:%o",this._sctpCapabilities),gr.validateSctpCapabilities(this._sctpCapabilities),De.debug("load() succeeded"),this._loaded=!0,r.close()}catch(n){throw r&&r.close(),n}}canProduce(e){if(this._loaded){if(e!=="audio"&&e!=="video")throw new TypeError(`invalid kind "${e}"`)}else throw new Cn.InvalidStateError("not loaded");return this._canProduceByKind[e]}createSendTransport({id:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,appData:d}){return De.debug("createSendTransport()"),this.createTransport({direction:"send",id:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,appData:d})}createRecvTransport({id:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,appData:d}){return De.debug("createRecvTransport()"),this.createTransport({direction:"recv",id:e,iceParameters:r,iceCandidates:n,dtlsParameters:i,sctpParameters:s,iceServers:o,iceTransportPolicy:a,additionalSettings:c,proprietaryConstraints:l,appData:d})}createTransport({direction:e,id:r,iceParameters:n,iceCandidates:i,dtlsParameters:s,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:d,appData:p}){if(this._loaded){if(typeof r!="string")throw new TypeError("missing id");if(typeof n!="object")throw new TypeError("missing iceParameters");if(Array.isArray(i)){if(typeof s!="object")throw new TypeError("missing dtlsParameters");if(o&&typeof o!="object")throw new TypeError("wrong sctpParameters");if(p&&typeof p!="object")throw new TypeError("if given, appData must be an object")}else throw new TypeError("missing iceCandidates")}else throw new Cn.InvalidStateError("not loaded");const u=new b0.Transport({direction:e,id:r,iceParameters:n,iceCandidates:i,dtlsParameters:s,sctpParameters:o,iceServers:a,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:d,appData:p,handlerFactory:this._handlerFactory,extendedRtpCapabilities:this._extendedRtpCapabilities,canProduceByKind:this._canProduceByKind});return this._observer.safeEmit("newtransport",u),u}}si.Device=j0;var og={},ag={};Object.defineProperty(ag,"__esModule",{value:!0});var cg={};Object.defineProperty(cg,"__esModule",{value:!0});(function(t){var e=S&&S.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),r=S&&S.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(si,t),r(ps,t),r(fs,t),r(hs,t),r(ms,t),r(gs,t),r(ag,t),r(cg,t),r(ze,t),r(Ce,t)})(og);(function(t){var e=S&&S.__createBinding||(Object.create?function(l,d,p,u){u===void 0&&(u=p);var f=Object.getOwnPropertyDescriptor(d,p);(!f||("get"in f?!d.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return d[p]}}),Object.defineProperty(l,u,f)}:function(l,d,p,u){u===void 0&&(u=p),l[u]=d[p]}),r=S&&S.__setModuleDefault||(Object.create?function(l,d){Object.defineProperty(l,"default",{enumerable:!0,value:d})}:function(l,d){l.default=d}),n=S&&S.__importStar||function(l){if(l&&l.__esModule)return l;var d={};if(l!=null)for(var p in l)p!=="default"&&Object.prototype.hasOwnProperty.call(l,p)&&e(d,l,p);return r(d,l),d},i=S&&S.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(t,"__esModule",{value:!0}),t.debug=t.parseScalabilityMode=t.detectDevice=t.Device=t.version=t.types=void 0;const s=i(da);t.debug=s.default;const o=si;Object.defineProperty(t,"Device",{enumerable:!0,get:function(){return o.Device}}),Object.defineProperty(t,"detectDevice",{enumerable:!0,get:function(){return o.detectDevice}});const a=n(og);t.types=a,t.version="3.7.16";var c=Kt;Object.defineProperty(t,"parseScalabilityMode",{enumerable:!0,get:function(){return c.parse}})})(jm);let cf=[];const lg=async t=>{if(cf.includes(t)){console.log("returned ...");return}cf.push(t),$e.emit("createWebRtcTransport",{consumer:!0},({params:e})=>{if(e.error){console.log(e.error);return}console.log(`PARAMS... ${e}`);let r;try{r=Kn.createRecvTransport(e)}catch(n){console.log(n);return}r.on("connect",async({dtlsParameters:n},i,s)=>{try{$e.emit("transport-recv-connect",{dtlsParameters:n,serverConsumerTransportId:e.id}),i()}catch(o){s(o)}}),B0(r,t,e.id)})};$e.on("new-producer",({producerId:t})=>lg(t));let zi;const A0=()=>{$e.emit("getProducers",t=>{console.log("These are the producer id",t),t.forEach(lg)})},$0=()=>{$e.emit("createWebRtcTransport",{consumer:!1},({params:t})=>{if(t.error){console.log(t.error);return}console.log("Params from createSendTransport : ",t),zi=Kn.createSendTransport(t),zi.on("connect",async({dtlsParameters:e},r,n)=>{try{$e.emit("transport-connect",{dtlsParameters:e}),r()}catch(i){n(i)}}),zi.on("produce",async(e,r,n)=>{console.log(e);try{$e.emit("transport-produce",{kind:e.kind,rtpParameters:e.rtpParameters,appData:e.appData},({id:i,producersExist:s})=>{r({id:i}),s&&A0()})}catch(i){n(i)}}),F0()})};let Sc,Rc;const F0=async()=>{Sc=await zi.produce(Cl),Rc=await zi.produce(Tl),Sc.on("trackended",()=>{console.log("audio track ended")}),Sc.on("transportclose",()=>{console.log("audio transport ended")}),Rc.on("trackended",()=>{console.log("video track ended")}),Rc.on("transportclose",()=>{console.log("video transport ended")})};let Ui=[];const B0=async(t,e,r)=>{$e.emit("consume",{rtpCapabilities:Kn.rtpCapabilities,remoteProducerId:e,serverConsumerTransportId:r},async({params:n})=>{if(n.error){console.log("Cannot Consume");return}console.log(`Consumer Params ${n}`);const i=await t.consume({id:n.id,producerId:n.producerId,kind:n.kind,rtpParameters:n.rtpParameters});Ui=[...Ui,{consumerTransport:t,serverConsumerTransportId:n.id,producerId:e,consumer:i}];const s=document.createElement("div");s.setAttribute("id",`td-${e}`),n.kind=="audio"?s.innerHTML='<audio id="'+e+'" autoplay></audio>':(s.setAttribute("class","remoteVideo"),s.innerHTML='<video id="'+e+'" autoplay class="video" ></video>'),ei.current?ei.current.appendChild(s):console.error("videoContainerRef is null");const{track:o}=i,a=document.getElementById(e);a&&(a.srcObject=new MediaStream([o])),$e.emit("consumer-resume",{serverConsumerId:n.serverConsumerId})})};$e.on("producer-closed",({remoteProducerId:t})=>{const e=Ui.find(n=>n.producerId===t);e.consumerTransport.close(),e.consumer.close(),Ui=Ui.filter(n=>n.producerId!==t);const r=document.getElementById(`td-${t}`);ei.current&&r?ei.current.removeChild(r):console.error("Element or container not found")});let Kn;const z0=async()=>{try{Kn=new jm.Device,await Kn.load({routerRtpCapabilities:dg}),console.log("Device RTP Capabilities",Kn.rtpCapabilities),$0()}catch(t){console.log(t),t.name==="UnsupportedError"&&console.warn("browser not supported")}};let dg;const U0=t=>{$e.emit("joinRoom",{roomName:t},e=>{console.log(`Router RTP Capabilities... ${e.rtpCapabilities}`),dg=e.rtpCapabilities,z0()})};let V0={encodings:[{rid:"r0",maxBitrate:1e5,scalabilityMode:"S1T3"},{rid:"r1",maxBitrate:3e5,scalabilityMode:"S1T3"},{rid:"r2",maxBitrate:9e5,scalabilityMode:"S1T3"}],codecOptions:{videoGoogleStartBitrate:1e3}},Cl={},Tl={params:V0};const H0=t=>{navigator.mediaDevices.getUserMedia({audio:!0,video:{width:{min:640,max:1920},height:{min:400,max:1080}}}).then(e=>K0(e,t)).catch(e=>{console.log(e)})},K0=(t,e)=>{e.current&&(e.current.srcObject=t),Cl={track:t.getAudioTracks()[0],...Cl},Tl={track:t.getVideoTracks()[0],...Tl};const r=window.location.pathname.split("/")[1];U0(r)};let ei;const W0=()=>{const t=Wn.useRef(null);ei=Wn.useRef(null);const e=()=>{H0(t),console.log("Publish button clicked")};return Ze.jsxs("div",{className:"flex flex-col items-center  space-y-4",children:[Ze.jsxs("div",{className:"flex flex-col items-center space-y-4 w-full max-w-md mx-auto",children:[Ze.jsx("h2",{className:"text-xl font-semibold",children:"Video 1"}),Ze.jsx("video",{id:"localVideo",ref:t,autoPlay:!0,className:"w-full max-w-sm border-2 border-gray-800 rounded-lg"}),Ze.jsx("div",{className:"flex justify-center gap-2",children:Ze.jsx("button",{id:"btnPublish",onClick:e,className:"btn btn-primary",children:"Publish"})})]}),Ze.jsx("div",{className:"w-full px-10  ",children:Ze.jsx("div",{className:"border w-full flex flex-wrap  justify-center",ref:ei})})]})};function Q0(){return Wn.useEffect(()=>{function t(){console.log("socket connected ",$e.id)}function e(){console.log("disconnected")}return $e.on("connect",t),$e.on("disconnect",e),()=>{$e.off("connect",t),$e.off("disconnect",e)}},[]),Ze.jsx(Ze.Fragment,{children:Ze.jsx(W0,{})})}Sm(document.getElementById("root")).render(Ze.jsx(Wn.StrictMode,{children:Ze.jsx(Q0,{})}));
